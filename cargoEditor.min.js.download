!function(M){"use strict";if("undefined"==typeof MutationObserver)throw"Unable to init the editor. MutationObservers are not supported in this browser.";!function(){var e={};!function(){var a=Array.prototype.forEach,n=Object.prototype.hasOwnProperty,r=Array.prototype.slice,o=0;var u={keys:Object.keys||function(e){if("object"!=typeof e&&"function"!=typeof e||null===e)throw new TypeError("keys() called on a non-object");var t,n=[];for(t in e)e.hasOwnProperty(t)&&(n[n.length]=t);return n},uniqueId:function(e){var t=++o+"";return e?e+t:t},has:function(e,t){return n.call(e,t)},each:function(e,t,n){if(null!=e)if(a&&e.forEach===a)e.forEach(t,n);else if(e.length===+e.length)for(var r=0,o=e.length;r<o;r++)t.call(n,e[r],r,e);else for(var i in e)this.has(e,i)&&t.call(n,e[i],i,e)},once:function(e){var t,n=!1;return function(){return n||(n=!0,t=e.apply(this,arguments),e=null),t}}},t={on:function(e,t,n,r){return f(this,"on",e,[t,n])&&t&&(this._events||(this._events={}),(this._events[e]||(this._events[e]=[])).push({callback:t,context:n,ctx:n||this,opts:r})),this},once:function(e,t,n,r){var o,i;return f(this,"once",e,[t,n])&&t?(o=this,(i=u.once(function(){o.off(e,i),t.apply(this,arguments)}))._callback=t,this.on(e,i,n,r)):this},off:function(e,t,n){var r,o,i,a,s,l,d,c;if(this._events&&f(this,"off",e,[t,n]))if(e||t||n){for(s=0,l=(a=e?[e]:u.keys(this._events)).length;s<l;s++)if(e=a[s],i=this._events[e]){if(this._events[e]=r=[],t||n)for(d=0,c=i.length;d<c;d++)o=i[d],(t&&t!==o.callback&&t!==o.callback._callback||n&&n!==o.context)&&r.push(o);r.length||delete this._events[e]}}else this._events={};return this},trigger:function(e){var t,n;return this._events&&(t=r.call(arguments,1),f(this,"trigger",e,t))&&(e=this._events[e],n=this._events.all,e&&i(e,t),n)&&i(n,arguments),this},stopListening:function(e,t,n){var r=this._listeners;if(r){var o,i=!t&&!n;for(o in"object"==typeof t&&(n=this),e&&((r={})[e._listenerId]=e),r)r[o].off(t,n,this),i&&delete this._listeners[o]}return this}},l=/\s+/,f=function(e,t,n,r){if(n){if("object"==typeof n){for(var o in n)e[t].apply(e,[o,n[o]].concat(r));return!1}if(l.test(n)){for(var i=n.split(l),a=0,s=i.length;a<s;a++)e[t].apply(e,[i[a]].concat(r));return!1}}return!0},i=function(e,t){var n=e.filter(function(e){return e.opts&&!0===e.opts.leading}),r=(e=0<n.length?n.concat(e.filter(function(e){return!n.includes(e)})):e).filter(function(e){return e.opts&&!0===e.opts.trailing});if(0<r.length&&(e=e.filter(function(e){return!r.includes(e)}).concat(r)),t[0]instanceof c&&!0===t[0].destroyed)return!1;var o,i=-1,a=e.length,s=t[0],l=t[1],d=t[2];switch(t.length){case 0:for(;++i<a;)(o=e[i]).callback.call(o.ctx);return;case 1:for(;++i<a;)(o=e[i]).callback.call(o.ctx,s);return;case 2:for(;++i<a;)(o=e[i]).callback.call(o.ctx,s,l);return;case 3:for(;++i<a;)(o=e[i]).callback.call(o.ctx,s,l,d);return;default:for(;++i<a;)(o=e[i]).callback.apply(o.ctx,t)}};u.each({listenTo:"on",listenToOnce:"once"},function(r,e){t[e]=function(e,t,n){return((this._listeners||(this._listeners={}))[e._listenerId||(e._listenerId=u.uniqueId("l"))]=e)[r](t,n="object"==typeof t?this:n,this),this}}),t.bind=t.on,t.unbind=t.off,t.mixin=function(t){return u.each(["on","once","off","trigger","stopListening","listenTo","listenToOnce","bind","unbind"],function(e){t[e]=this[e]},this),t},this.BackboneEvents=t}.call(e),this.events=e.BackboneEvents.mixin({})}.call(this);var t,s,l,rr=this,n=[],or=(this.addEditor=function(e){e=new c(e);return!1!==e&&n.push(e),e},this.events.on("editor-destroyed",function(e){e===t&&(t=void 0);e=n.indexOf(e);-1!==e&&n.splice(e,1)}),this.plugins={},this.addPlugin=function(e,t){function n(e,t){t.prototype.events=rr.events,t.prototype.helpers=or,t.prototype.pluginNS=rr.plugins,r.plugins[e]=new t(r),rr.events.trigger("plugin-initialized",e,r.plugins[e])}var r=this;"function"==typeof t&&("interactive"===document.readyState||"complete"===document.readyState?n(e,t):document.addEventListener("DOMContentLoaded",function(){n(e,t)}))},this.getEditorInstances=function(){return n},this.getActiveEditor=function(){return t},{findClosestScrollParent:function(e){var t=/(auto|scroll)/;if(e){e.nodeType==Node.TEXT_NODE&&(e=e.parentElement);for(var n=function(e,t){return null===e.parentElement?t:n(e.parentElement,t.concat([e]))},r=function(e,t){return getComputedStyle(e,null).getPropertyValue(t)},o=function(e){return t.test(r(e=e,"overflow")+r(e,"overflow-y")+r(e,"overflow-x"))},i=n(e.parentElement,[]),a=0;a<i.length;a+=1)if(o(i[a]))return i[a];return document.scrollingElement||document.documentElement}},scrollToRange:function(e,t){var n,r;e&&(n=[],r=null,n=((e=e.cloneRange()).nativeRange||e).getClientRects(),(r=t?n[0]:n[n.length-1])&&(0!==r.top||0!==r.left)||e.startContainer.nodeType!==Node.ELEMENT_NODE||((t=document.createElement("span")).innerHTML="@",t.style.width="0px",t.style.opacity=0,t.saveable=!1,e.collapse(!0),e.startContainer&&(e.startContainer.insertBefore(t,e.startContainer.childNodes[e.startOffset]),r=t.getBoundingClientRect(),t.remove())),r)&&((n=or.findClosestScrollParent(e.startContainer)).scrollLeft,t=n.scrollTop,r.top<0?n.scrollTo(0,t+r.top):r.top+r.height>document.documentElement.clientHeight&&(e=-(document.documentElement.clientHeight-(r.top+r.height)),n.scrollTo(0,t+e)))},extend:function(e,t){if(Object.keys)for(var n=Object.keys(t),r=0,o=n.length;r<o;r++){var i=n[r];Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(t,i))}else{var a={}.hasOwnProperty;for(i in t)a.call(t,i)&&(e[i]=t[i])}return e},loadScript:function(e,t){var n=document.createElement("script");n.async=!1,n.src=e,n.onload=t,document.head.appendChild(n)},hasClass:function(e,t){if(void 0!==e&&void 0!==t)return new RegExp("(\\s|^)"+t+"(\\s|$)").test(e.className)},addClass:function(e,t){void 0===e||void 0===t||or.hasClass(e,t)||(e.className+=(e.className?" ":"")+t)},removeClass:function(e,t){void 0!==e&&void 0!==t&&or.hasClass(e,t)&&(e.className=e.className.replace(new RegExp("(\\s|^)"+t+"(\\s|$)")," ").replace(/^\s+|\s+$/g,""))},spliceString:function(e,t,n,r){return e.slice(0,t)+r+e.slice(t+Math.abs(n))},nextNode:function(e){if(e.hasChildNodes())return e.firstChild;for(;e&&!e.nextSibling;)e=e.parentNode;return e?e.nextSibling:null},wrap:function(e,t,n){if(null!==e){var r,o=e.parentNode,i=document.createElement(t);if("object"==typeof n)for(r in n)i.setAttribute(r,n[r]);return o.insertBefore(i,e),i.appendChild(e),!0===e.isSaveable()&&i.setSaveable(!0),i}},getAllParents:function(e,t,n){for(;null!==e.parentNode&&e.parentNode!==n;){if(!1===t(e.parentNode))return!1;e=e.parentNode}},getAllSiblings:function(e,t){if(void 0===e)return[];for(var n=[];null!==(e=!0===t?e.previousSibling:e.nextSibling);)n.push(e);return n},getAllDescendants:function(e,t,n){for(var r=n?e.childNodes.length-1:0;n?0<=r:r<e.childNodes.length;n?r--:r++){var o=e.childNodes[r],i=t(o);if(!1===i)return!1;if("continue"!==i&&!1===this.getAllDescendants(o,t,n))return!1}},getCurrentSelectionTree:function(e){var t=[],n=getSelection(),r=rr.getActiveRange(),o={nodes:[],selection:{}};if(o.selection=n,!1!==r&&(t=r.getNodes(),"object"==typeof e)&&-1===t.indexOf(e))for(var i=0;i<t.length;i++)for(var a=t[i];null!==a&&a.parentNode!==e;)a=a.parentNode,t.indexOf(a)<0&&null!==a&&t.push(a);return o.nodes=t,o},getEditableNodesInRange:function(){},createRangeAtCoordinates:function(e,t){var n,r=document.createRange();return document.caretPositionFromPoint?(n=document.caretPositionFromPoint(e,t))&&(r.setStart(n.offsetNode,n.offset),r.collapse()):document.caretRangeFromPoint?(n=document.caretRangeFromPoint(e,t))&&(r.setStart(n.startContainer,n.startOffset),r.collapse()):document.body.createTextRange&&(r=document.body.createTextRange()).moveToPoint(e,t),r},isNode:function(e){return"object"==typeof Node?e instanceof Node:e&&"object"==typeof e&&"number"==typeof e.nodeType&&"string"==typeof e.nodeName},isElement:function(e){return"object"==typeof HTMLElement?e instanceof HTMLElement:e&&"object"==typeof e&&null!==e&&1===e.nodeType&&"string"==typeof e.nodeName},insertNodeAtCursorPosition:function(e,t,n){var r=["IFRAME","MEDIA-ITEM","VIDEO","AUDIO-PLAYER","TEXT-ICON","SHOP-PRODUCT","DIGITAL-CLOCK"];if(void 0===e||void 0===t)return console.warn("insertNodeAtCursorPosition: Missing parameters"),!1;for(var o,i=this.createRangeAtCoordinates(e.clientX,e.clientY),a=i.commonAncestorContainer,s=null;null!==a.parentNode;)-1<r.indexOf(a.nodeName)&&(s=a),a=a.parentNode;if(s&&(o=s.getBoundingClientRect(),e.clientY<o.top||e.clientY<=o.top+o.height&&e.clientX<o.left+.5*o.width?(i.setStartBefore(s),i.setEndBefore(s)):(i.setStartAfter(s),i.setEndAfter(s))),void 0!==n&&this.isElement(n)){for(var a=i.commonAncestorContainer,l=!1;null!==a.parentNode;)a===n&&(l=!0),a=a.parentNode;if(!1===l)throw"insertNodeAtCursorPosition: Caret is not contained by the supplied constrainingElement"}if(!rr.helpers.isEditingHost(i.commonAncestorContainer)&&!rr.helpers.isEditable(i.commonAncestorContainer))throw"insertNodeAtCursorPosition: Cursor is not contained by a contentEditable element";window.getSelection().removeAllRanges(),document.caretPositionFromPoint||document.caretRangeFromPoint?i.commonAncestorContainer!==t&&i.insertNode(t):document.body.createTextRange&&(e="temp_"+(""+Math.random()).slice(2),i.pasteHTML('<span id="'+e+'">&nbsp;</span>'),(o=document.getElementById(e)).parentNode!==t?o.parentNode.replaceChild(t,span):null!==o.parentNode&&o.parentNode.removeChild(o)),window.getSelection().addRange(i),window.getSelection().removeAllRanges()},getCursorCoordinates:function(){var e,t,n=document.selection,r=0,o=0,i=0;return n?"Control"!=n.type&&((t=n.createRange()).collapse(!0),r=t.boundingLeft,o=t.boundingTop,i=t.boundingHeight):window.getSelection&&(n=window.getSelection()).rangeCount&&(t=n.getRangeAt(0).cloneRange()).getClientRects&&(t.collapsed||((n=t.cloneRange()).collapse(!0),e=n.getClientRects()[0].top,n.detach(),(n=t.cloneRange()).collapse(!1),i=n.getClientRects()[0].bottom-e,n.detach()),t.collapse(!0),0<t.getClientRects().length)&&(r=(e=t.getClientRects()[0]).left,o=e.top),{x:r,y:o,h:i}},findClosestTextNode:function(e,t){for(var n,r,o,i=function(e){return e.nodeType===Node.TEXT_NODE&&-1!==e.nodeValue.search(/\S/g)};null!==e&&e!==document.body;)if("false"!==e.contentEditable){for(n=or.getAllSiblings(e,t),r=0;r<n.length;r++)if("false"!==n[r].contentEditable){if(i(n[r])){o=n[r];break}if(0<n[r].childNodes.length&&(or.getAllDescendants(n[r],function(e){if(i(e))return o=e,!1},t),void 0!==o))break}if(void 0!==o)break;e=e.parentNode}return o},findAdjacentTextNodeWithContent:function(e,t,n){for(var r=!1,o=n.createNodeIterator(e,NodeFilter.SHOW_TEXT,null,!1),i=o.nextNode();i;){if(i===t)r=!0;else if(r&&3===i.nodeType&&i.nodeValue&&0<i.nodeValue.trim().length)break;i=o.nextNode()}return i},loadJSON:function(e,t,n){var r=new XMLHttpRequest;r.open("GET",e,n=!1!==n?!0:n),r.onload=function(){200<=r.status&&r.status<400&&"function"==typeof t&&t.call(this,JSON.parse(r.responseText))},r.onerror=function(){},r.send()},stringToHTMLNodes:function(e){var t,n=document.createElement("body"),r=[];for(n.innerHTML=e;t=n.lastChild;)r.push(t.cloneNode(!0)),n.removeChild(t);return r},warn:function(e){console.warn(e)},log:function(e){console.warn(e)},selectNode:function(e){var t=document.createRange(),n=getSelection();t.selectNode(e),n.removeAllRanges(),n.addRange(t)},logDocumentFragment:function(e){var t=document.createElement("div");t.appendChild(e.cloneNode(!0)),console.log(t)},whiteSpaceHelpers:{is_all_ws:function(e){return!/[^\t\n\r ]/.test(e.textContent)},is_ignorable:function(e){return 8==e.nodeType||3==e.nodeType&&or.whiteSpaceHelpers.is_all_ws(e)},node_before:function(e){for(;e=e.previousSibling;)if(!or.whiteSpaceHelpers.is_ignorable(e))return e;return null},node_after:function(e){for(;e=e.nextSibling;)if(!or.whiteSpaceHelpers.is_ignorable(e))return e;return null},last_child:function(e){for(var t=e.lastChild;t;){if(!or.whiteSpaceHelpers.is_ignorable(t))return t;t=t.previousSibling}return null},first_child:function(e){for(var t=e.firstChild;t;){if(!or.whiteSpaceHelpers.is_ignorable(t))return t;t=t.nextSibling}return null},data_of:function(e){e=e.textContent;return e=" "==(e=" "==(e=e.replace(/[\t\n\r ]+/g," ")).charAt(0)?e.substring(1,e.length):e).charAt(e.length-1)?e.substring(0,e.length-1):e}}}),c=(this.helpers=or,this.rangy=function(){var r="object",o="function",n="undefined",d=["startContainer","startOffset","endContainer","endOffset","collapsed","commonAncestorContainer"],c=["setStart","setStartBefore","setStartAfter","setEnd","setEndBefore","setEndAfter","collapse","selectNode","selectNodeContents","compareBoundaryPoints","deleteContents","extractContents","cloneContents","insertNode","surroundContents","cloneRange","toString","detach"],P=["boundingHeight","boundingLeft","boundingTop","boundingWidth","htmlText","text"],B=["collapse","compareEndPoints","duplicate","moveToElementText","parentElement","select","setEndPoint","getBoundingClientRect"];function u(e,t){var n=typeof e[t];return n==o||!!(n==r&&e[t])||n=="unknown"}function t(e,t){return!!(typeof e[t]==r&&e[t])}function e(e,t){return typeof e[t]!=n}function i(r){return function(e,t){var n=t.length;while(n--)if(!r(e,t[n]))return false;return true}}var f=i(u),U=i(t),h=i(e);function p(e){return e&&f(e,B)&&h(e,P)}function g(e){return t(e,"body")?e.body:e.getElementsByTagName("body")[0]}var H,N={},m=typeof window!=n&&typeof document!=n,a={isHostMethod:u,isHostObject:t,isHostProperty:e,areHostMethods:f,areHostObjects:U,areHostProperties:h,isTextRange:p,getBody:g,forEach:[].forEach?function(e,t){e.forEach(t)}:function(e,t){for(var n=0,r=e.length;n<r;++n)t(e[n],n)}},v={version:"1.3.1",initialized:false,isBrowser:m,supported:true,util:a,features:{},modules:N,config:{alertOnFail:false,alertOnWarn:false,preferTextRange:false,autoInitialize:typeof rangyAutoInitialize==n?true:rangyAutoInitialize}},s,l,E;function C(e){if(typeof console!=n&&u(console,"log"))console.log(e)}function y(e,t){if(m&&t)alert(e);else C(e)}function b(e){v.initialized=true;v.supported=false;y("Rangy is not supported in this environment. Reason: "+e,v.config.alertOnFail)}function F(e){y("Rangy warning: "+e,v.config.alertOnWarn)}if(v.fail=b,v.warn=F,{}.hasOwnProperty){a.extend=s=function(e,t,n){var r,o;for(var i in t)if(t.hasOwnProperty(i)){r=e[i];o=t[i];if(n&&r!==null&&typeof r=="object"&&o!==null&&typeof o=="object")s(r,o,true);e[i]=o}if(t.hasOwnProperty("toString"))e.toString=t.toString;return e};a.createOptions=function(e,t){var n={};s(n,t);if(e)s(n,e);return n}}else b("hasOwnProperty not supported");if(!m)b("Rangy can only run in a browser");if(m){var T=document.createElement("div");T.appendChild(document.createElement("span"));var O=[].slice;try{if(O.call(T.childNodes,0)[0].nodeType==1)l=function(e){return O.call(e,0)}}catch(e){}}if(!l)l=function(e){var t=[];for(var n=0,r=e.length;n<r;++n)t[n]=e[n];return t};if(a.toArray=l,m){if(u(document,"addEventListener"))E=function(e,t,n){e.addEventListener(t,n,false)};else if(u(document,"attachEvent"))E=function(e,t,n){e.attachEvent("on"+t,n)};else b("Document does not have required addEventListener or attachEvent method");a.addListener=E}var S=[];function R(e){return e.message||e.description||String(e)}function w(){if(!m||v.initialized)return;var e;var t=false,n=false;if(u(document,"createRange")){e=document.createRange();if(f(e,c)&&h(e,d))t=true}var r=g(document);if(!r||r.nodeName.toLowerCase()!="body"){b("No body element found");return}if(r&&u(r,"createTextRange")){e=r.createTextRange();if(p(e))n=true}if(!t&&!n){b("Neither Range nor TextRange are available");return}v.initialized=true;v.features={implementsDomRange:t,implementsTextRange:n};var o,i;for(var a in N)if((o=N[a])instanceof _)o.init(o,v);for(var s=0,l=S.length;s<l;++s)try{S[s](v)}catch(e){i="Rangy init listener threw an exception. Continuing. Detail: "+R(e);C(i)}}function A(e,t,n){if(n)e+=" in module "+n.name;v.warn("DEPRECATED: "+e+" is deprecated. Please use "+t+" instead.")}function D(e,t,n,r){e[t]=function(){A(t,n,r);return e[n].apply(e,a.toArray(arguments))}}a.deprecationNotice=A,a.createAliasForDeprecatedMethod=D,v.init=w,v.addInitListener=function(e){if(v.initialized)e(v);else S.push(e)};var x=[];function V(e){e=e||window;w();for(var t=0,n=x.length;t<n;++t)x[t](e)}if(v.addShimListener=function(e){x.push(e)},m){v.shim=v.createMissingNativeApi=V;D(v,"createMissingNativeApi","shim")}function _(e,t,n){this.name=e;this.dependencies=t;this.initialized=false;this.supported=false;this.initializer=n}function L(n,e,r){var t=new _(n,e,function(e){if(!e.initialized){e.initialized=true;try{r(v,e);e.supported=true}catch(e){var t="Module '"+n+"' failed to load: "+R(e);C(t);if(e.stack)C(e.stack)}}});N[n]=t;return t}function k(){}function q(){}_.prototype={init:function(){var e=this.dependencies||[];for(var t=0,n=e.length,r,o;t<n;++t){o=e[t];r=N[o];if(!r||!(r instanceof _))throw new Error("required module '"+o+"' not found");r.init();if(!r.supported)throw new Error("required module '"+o+"' not supported")}this.initializer(this)},fail:function(e){this.initialized=true;this.supported=false;throw new Error(e)},warn:function(e){v.warn("Module "+this.name+": "+e)},deprecationNotice:function(e,t){v.warn("DEPRECATED: "+e+" in module "+this.name+" is deprecated. Please use "+t+" instead")},createError:function(e){return new Error("Error in Rangy "+this.name+" module: "+e)}},v.createModule=function(e){var t,n;if(arguments.length==2){t=arguments[1];n=[]}else{t=arguments[2];n=arguments[1]}var r=L(e,n,t);if(v.initialized&&v.supported)r.init()},v.createCoreModule=function(e,t,n){L(e,t,n)},v.RangePrototype=k,v.rangePrototype=new k,v.selectionPrototype=new q,v.createCoreModule("DomUtil",[],function(n,d){var r="undefined";var o=n.util;var a=o.getBody;if(!o.areHostMethods(document,["createDocumentFragment","createElement","createTextNode"]))d.fail("document missing a Node creation method");if(!o.isHostMethod(document,"getElementsByTagName"))d.fail("document missing getElementsByTagName method");var e=document.createElement("div");if(!o.areHostMethods(e,["insertBefore","appendChild","cloneNode"]||!o.areHostObjects(e,["previousSibling","nextSibling","childNodes","parentNode"])))d.fail("Incomplete Element implementation");if(!o.isHostProperty(e,"innerHTML"))d.fail("Element is missing innerHTML property");var t=document.createTextNode("test");if(!o.areHostMethods(t,["splitText","deleteData","insertData","appendData","cloneNode"]||!o.areHostObjects(e,["previousSibling","nextSibling","childNodes","parentNode"])||!o.areHostProperties(t,["data"])))d.fail("Incomplete Text Node implementation");var i=function(e,t){var n=e.length;while(n--)if(e[n]===t)return true;return false};function s(e){var t;return typeof e.namespaceURI==r||((t=e.namespaceURI)===null||t=="http://www.w3.org/1999/xhtml")}function l(e){var t=e.parentNode;return t.nodeType==1?t:null}function c(e){var t=0;while(e=e.previousSibling)++t;return t}function u(e){switch(e.nodeType){case 7:case 10:return 0;case 3:case 8:return e.length;default:return e.childNodes.length}}function f(e,t){var n=[],r;for(r=e;r;r=r.parentNode)n.push(r);for(r=t;r;r=r.parentNode)if(i(n,r))return r;return null}function h(e,t,n){var r=n?t:t.parentNode;while(r)if(r===e)return true;else r=r.parentNode;return false}function p(e,t){return h(e,t,true)}function g(e,t,n){var r,o=n?e:e.parentNode;while(o){r=o.parentNode;if(r===t)return o;o=r}return null}function N(e){var t=e.nodeType;return t==3||t==4||t==8}function m(e){if(!e)return false;var t=e.nodeType;return t==3||t==8}function v(e,t){var n=t.nextSibling,r=t.parentNode;if(n)r.insertBefore(e,n);else r.appendChild(e);return e}function E(e,t,n){var r=e.cloneNode(false);r.deleteData(0,t);e.deleteData(t,e.length-t);v(r,e);if(n)for(var o=0,i;i=n[o++];)if(i.node==e&&i.offset>t){i.node=r;i.offset-=t}else if(i.node==e.parentNode&&i.offset>c(e))++i.offset;return r}function C(e){if(e.nodeType==9)return e;else if(typeof e.ownerDocument!=r)return e.ownerDocument;else if(typeof e.document!=r)return e.document;else if(e.parentNode)return C(e.parentNode);else throw d.createError("getDocument: no document found for node")}function y(e){var t=C(e);if(typeof t.defaultView!=r)return t.defaultView;else if(typeof t.parentWindow!=r)return t.parentWindow;else throw d.createError("Cannot get a window object for node")}function b(e){if(typeof e.contentDocument!=r)return e.contentDocument;else if(typeof e.contentWindow!=r)return e.contentWindow.document;else throw d.createError("getIframeDocument: No Document object found for iframe element")}function T(e){if(typeof e.contentWindow!=r)return e.contentWindow;else if(typeof e.contentDocument!=r)return e.contentDocument.defaultView;else throw d.createError("getIframeWindow: No Window object found for iframe element")}function O(e){return e&&o.isHostMethod(e,"setTimeout")&&o.isHostObject(e,"document")}function S(e,t,n){var r;if(!e)r=document;else if(o.isHostProperty(e,"nodeType"))r=e.nodeType==1&&e.tagName.toLowerCase()=="iframe"?b(e):C(e);else if(O(e))r=e.document;if(!r)throw t.createError(n+"(): Parameter must be a Window object or DOM node");return r}function R(e){var t;while(t=e.parentNode)e=t;return e}function w(e,t,n,r){var o,i,a,s,l;if(e==n)return t===r?0:t<r?-1:1;else if(o=g(n,e,true))return t<=c(o)?-1:1;else if(o=g(e,n,true))return c(o)<r?-1:1;else{i=f(e,n);if(!i)throw new Error("comparePoints error: nodes have no common ancestor");a=e===i?i:g(e,i,true);s=n===i?i:g(n,i,true);if(a===s)throw d.createError("comparePoints got to case 4 and childA and childB are the same!");else{l=i.firstChild;while(l){if(l===a)return-1;else if(l===s)return 1;l=l.nextSibling}}}}var A=false;function D(e){var t;try{t=e.parentNode;return false}catch(e){return true}}(function(){var e=document.createElement("b");e.innerHTML="1";var t=e.firstChild;e.innerHTML="<br />";A=D(t);n.features.crashyTextNodes=A})();function x(e){if(!e)return"[No node]";if(A&&D(e))return"[Broken node]";if(N(e))return'"'+e.data+'"';if(e.nodeType==1){var t=e.id?' id="'+e.id+'"':"";return"<"+e.nodeName+t+">[index:"+c(e)+",length:"+e.childNodes.length+"]["+(e.innerHTML||"[innerHTML not supported]").slice(0,25)+"]"}return e.nodeName}function _(e){var t=C(e).createDocumentFragment(),n;while(n=e.firstChild)t.appendChild(n);return t}var L;if(typeof window.getComputedStyle!=r)L=function(e,t){return y(e).getComputedStyle(e,null)[t]};else if(typeof document.documentElement.currentStyle!=r)L=function(e,t){return e.currentStyle?e.currentStyle[t]:""};else d.fail("No means of obtaining computed style properties found");function P(e,t,n){var r=a(e);var o=e.createElement("div");o.contentEditable=""+!!n;if(t)o.innerHTML=t;var i=r.firstChild;if(i)r.insertBefore(o,i);else r.appendChild(o);return o}function B(e){return e.parentNode.removeChild(e)}function k(e){this.root=e;this._next=e}k.prototype={_current:null,hasNext:function(){return!!this._next},next:function(){var e=this._current=this._next;var t,n;if(this._current){t=e.firstChild;if(t)this._next=t;else{n=null;while(e!==this.root&&!(n=e.nextSibling))e=e.parentNode;this._next=n}}return this._current},detach:function(){this._current=this._next=this.root=null}};function U(e){return new k(e)}function M(e,t){this.node=e;this.offset=t}M.prototype={equals:function(e){return!!e&&this.node===e.node&&this.offset==e.offset},inspect:function(){return"[DomPosition("+x(this.node)+":"+this.offset+")]"},toString:function(){return this.inspect()}};function I(e){this.code=this[e];this.codeName=e;this.message="DOMException: "+this.codeName}I.prototype={INDEX_SIZE_ERR:1,HIERARCHY_REQUEST_ERR:3,WRONG_DOCUMENT_ERR:4,NO_MODIFICATION_ALLOWED_ERR:7,NOT_FOUND_ERR:8,NOT_SUPPORTED_ERR:9,INVALID_STATE_ERR:11,INVALID_NODE_TYPE_ERR:24};I.prototype.toString=function(){return this.message};n.dom={arrayContains:i,isHtmlNamespace:s,parentElement:l,getNodeIndex:c,getNodeLength:u,getCommonAncestor:f,isAncestorOf:h,isOrIsAncestorOf:p,getClosestAncestorIn:g,isCharacterDataNode:N,isTextOrCommentNode:m,insertAfter:v,splitDataNode:E,getDocument:C,getWindow:y,getIframeWindow:T,getIframeDocument:b,getBody:a,isWindow:O,getContentDocument:S,getRootContainer:R,comparePoints:w,isBrokenNode:D,inspectNode:x,getComputedStyleProperty:L,createTestElement:P,removeNode:B,fragmentFromNodeChildren:_,createIterator:U,DomPosition:M};n.DOMException=I}),v.createCoreModule("DomRange",["DomUtil"],function(a,P){var s=a.dom;var r=a.util;var t=s.DomPosition;var i=a.DOMException;var u=s.isCharacterDataNode;var f=s.getNodeIndex;var l=s.isOrIsAncestorOf;var o=s.getDocument;var d=s.comparePoints;var c=s.splitDataNode;var h=s.getClosestAncestorIn;var p=s.getNodeLength;var g=s.arrayContains;var N=s.getRootContainer;var B=a.features.crashyTextNodes;var m=s.removeNode;function v(e,t){return e.nodeType!=3&&(l(e,t.startContainer)||l(e,t.endContainer))}function E(e){return e.document||o(e.startContainer)}function U(e){return N(e.startContainer)}function C(e){return new t(e.parentNode,f(e))}function y(e){return new t(e.parentNode,f(e)+1)}function n(e,t,n){var r=e.nodeType==11?e.firstChild:e;if(u(t))if(n==t.length)s.insertAfter(e,t);else t.parentNode.insertBefore(e,n==0?t:c(t,n));else if(n>=t.childNodes.length)t.appendChild(e);else t.insertBefore(e,t.childNodes[n]);return r}function H(e,t,n){D(e);D(t);if(E(t)!=E(e))throw new i("WRONG_DOCUMENT_ERR");var r=d(e.startContainer,e.startOffset,t.endContainer,t.endOffset),o=d(e.endContainer,e.endOffset,t.startContainer,t.startOffset);return n?r<=0&&o>=0:r<0&&o>0}function F(e){var t;for(var n,r=E(e.range).createDocumentFragment(),o;n=e.next();){t=e.isPartiallySelectedSubtree();n=n.cloneNode(!t);if(t){o=e.getSubtreeIterator();n.appendChild(F(o));o.detach()}if(n.nodeType==10)throw new i("HIERARCHY_REQUEST_ERR");r.appendChild(n)}return r}function b(e,t,n){var r,o;n=n||{stop:false};for(var i,a;i=e.next();)if(e.isPartiallySelectedSubtree())if(t(i)===false){n.stop=true;return}else{a=e.getSubtreeIterator();b(a,t,n);a.detach();if(n.stop)return}else{r=s.createIterator(i);while(o=r.next())if(t(o)===false){n.stop=true;return}}}function V(e){var t;while(e.next())if(e.isPartiallySelectedSubtree()){t=e.getSubtreeIterator();V(t);t.detach()}else e.remove()}function q(e){for(var t,n=E(e.range).createDocumentFragment(),r;t=e.next();){if(e.isPartiallySelectedSubtree()){t=t.cloneNode(false);r=e.getSubtreeIterator();t.appendChild(q(r));r.detach()}else e.remove();if(t.nodeType==10)throw new i("HIERARCHY_REQUEST_ERR");n.appendChild(t)}return n}function X(r,e,o){var i=!!(e&&e.length),a;var s=!!o;if(i)a=new RegExp("^("+e.join("|")+")$");var l=[];b(new T(r,false),function(e){if(i&&!a.test(e.nodeType))return;if(s&&!o(e))return;var t=r.startContainer;if(e==t&&u(t)&&r.startOffset==t.length)return;var n=r.endContainer;if(e==n&&u(n)&&r.endOffset==0)return;l.push(e)});return l}function W(e){var t=typeof e.getName=="undefined"?"Range":e.getName();return"["+t+"("+s.inspectNode(e.startContainer)+":"+e.startOffset+", "+s.inspectNode(e.endContainer)+":"+e.endOffset+")]"}function T(e,t){this.range=e;this.clonePartiallySelectedTextNodes=t;if(!e.collapsed){this.sc=e.startContainer;this.so=e.startOffset;this.ec=e.endContainer;this.eo=e.endOffset;var n=e.commonAncestorContainer;if(this.sc===this.ec&&u(this.sc)){this.isSingleCharacterDataNode=true;this._first=this._last=this._next=this.sc}else{this._first=this._next=this.sc===n&&!u(this.sc)?this.sc.childNodes[this.so]:h(this.sc,n,true);this._last=this.ec===n&&!u(this.ec)?this.ec.childNodes[this.eo-1]:h(this.ec,n,true)}}}T.prototype={_current:null,_next:null,_first:null,_last:null,isSingleCharacterDataNode:false,reset:function(){this._current=null;this._next=this._first},hasNext:function(){return!!this._next},next:function(){var e=this._current=this._next;if(e){this._next=e!==this._last?e.nextSibling:null;if(u(e)&&this.clonePartiallySelectedTextNodes){if(e===this.ec)(e=e.cloneNode(true)).deleteData(this.eo,e.length-this.eo);if(this._current===this.sc)(e=e.cloneNode(true)).deleteData(0,this.so)}}return e},remove:function(){var e=this._current,t,n;if(u(e)&&(e===this.sc||e===this.ec)){t=e===this.sc?this.so:0;n=e===this.ec?this.eo:e.length;if(t!=n)e.deleteData(t,n-t)}else if(e.parentNode)m(e);else;},isPartiallySelectedSubtree:function(){var e=this._current;return v(e,this.range)},getSubtreeIterator:function(){var e;if(this.isSingleCharacterDataNode){e=this.range.cloneRange();e.collapse(false)}else{e=new I(E(this.range));var t=this._current;var n=t,r=0,o=t,i=p(t);if(l(t,this.sc)){n=this.sc;r=this.so}if(l(t,this.ec)){o=this.ec;i=this.eo}M(e,n,r,o,i)}return new T(e,this.clonePartiallySelectedTextNodes)},detach:function(){this.range=this._current=this._next=this._first=this._last=this.sc=this.so=this.ec=this.eo=null}};var j=[1,3,4,5,7,8,10];var K=[2,9,11];var z=[5,6,10,12];var G=[1,3,4,5,7,8,10,11];var $=[1,3,4,5,7,8];function e(o){return function(e,t){var n,r=t?e:e.parentNode;while(r){n=r.nodeType;if(g(o,n))return r;r=r.parentNode}return null}}var Y=e([9,11]);var Q=e(z);var Z=e([6,10,12]);var J=e([1]);function O(e,t){if(Z(e,t))throw new i("INVALID_NODE_TYPE_ERR")}function S(e,t){if(!g(t,e.nodeType))throw new i("INVALID_NODE_TYPE_ERR")}function R(e,t){if(t<0||t>(u(e)?e.length:e.childNodes.length))throw new i("INDEX_SIZE_ERR")}function w(e,t){if(Y(e,true)!==Y(t,true))throw new i("WRONG_DOCUMENT_ERR")}function A(e){if(Q(e,true))throw new i("NO_MODIFICATION_ALLOWED_ERR")}function ee(e,t){if(!e)throw new i(t)}function te(e,t){return t<=(u(e)?e.length:e.childNodes.length)}function ne(e){return!!e.startContainer&&!!e.endContainer&&!(B&&(s.isBrokenNode(e.startContainer)||s.isBrokenNode(e.endContainer)))&&N(e.startContainer)==N(e.endContainer)&&te(e.startContainer,e.startOffset)&&te(e.endContainer,e.endOffset)}function D(e){if(!ne(e))throw new Error("Range error: Range is not valid. This usually happens after DOM mutation. Range: ("+e.inspect()+")")}var re=document.createElement("style");var x=false;try{re.innerHTML="<b>x</b>";x=re.firstChild.nodeType==3}catch(e){}a.features.htmlParsingConforms=x;var oe=x?function(e){var t=this.startContainer;var n=o(t);if(!t)throw new i("INVALID_STATE_ERR");var r=null;if(t.nodeType==1)r=t;else if(u(t))r=s.parentElement(t);if(r===null||r.nodeName=="HTML"&&s.isHtmlNamespace(o(r).documentElement)&&s.isHtmlNamespace(r))r=n.createElement("body");else r=r.cloneNode(false);r.innerHTML=e;return s.fragmentFromNodeChildren(r)}:function(e){var t=E(this);var n=t.createElement("body");n.innerHTML=e;return s.fragmentFromNodeChildren(n)};function ie(e,t){D(e);var n=e.startContainer,r=e.startOffset,o=e.endContainer,i=e.endOffset;var a=n===o;if(u(o)&&i>0&&i<o.length)c(o,i,t);if(u(n)&&r>0&&r<n.length){n=c(n,r,t);if(a){i-=r;o=n}else if(o==n.parentNode&&i>=f(n))i++;r=0}e.setStartAndEnd(n,r,o,i)}function ae(e){D(e);var t=e.commonAncestorContainer.parentNode.cloneNode(false);t.appendChild(e.cloneContents());return t.innerHTML}var _=["startContainer","startOffset","endContainer","endOffset","collapsed","commonAncestorContainer"];var L=0,se=1,le=2,de=3;var ce=0,ue=1,fe=2,k=3;r.extend(a.rangePrototype,{compareBoundaryPoints:function(e,t){D(this);w(this.startContainer,t.startContainer);var n,r,o,i;var a=e==de||e==L?"start":"end";var s=e==se||e==L?"start":"end";n=this[a+"Container"];r=this[a+"Offset"];o=t[s+"Container"];i=t[s+"Offset"];return d(n,r,o,i)},insertNode:function(e){D(this);S(e,G);A(this.startContainer);if(l(e,this.startContainer))throw new i("HIERARCHY_REQUEST_ERR");var t=n(e,this.startContainer,this.startOffset);this.setStartBefore(t)},cloneContents:function(){D(this);var e,t;if(this.collapsed)return E(this).createDocumentFragment();else{if(this.startContainer===this.endContainer&&u(this.startContainer)){e=this.startContainer.cloneNode(true);e.data=e.data.slice(this.startOffset,this.endOffset);t=E(this).createDocumentFragment();t.appendChild(e);return t}else{var n=new T(this,true);e=F(n);n.detach()}return e}},canSurroundContents:function(){D(this);A(this.startContainer);A(this.endContainer);var e=new T(this,true);var t=e._first&&v(e._first,this)||e._last&&v(e._last,this);e.detach();return!t},surroundContents:function(e){S(e,$);if(!this.canSurroundContents())throw new i("INVALID_STATE_ERR");var t=this.extractContents();if(e.hasChildNodes())while(e.lastChild)e.removeChild(e.lastChild);n(e,this.startContainer,this.startOffset);e.appendChild(t);this.selectNode(e)},cloneRange:function(){D(this);var e=new I(E(this));var t=_.length,n;while(t--){n=_[t];e[n]=this[n]}return e},toString:function(){D(this);var e=this.startContainer;if(e===this.endContainer&&u(e))return e.nodeType==3||e.nodeType==4?e.data.slice(this.startOffset,this.endOffset):"";else{var t=[],n=new T(this,true);b(n,function(e){if(e.nodeType==3||e.nodeType==4)t.push(e.data)});n.detach();return t.join("")}},compareNode:function(e){D(this);var t=e.parentNode;var n=f(e);if(!t)throw new i("NOT_FOUND_ERR");var r=this.comparePoint(t,n),o=this.comparePoint(t,n+1);if(r<0)return o>0?fe:ce;else return o>0?ue:k},comparePoint:function(e,t){D(this);ee(e,"HIERARCHY_REQUEST_ERR");w(e,this.startContainer);if(d(e,t,this.startContainer,this.startOffset)<0)return-1;else if(d(e,t,this.endContainer,this.endOffset)>0)return 1;return 0},createContextualFragment:oe,toHtml:function(){return ae(this)},intersectsNode:function(e,t){D(this);if(N(e)!=U(this))return false;var n=e.parentNode,r=f(e);if(!n)return true;var o=d(n,r,this.endContainer,this.endOffset),i=d(n,r+1,this.startContainer,this.startOffset);return t?o<=0&&i>=0:o<0&&i>0},isPointInRange:function(e,t){D(this);ee(e,"HIERARCHY_REQUEST_ERR");w(e,this.startContainer);return d(e,t,this.startContainer,this.startOffset)>=0&&d(e,t,this.endContainer,this.endOffset)<=0},intersectsRange:function(e){return H(this,e,false)},intersectsOrTouchesRange:function(e){return H(this,e,true)},intersection:function(e){if(this.intersectsRange(e)){var t=d(this.startContainer,this.startOffset,e.startContainer,e.startOffset),n=d(this.endContainer,this.endOffset,e.endContainer,e.endOffset);var r=this.cloneRange();if(t==-1)r.setStart(e.startContainer,e.startOffset);if(n==1)r.setEnd(e.endContainer,e.endOffset);return r}return null},union:function(e){if(this.intersectsOrTouchesRange(e)){var t=this.cloneRange();if(d(e.startContainer,e.startOffset,this.startContainer,this.startOffset)==-1)t.setStart(e.startContainer,e.startOffset);if(d(e.endContainer,e.endOffset,this.endContainer,this.endOffset)==1)t.setEnd(e.endContainer,e.endOffset);return t}else throw new i("Ranges do not intersect")},containsNode:function(e,t){if(t)return this.intersectsNode(e,false);else return this.compareNode(e)==k},containsNodeContents:function(e){return this.comparePoint(e,0)>=0&&this.comparePoint(e,p(e))<=0},containsRange:function(e){var t=this.intersection(e);return t!==null&&e.equals(t)},containsNodeText:function(e){var t=this.cloneRange();t.selectNode(e);var n=t.getNodes([3]);if(n.length>0){t.setStart(n[0],0);var r=n.pop();t.setEnd(r,r.length);return this.containsRange(t)}else return this.containsNodeContents(e)},getNodes:function(e,t){D(this);return X(this,e,t)},getDocument:function(){return E(this)},collapseBefore:function(e){this.setEndBefore(e);this.collapse(false)},collapseAfter:function(e){this.setStartAfter(e);this.collapse(true)},getBookmark:function(e){var t=E(this);var n=a.createRange(t);e=e||s.getBody(t);n.selectNodeContents(e);var r=this.intersection(n);var o=0,i=0;if(r){n.setEnd(r.startContainer,r.startOffset);o=n.toString().length;i=o+r.toString().length}return{start:o,end:i,containerNode:e}},moveToBookmark:function(e){var t=e.containerNode;var n=0;this.setStart(t,0);this.collapse(true);var r=[t],o,i=false,a=false;var s,l,d;while(!a&&(o=r.pop()))if(o.nodeType==3){s=n+o.length;if(!i&&e.start>=n&&e.start<=s){this.setStart(o,e.start-n);i=true}if(i&&e.end>=n&&e.end<=s){this.setEnd(o,e.end-n);a=true}n=s}else{d=o.childNodes;l=d.length;while(l--)r.push(d[l])}},getName:function(){return"DomRange"},equals:function(e){return I.rangesEqual(this,e)},isValid:function(){return ne(this)},inspect:function(){return W(this)},detach:function(){}});function he(e){e.START_TO_START=L;e.START_TO_END=se;e.END_TO_END=le;e.END_TO_START=de;e.NODE_BEFORE=ce;e.NODE_AFTER=ue;e.NODE_BEFORE_AND_AFTER=fe;e.NODE_INSIDE=k}function pe(e){he(e);he(e.prototype)}function ge(s,l){return function(){D(this);var e=this.startContainer,t=this.startOffset,n=this.commonAncestorContainer;var r=new T(this,true);var o,i;if(e!==n){o=h(e,n,true);i=y(o);e=i.node;t=i.offset}b(r,A);r.reset();var a=s(r);r.detach();l(this,e,t,e,t);return a}}function Ne(e,c){function t(n,r){return function(e){S(e,j);S(N(e),K);var t=(n?C:y)(e);(r?o:i)(this,t.node,t.offset)}}function o(e,t,n){var r=e.endContainer,o=e.endOffset;if(t!==e.startContainer||n!==e.startOffset){if(N(t)!=N(r)||d(t,n,r,o)==1){r=t;o=n}c(e,t,n,r,o)}}function i(e,t,n){var r=e.startContainer,o=e.startOffset;if(t!==e.endContainer||n!==e.endOffset){if(N(t)!=N(r)||d(t,n,r,o)==-1){r=t;o=n}c(e,r,o,t,n)}}var n=function(){};n.prototype=a.rangePrototype;e.prototype=new n;r.extend(e.prototype,{setStart:function(e,t){O(e,true);R(e,t);o(this,e,t)},setEnd:function(e,t){O(e,true);R(e,t);i(this,e,t)},setStartAndEnd:function(){var e=arguments;var t=e[0],n=e[1],r=t,o=n;switch(e.length){case 3:o=e[2];break;case 4:r=e[2];o=e[3];break}O(t,true);R(t,n);O(r,true);R(r,o);c(this,t,n,r,o)},setBoundary:function(e,t,n){this["set"+(n?"Start":"End")](e,t)},setStartBefore:t(true,true),setStartAfter:t(false,true),setEndBefore:t(true,false),setEndAfter:t(false,false),collapse:function(e){D(this);if(e)c(this,this.startContainer,this.startOffset,this.startContainer,this.startOffset);else c(this,this.endContainer,this.endOffset,this.endContainer,this.endOffset)},selectNodeContents:function(e){O(e,true);c(this,e,0,e,p(e))},selectNode:function(e){O(e,false);S(e,j);var t=C(e),n=y(e);c(this,t.node,t.offset,n.node,n.offset)},extractContents:ge(q,c),deleteContents:ge(V,c),canSurroundContents:function(){D(this);A(this.startContainer);A(this.endContainer);var e=new T(this,true);var t=e._first&&v(e._first,this)||e._last&&v(e._last,this);e.detach();return!t},splitBoundaries:function(){ie(this)},splitBoundariesPreservingPositions:function(e){ie(this,e)},normalizeBoundaries:function(){D(this);var o=this.startContainer,i=this.startOffset,a=this.endContainer,s=this.endOffset;var e=function(e){var t=e.nextSibling;if(t&&t.nodeType==e.nodeType){a=e;s=e.length;e.appendData(t.data);m(t)}};var t=function(e){var t=e.previousSibling;if(t&&t.nodeType==e.nodeType){o=e;var n=e.length;i=t.length;e.insertData(0,t.data);m(t);if(o==a){s+=i;a=o}else if(a==e.parentNode){var r=f(e);if(s==r){a=e;s=n}else if(s>r)s--}}};var n=true;var r;if(u(a)){if(s==a.length)e(a);else if(s==0){r=a.previousSibling;if(r&&r.nodeType==a.nodeType){s=r.length;if(o==a)n=false;r.appendData(a.data);m(a);a=r}}}else{if(s>0){var l=a.childNodes[s-1];if(l&&u(l))e(l)}n=!this.collapsed}if(n){if(u(o)){if(i==0)t(o);else if(i==o.length){r=o.nextSibling;if(r&&r.nodeType==o.nodeType){if(a==r){a=o;s+=o.length}o.appendData(r.data);m(r)}}}else if(i<o.childNodes.length){var d=o.childNodes[i];if(d&&u(d))t(d)}}else{o=a;i=s}c(this,o,i,a,s)},collapseToPoint:function(e,t){O(e,true);R(e,t);this.setStartAndEnd(e,t)},parentElement:function(){D(this);var e=this.commonAncestorContainer;return e?J(this.commonAncestorContainer,true):null}});pe(e)}function me(e){e.collapsed=e.startContainer===e.endContainer&&e.startOffset===e.endOffset;e.commonAncestorContainer=e.collapsed?e.startContainer:s.getCommonAncestor(e.startContainer,e.endContainer)}function M(e,t,n,r,o){e.startContainer=t;e.startOffset=n;e.endContainer=r;e.endOffset=o;e.document=s.getDocument(t);me(e)}function I(e){M(this,e,0,e,0)}Ne(I,M);r.extend(I,{rangeProperties:_,RangeIterator:T,copyComparisonConstants:pe,createPrototypeRange:Ne,inspect:W,toHtml:ae,getRangeDocument:E,rangesEqual:function(e,t){return e.startContainer===t.startContainer&&e.startOffset===t.startOffset&&e.endContainer===t.endContainer&&e.endOffset===t.endOffset}});a.DomRange=I}),v.createCoreModule("WrappedRange",["DomRange"],function(u,f){var h,e;var b=u.dom;var p=u.util;var T=b.DomPosition;var g=u.DomRange;var N=b.getBody;var m=b.getContentDocument;var O=b.isCharacterDataNode;if(u.features.implementsDomRange)(function(){var t;var r=g.rangeProperties;function o(e){var t=r.length,n;while(t--){n=r[t];e[n]=e.nativeRange[n]}e.collapsed=e.startContainer===e.endContainer&&e.startOffset===e.endOffset}function e(e,t,n,r,o){var i=e.startContainer!==t||e.startOffset!=n;var a=e.endContainer!==r||e.endOffset!=o;var s=!e.equals(e.nativeRange);if(i||a||s){e.setEnd(r,o);e.setStart(t,n)}}var n;h=function(e){if(!e)throw f.createError("WrappedRange: Range must be specified");this.nativeRange=e;o(this)};g.createPrototypeRange(h,e);t=h.prototype;t.selectNode=function(e){this.nativeRange.selectNode(e);o(this)};t.cloneContents=function(){return this.nativeRange.cloneContents()};t.surroundContents=function(e){this.nativeRange.surroundContents(e);o(this)};t.collapse=function(e){this.nativeRange.collapse(e);o(this)};t.cloneRange=function(){return new h(this.nativeRange.cloneRange())};t.refresh=function(){o(this)};t.toString=function(){return this.nativeRange.toString()};var i=document.createTextNode("test");N(document).appendChild(i);var a=document.createRange();a.setStart(i,0);a.setEnd(i,0);try{a.setStart(i,1);t.setStart=function(e,t){this.nativeRange.setStart(e,t);o(this)};t.setEnd=function(e,t){this.nativeRange.setEnd(e,t);o(this)};n=function(t){return function(e){this.nativeRange[t](e);o(this)}}}catch(e){t.setStart=function(t,n){try{this.nativeRange.setStart(t,n)}catch(e){this.nativeRange.setEnd(t,n);this.nativeRange.setStart(t,n)}o(this)};t.setEnd=function(t,n){try{this.nativeRange.setEnd(t,n)}catch(e){this.nativeRange.setStart(t,n);this.nativeRange.setEnd(t,n)}o(this)};n=function(n,r){return function(t){try{this.nativeRange[n](t)}catch(e){this.nativeRange[r](t);this.nativeRange[n](t)}o(this)}}}t.setStartBefore=n("setStartBefore","setEndBefore");t.setStartAfter=n("setStartAfter","setEndAfter");t.setEndBefore=n("setEndBefore","setStartBefore");t.setEndAfter=n("setEndAfter","setStartAfter");t.selectNodeContents=function(e){this.setStartAndEnd(e,0,b.getNodeLength(e))};a.selectNodeContents(i);a.setEnd(i,3);var s=document.createRange();s.selectNodeContents(i);s.setEnd(i,4);s.setStart(i,2);if(a.compareBoundaryPoints(a.START_TO_END,s)==-1&&a.compareBoundaryPoints(a.END_TO_START,s)==1)t.compareBoundaryPoints=function(e,t){t=t.nativeRange||t;if(e==t.START_TO_END)e=t.END_TO_START;else if(e==t.END_TO_START)e=t.START_TO_END;return this.nativeRange.compareBoundaryPoints(e,t)};else t.compareBoundaryPoints=function(e,t){return this.nativeRange.compareBoundaryPoints(e,t.nativeRange||t)};var l=document.createElement("div");l.innerHTML="123";var d=l.firstChild;var c=N(document);c.appendChild(l);a.setStart(d,1);a.setEnd(d,2);a.deleteContents();if(d.data=="13"){t.deleteContents=function(){this.nativeRange.deleteContents();o(this)};t.extractContents=function(){var e=this.nativeRange.extractContents();o(this);return e}}else;c.removeChild(l);c=null;if(p.isHostMethod(a,"createContextualFragment"))t.createContextualFragment=function(e){return this.nativeRange.createContextualFragment(e)};N(document).removeChild(i);t.getName=function(){return"WrappedRange"};u.WrappedRange=h;u.createNativeRange=function(e){e=m(e,f,"createNativeRange");return e.createRange()}})();if(u.features.implementsTextRange){var o=function(e){var t=e.parentElement();var n=e.duplicate();n.collapse(true);var r=n.parentElement();n=e.duplicate();n.collapse(false);var o=n.parentElement();var i=r==o?r:b.getCommonAncestor(r,o);return i==t?i:b.getCommonAncestor(t,i)};var i=function(e){return e.compareEndPoints("StartToEnd",e)==0};var a=function(e,t,n,r,o){var i=e.duplicate();i.collapse(n);var a=i.parentElement();if(!b.isOrIsAncestorOf(t,a))a=t;if(!a.canHaveHTML){var s=new T(a.parentNode,b.getNodeIndex(a));return{boundaryPosition:s,nodeInfo:{nodeIndex:s.offset,containerElement:s.node}}}var l=b.getDocument(a).createElement("span");if(l.parentNode)b.removeNode(l);var d,c=n?"StartToStart":"StartToEnd";var u,f,h,p;var g=o&&o.containerElement==a?o.nodeIndex:0;var N=a.childNodes.length;var m=N;var v=m;while(true){if(v==N)a.appendChild(l);else a.insertBefore(l,a.childNodes[v]);i.moveToElementText(l);d=i.compareEndPoints(c,e);if(d==0||g==m)break;else if(d==-1)if(m==g+1)break;else g=v;else m=m==g+1?g:v;v=Math.floor((g+m)/2);a.removeChild(l)}p=l.nextSibling;if(d==-1&&p&&O(p)){i.setEndPoint(n?"EndToStart":"EndToEnd",e);var E;if(/[\r\n]/.test(p.data)){var C=i.duplicate();var y=C.text.replace(/\r\n/g,"\r").length;E=C.moveStart("character",y);while((d=C.compareEndPoints("StartToEnd",C))==-1){E++;C.moveStart("character",1)}}else E=i.text.length;h=new T(p,E)}else{u=(r||!n)&&l.previousSibling;f=(r||n)&&l.nextSibling;if(f&&O(f))h=new T(f,0);else if(u&&O(u))h=new T(u,u.data.length);else h=new T(a,b.getNodeIndex(l))}b.removeNode(l);return{boundaryPosition:h,nodeInfo:{nodeIndex:v,containerElement:a}}};var s=function(e,t){var n,r,o=e.offset;var i=b.getDocument(e.node);var a,s,l=N(i).createTextRange();var d=O(e.node);if(d){n=e.node;r=n.parentNode}else{s=e.node.childNodes;n=o<s.length?s[o]:null;r=e.node}a=i.createElement("span");a.innerHTML="&#feff;";if(n)r.insertBefore(a,n);else r.appendChild(a);l.moveToElementText(a);l.collapse(!t);r.removeChild(a);if(d)l[t?"moveStart":"moveEnd"]("character",o);return l};e=function(e){this.textRange=e;this.refresh()};e.prototype=new g(document);e.prototype.refresh=function(){var e,t,n;var r=o(this.textRange);if(i(this.textRange))t=e=a(this.textRange,r,true,true).boundaryPosition;else{n=a(this.textRange,r,true,false);e=n.boundaryPosition;t=a(this.textRange,r,false,false,n.nodeInfo).boundaryPosition}this.setStart(e.node,e.offset);this.setEnd(t.node,t.offset)};e.prototype.getName=function(){return"WrappedTextRange"};g.copyComparisonConstants(e);var t=function(e){if(e.collapsed)return s(new T(e.startContainer,e.startOffset),true);else{var t=s(new T(e.startContainer,e.startOffset),true);var n=s(new T(e.endContainer,e.endOffset),false);var r=N(g.getRangeDocument(e)).createTextRange();r.setEndPoint("StartToStart",t);r.setEndPoint("EndToEnd",n);return r}};e.rangeToTextRange=t;e.prototype.toTextRange=function(){return t(this)};u.WrappedTextRange=e;if(!u.features.implementsDomRange||u.config.preferTextRange){var n=function(e){return e("return this;")()}(Function);if(typeof n.Range=="undefined")n.Range=e;u.createNativeRange=function(e){e=m(e,f,"createNativeRange");return N(e).createTextRange()};u.WrappedRange=e}}u.createRange=function(e){e=m(e,f,"createRange");return new u.WrappedRange(u.createNativeRange(e))};u.createRangyRange=function(e){e=m(e,f,"createRangyRange");return new g(e)};p.createAliasForDeprecatedMethod(u,"createIframeRange","createRange");p.createAliasForDeprecatedMethod(u,"createIframeRangyRange","createRangyRange");u.addShimListener(function(e){var t=e.document;if(typeof t.createRange=="undefined")t.createRange=function(){return u.createRange(t)};t=e=null})}),v.createCoreModule("WrappedSelection",["DomRange","WrappedRange"],function(u,l){u.config.checkSelectionRanges=true;var P="boolean";var e="number";var f=u.dom;var t=u.util;var n=t.isHostMethod;var s=u.DomRange;var i=u.WrappedRange;var r=u.DOMException;var B=f.DomPosition;var o;var a;var d=u.features;var c="Control";var h=f.getDocument;var p=f.getBody;var g=s.rangesEqual;function N(e){return typeof e=="string"?/^backward(s)?$/i.test(e):!!e}function m(e,t){if(!e)return window;else if(f.isWindow(e))return e;else if(e instanceof x)return e.win;else{var n=f.getContentDocument(e,l,t);return f.getWindow(n)}}function U(e){return m(e,"getWinSelection").getSelection()}function H(e){return m(e,"getDocSelection").document.selection}function F(e){var t=false;if(e.anchorNode)t=f.comparePoints(e.anchorNode,e.anchorOffset,e.focusNode,e.focusOffset)==1;return t}var V=n(window,"getSelection"),v=t.isHostObject(document,"selection");d.implementsWinGetSelection=V;d.implementsDocSelection=v;var E=v&&(!V||u.config.preferTextRange);if(E){o=H;u.isSelectionValid=function(e){var t=m(e,"isSelectionValid").document,n=t.selection;return n.type!="None"||h(n.createRange().parentElement())==t}}else if(V){o=U;u.isSelectionValid=function(){return true}}else{l.fail("Neither document.selection or window.getSelection() detected.");return false}u.getNativeSelection=o;var C=o();if(!C){l.fail("Native selection was null (possibly issue 138?)");return false}var q=u.createNativeRange(document);var X=p(document);var y=t.areHostProperties(C,["anchorNode","focusNode","anchorOffset","focusOffset"]);d.selectionHasAnchorAndFocus=y;var b=n(C,"extend");d.selectionHasExtend=b;var W=n(C,"setBaseAndExtent");d.selectionHasSetBaseAndExtent=W;var j=typeof C.rangeCount==e;d.selectionHasRangeCount=j;var T=false;var K=true;var z=b?function(e,t){var n=s.getRangeDocument(t);var r=u.createRange(n);r.collapseToPoint(t.endContainer,t.endOffset);e.addRange(Y(r));e.extend(t.startContainer,t.startOffset)}:null;if(t.areHostMethods(C,["addRange","getRangeAt","removeAllRanges"])&&typeof C.rangeCount==e&&d.implementsDomRange)(function(){var e=window.getSelection();if(e){var t=e.rangeCount;var n=t>1;var r=[];var o=F(e);for(var i=0;i<t;++i)r[i]=e.getRangeAt(i);var a=f.createTestElement(document,"",false);var s=a.appendChild(document.createTextNode("   "));var l=document.createRange();l.setStart(s,1);l.collapse(true);e.removeAllRanges();e.addRange(l);K=e.rangeCount==1;e.removeAllRanges();if(!n){var d=window.navigator.appVersion.match(/Chrome\/(.*?) /);if(d&&parseInt(d[1])>=36)T=false;else{var c=l.cloneRange();l.setStart(s,0);c.setEnd(s,3);c.setStart(s,2);e.addRange(l);e.addRange(c);T=e.rangeCount==2}}f.removeNode(a);e.removeAllRanges();for(i=0;i<t;++i)if(i==0&&o)if(z)z(e,r[i]);else{u.warn("Rangy initialization: original selection was backwards but selection has been restored forwards because the browser does not support Selection.extend");e.addRange(r[i])}else e.addRange(r[i])}})();d.selectionSupportsMultipleRanges=T;d.collapsedNonEditableSelectionsSupported=K;var O=false,G;if(X&&n(X,"createControlRange")){G=X.createControlRange();if(t.areHostProperties(G,["item","add"]))O=true}d.implementsControlRange=O;if(y)a=function(e){return e.anchorNode===e.focusNode&&e.anchorOffset===e.focusOffset};else a=function(e){return e.rangeCount?e.getRangeAt(e.rangeCount-1).collapsed:false};function S(e,t,n){var r=n?"end":"start",o=n?"start":"end";e.anchorNode=t[r+"Container"];e.anchorOffset=t[r+"Offset"];e.focusNode=t[o+"Container"];e.focusOffset=t[o+"Offset"]}function $(e){var t=e.nativeSelection;e.anchorNode=t.anchorNode;e.anchorOffset=t.anchorOffset;e.focusNode=t.focusNode;e.focusOffset=t.focusOffset}function R(e){e.anchorNode=e.focusNode=null;e.anchorOffset=e.focusOffset=0;e.rangeCount=0;e.isCollapsed=true;e._ranges.length=0;w(e)}function w(e){e.type=e.rangeCount==0?"None":a(e)?"Caret":"Range"}function Y(e){var t;if(e instanceof s){t=u.createNativeRange(e.getDocument());t.setEnd(e.endContainer,e.endOffset);t.setStart(e.startContainer,e.startOffset)}else if(e instanceof i)t=e.nativeRange;else if(d.implementsDomRange&&e instanceof f.getWindow(e.startContainer).Range)t=e;return t}function Q(e){if(!e.length||e[0].nodeType!=1)return false;for(var t=1,n=e.length;t<n;++t)if(!f.isAncestorOf(e[0],e[t]))return false;return true}function Z(e){var t=e.getNodes();if(!Q(t))throw l.createError("getSingleElementFromRange: range "+e.inspect()+" did not consist of a single element");return t[0]}function J(e){return!!e&&typeof e.text!="undefined"}function ee(e,t){var n=new i(t);e._ranges=[n];S(e,n,false);e.rangeCount=1;e.isCollapsed=n.collapsed;w(e)}function A(e){e._ranges.length=0;if(e.docSelection.type=="None")R(e);else{var t=e.docSelection.createRange();if(J(t))ee(e,t);else{e.rangeCount=t.length;var n,r=h(t.item(0));for(var o=0;o<e.rangeCount;++o){n=u.createRange(r);n.selectNode(t.item(o));e._ranges.push(n)}e.isCollapsed=e.rangeCount==1&&e._ranges[0].collapsed;S(e,e._ranges[e.rangeCount-1],false);w(e)}}}function te(e,t){var n=e.docSelection.createRange();var r=Z(t);var o=h(n.item(0));var i=p(o).createControlRange();for(var a=0,s=n.length;a<s;++a)i.add(n.item(a));try{i.add(r)}catch(e){throw l.createError("addRange(): Element within the specified Range could not be added to control selection (does it have layout?)")}i.select();A(e)}var D;if(n(C,"getRangeAt"))D=function(e,t){try{return e.getRangeAt(t)}catch(e){return null}};else if(y)D=function(e){var t=h(e.anchorNode);var n=u.createRange(t);n.setStartAndEnd(e.anchorNode,e.anchorOffset,e.focusNode,e.focusOffset);if(n.collapsed!==this.isCollapsed)n.setStartAndEnd(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset);return n};function x(e,t,n){this.nativeSelection=e;this.docSelection=t;this._ranges=[];this.win=n;this.refresh()}x.prototype=u.selectionPrototype;function ne(e){e.win=e.anchorNode=e.focusNode=e._ranges=null;e.rangeCount=e.anchorOffset=e.focusOffset=0;e.detached=true;w(e)}var _=[];function re(e,t){var n=_.length,r,o;while(n--){r=_[n];o=r.selection;if(t=="deleteAll")ne(o);else if(r.win==e)if(t=="delete"){_.splice(n,1);return true}else return o}if(t=="deleteAll")_.length=0;return null}var oe=function(e){if(e&&e instanceof x){e.refresh();return e}e=m(e,"getNativeSelection");var t=re(e);var n=o(e),r=v?H(e):null;if(t){t.nativeSelection=n;t.docSelection=r;t.refresh()}else{t=new x(n,r,e);_.push({win:e,selection:t})}return t};u.getSelection=oe;t.createAliasForDeprecatedMethod(u,"getIframeSelection","getSelection");var L=x.prototype;function ie(e,t){var n=h(t[0].startContainer);var r=p(n).createControlRange();for(var o=0,i,a=t.length;o<a;++o){i=Z(t[o]);try{r.add(i)}catch(e){throw l.createError("setRanges(): Element within one of the specified Ranges could not be added to control selection (does it have layout?)")}}r.select();A(e)}if(!E&&y&&t.areHostMethods(C,["removeAllRanges","addRange"])){L.removeAllRanges=function(){this.nativeSelection.removeAllRanges();R(this)};var ae=function(e,t){z(e.nativeSelection,t);e.refresh()};if(j)L.addRange=function(e,t){if(O&&v&&this.docSelection.type==c)te(this,e);else if(N(t)&&b)ae(this,e);else{var n;if(T)n=this.rangeCount;else{this.removeAllRanges();n=0}var r=Y(e).cloneRange();try{this.nativeSelection.addRange(r)}catch(e){}this.rangeCount=this.nativeSelection.rangeCount;if(this.rangeCount==n+1){if(u.config.checkSelectionRanges){var o=D(this.nativeSelection,this.rangeCount-1);if(o&&!g(o,e))e=new i(o)}this._ranges[this.rangeCount-1]=e;S(this,e,M(this.nativeSelection));this.isCollapsed=a(this);w(this)}else this.refresh()}};else L.addRange=function(e,t){if(N(t)&&b)ae(this,e);else{this.nativeSelection.addRange(Y(e));this.refresh()}};L.setRanges=function(e){if(O&&v&&e.length>1)ie(this,e);else{this.removeAllRanges();for(var t=0,n=e.length;t<n;++t)this.addRange(e[t])}}}else if(n(C,"empty")&&n(q,"select")&&O&&E){L.removeAllRanges=function(){try{this.docSelection.empty();if(this.docSelection.type!="None"){var e;if(this.anchorNode)e=h(this.anchorNode);else if(this.docSelection.type==c){var t=this.docSelection.createRange();if(t.length)e=h(t.item(0))}if(e){var n=p(e).createTextRange();n.select();this.docSelection.empty()}}}catch(e){}R(this)};L.addRange=function(e){if(this.docSelection.type==c)te(this,e);else{u.WrappedTextRange.rangeToTextRange(e).select();this._ranges[0]=e;this.rangeCount=1;this.isCollapsed=this._ranges[0].collapsed;S(this,e,false);w(this)}};L.setRanges=function(e){this.removeAllRanges();var t=e.length;if(t>1)ie(this,e);else if(t)this.addRange(e[0])}}else{l.fail("No means of selecting a Range or TextRange was found");return false}L.getRangeAt=function(e){if(e<0||e>=this.rangeCount)throw new r("INDEX_SIZE_ERR");else return this._ranges[e].cloneRange()};var k;if(E)k=function(e){var t;if(u.isSelectionValid(e.win))t=e.docSelection.createRange();else{t=p(e.win.document).createTextRange();t.collapse(true)}if(e.docSelection.type==c)A(e);else if(J(t))ee(e,t);else R(e)};else if(n(C,"getRangeAt")&&typeof C.rangeCount==e)k=function(e){if(O&&v&&e.docSelection.type==c)A(e);else{e._ranges.length=e.rangeCount=e.nativeSelection.rangeCount;if(e.rangeCount){for(var t=0,n=e.rangeCount;t<n;++t)e._ranges[t]=new u.WrappedRange(e.nativeSelection.getRangeAt(t));S(e,e._ranges[e.rangeCount-1],M(e.nativeSelection));e.isCollapsed=a(e);w(e)}else R(e)}};else if(y&&typeof C.isCollapsed==P&&typeof q.collapsed==P&&d.implementsDomRange)k=function(e){var t,n=e.nativeSelection;if(n.anchorNode){t=D(n,0);e._ranges=[t];e.rangeCount=1;$(e);e.isCollapsed=a(e);w(e)}else R(e)};else{l.fail("No means of obtaining a Range or TextRange from the user's selection was found");return false}L.refresh=function(e){var t=e?this._ranges.slice(0):null;var n=this.anchorNode,r=this.anchorOffset;k(this);if(e){var o=t.length;if(o!=this._ranges.length)return true;if(this.anchorNode!=n||this.anchorOffset!=r)return true;while(o--)if(!g(t[o],this._ranges[o]))return true;return false}};var se=function(e,t){var n=e.getAllRanges();e.removeAllRanges();for(var r=0,o=n.length;r<o;++r)if(!g(t,n[r]))e.addRange(n[r]);if(!e.rangeCount)R(e)};if(O&&v)L.removeRange=function(e){if(this.docSelection.type==c){var t=this.docSelection.createRange();var n=Z(e);var r=h(t.item(0));var o=p(r).createControlRange();var i,a=false;for(var s=0,l=t.length;s<l;++s){i=t.item(s);if(i!==n||a)o.add(t.item(s));else a=true}o.select();A(this)}else se(this,e)};else L.removeRange=function(e){se(this,e)};var M;if(!E&&y&&d.implementsDomRange){M=F;L.isBackward=function(){return M(this)}}else M=L.isBackward=function(){return false};L.isBackwards=L.isBackward;L.toString=function(){var e=[];for(var t=0,n=this.rangeCount;t<n;++t)e[t]=""+this._ranges[t];return e.join("")};function I(e,t){if(e.win.document!=h(t))throw new r("WRONG_DOCUMENT_ERR")}function le(e,t){if(t<0||t>(f.isCharacterDataNode(e)?e.length:e.childNodes.length))throw new r("INDEX_SIZE_ERR")}L.collapse=function(e,t){I(this,e);var n=u.createRange(e);n.collapseToPoint(e,t);this.setSingleRange(n);this.isCollapsed=true};L.collapseToStart=function(){if(this.rangeCount){var e=this._ranges[0];this.collapse(e.startContainer,e.startOffset)}else throw new r("INVALID_STATE_ERR")};L.collapseToEnd=function(){if(this.rangeCount){var e=this._ranges[this.rangeCount-1];this.collapse(e.endContainer,e.endOffset)}else throw new r("INVALID_STATE_ERR")};L.selectAllChildren=function(e){I(this,e);var t=u.createRange(e);t.selectNodeContents(e);this.setSingleRange(t)};if(W)L.setBaseAndExtent=function(e,t,n,r){this.nativeSelection.setBaseAndExtent(e,t,n,r);this.refresh()};else if(b)L.setBaseAndExtent=function(e,t,n,r){le(e,t);le(n,r);I(this,e);I(this,n);var o=u.createRange(node);var i=f.comparePoints(e,t,n,r)==-1;if(i)o.setStartAndEnd(n,r,e,t);else o.setStartAndEnd(e,t,n,r);this.setSingleRange(o,i)};L.deleteFromDocument=function(){if(O&&v&&this.docSelection.type==c){var e=this.docSelection.createRange();var t;while(e.length){t=e.item(0);e.remove(t);f.removeNode(t)}this.refresh()}else if(this.rangeCount){var n=this.getAllRanges();if(n.length){this.removeAllRanges();for(var r=0,o=n.length;r<o;++r)n[r].deleteContents();this.addRange(n[o-1])}}};L.eachRange=function(e,t){for(var n=0,r=this._ranges.length;n<r;++n)if(e(this.getRangeAt(n)))return t};L.getAllRanges=function(){var t=[];this.eachRange(function(e){t.push(e)});return t};L.setSingleRange=function(e,t){this.removeAllRanges();this.addRange(e,t)};L.callMethodOnEachRange=function(t,n){var r=[];this.eachRange(function(e){r.push(e[t].apply(e,n||[]))});return r};function de(r){return function(e,t){var n;if(this.rangeCount){n=this.getRangeAt(0);n["set"+(r?"Start":"End")](e,t)}else{n=u.createRange(this.win.document);n.setStartAndEnd(e,t)}this.setSingleRange(n,this.isBackward())}}L.setStart=de(true);L.setEnd=de(false);u.rangePrototype.select=function(e){oe(this.getDocument()).setSingleRange(this,e)};L.changeEachRange=function(t){var n=[];var e=this.isBackward();this.eachRange(function(e){t(e);n.push(e)});this.removeAllRanges();if(e&&n.length==1)this.addRange(n[0],"backward");else this.setRanges(n)};L.containsNode=function(t,n){return this.eachRange(function(e){return e.containsNode(t,n)},true)||false};L.getBookmark=function(e){return{backward:this.isBackward(),rangeBookmarks:this.callMethodOnEachRange("getBookmark",[e])}};L.moveToBookmark=function(e){var t=[];for(var n=0,r,o;r=e.rangeBookmarks[n++];){o=u.createRange(this.win);o.moveToBookmark(r);t.push(o)}if(e.backward)this.setSingleRange(t[0],"backward");else this.setRanges(t)};L.saveRanges=function(){return{backward:this.isBackward(),ranges:this.callMethodOnEachRange("cloneRange")}};L.restoreRanges=function(e){this.removeAllRanges();for(var t=0,n;n=e.ranges[t];++t)this.addRange(n,e.backward&&t==0)};L.toHtml=function(){var t=[];this.eachRange(function(e){t.push(s.toHtml(e))});return t.join("")};if(d.implementsTextRange)L.getNativeTextRange=function(){var e,t;if(e=this.docSelection){var n=e.createRange();if(J(n))return n;else throw l.createError("getNativeTextRange: selection is a control selection")}else if(this.rangeCount>0)return u.WrappedTextRange.rangeToTextRange(this.getRangeAt(0));else throw l.createError("getNativeTextRange: selection contains no range")};function ce(e){var t=[];var n=new B(e.anchorNode,e.anchorOffset);var r=new B(e.focusNode,e.focusOffset);var o=typeof e.getName=="function"?e.getName():"Selection";if(typeof e.rangeCount!="undefined")for(var i=0,a=e.rangeCount;i<a;++i)t[i]=s.inspect(e.getRangeAt(i));return"["+o+"(Ranges: "+t.join(", ")+")(anchor: "+n.inspect()+", focus: "+r.inspect()+"]"}L.getName=function(){return"WrappedSelection"};L.inspect=function(){return ce(this)};L.detach=function(){re(this.win,"delete");ne(this)};x.detachAll=function(){re(null,"deleteAll")};x.inspect=ce;x.isDirectionBackward=N;u.Selection=x;u.selectionPrototype=L;u.addShimListener(function(e){if(typeof e.getSelection=="undefined")e.getSelection=function(){return oe(e)};e=null})});var M=false,I=function(e){if(!M){M=true;if(!v.initialized&&v.config.autoInitialize)w()}};if(m)if(document.readyState=="complete")I();else{if(u(document,"addEventListener"))document.addEventListener("DOMContentLoaded",I,false);E(window,"load",I)}return v}(),this.rangy.createModule("TextRange",["WrappedSelection"],function(N,P){function c(e,t,n){for(var r,o=n(e,t),i=[],a=0;r=o[a++];)i.push(function(e,t){for(var n=e.slice(t.start,t.end),r={isWord:t.isWord,chars:n,toString:function(){return n.join("")}},o=0,i=n.length;o<i;++o)n[o].token=r;return r}(e,r));return i}function u(e,t){var n,r,o,e=y(e,t);return t.hasOwnProperty("wordOptions")&&(e.wordOptions=(n=e.wordOptions)?(r=n.language||T,C(o={},A[r]||A[T]),C(o,n),o):A[T]),t.hasOwnProperty("characterOptions")&&(e.characterOptions=y(e.characterOptions,w)),e}function o(e,t){t=D(e,"display",t),e=e.tagName.toLowerCase();return"block"==t&&Y&&re.hasOwnProperty(e)?re[e]:t}function n(e){for(var t=function(e){for(var t=[];e.parentNode;)t.unshift(e.parentNode),e=e.parentNode;return t}(e=e).concat([e]),n=0,r=t.length;n<r;++n)if(1==t[n].nodeType&&"none"==o(t[n]))return!0;return!1}function B(e,t){if(!t&&e.hasChildNodes())return e.firstChild;for(var n=e;n&&!n.nextSibling;)n=n.parentNode;return n?n.nextSibling:null}function U(e){var t=e.previousSibling;if(t){for(e=t;e.hasChildNodes();)e=e.lastChild;return e}t=e.parentNode;return t&&1==t.nodeType?t:null}function H(e){var t,n;return!(!e||3!=e.nodeType)&&(""===(t=e.data)||!(!(n=e.parentNode)||1!=n.nodeType)&&(n=D(e.parentNode,"whiteSpace"),/^[\t\n\r ]+$/.test(t)&&/^(normal|nowrap)$/.test(n)||/^[\t\r ]+$/.test(t)&&"pre-line"==n))}function r(e){return""===e.data||!(!H(e)||e.parentNode&&!n(e))}function f(e){var t=e.nodeType;return 7==t||8==t||n(e)||/^(script|style)$/i.test(e.nodeName)||3==(t=e).nodeType&&(t=t.parentNode)&&"hidden"==D(t,"visibility")||r(e)}function F(e,t){var n=e.nodeType;return 7==n||8==n||1==n&&"none"==o(e,t)}function a(){this.store={}}function e(n,r,o){return function(e){var t=this.cache;if(t.hasOwnProperty(n))return t[n];0;e=r.call(this,o?this[o]:this,e);return t[n]=e}}function V(e,t){this.node=e,this.session=t,this.cache=new a,this.positions=new a}function q(e,t){this.offset=t,this.nodeWrapper=e,this.node=e.node,this.session=e.session,this.cache=new a}function s(){return M||(i(),M=new ce)}function i(){M&&M.detach(),M=null}function m(e,t,n,r){n&&(t?f(n.node)&&(n=e.previousVisible()):f(n.node)&&(n=n.nextVisible()));var o,i=e,a=!1,s=!1;return{next:function(){if(s)return s=!1,o;for(var e;e=null,t?(e=i,a||(i=i.previousVisible(),a=!i||n&&i.equals(n))):a||(e=i=i.nextVisible(),a=!i||n&&i.equals(n)),a&&(i=null),e=e;)if(e.getCharacter(r))return o=e;return null},rewind:function(){if(!o)throw P.createError("createCharacterIterator: cannot rewind. Only one position can be rewound.");s=!0},dispose:function(){e=n=null}}}function g(e,t,n){function r(e){for(var t,n,r=[],o=e?s:l,i=!1,a=!1;t=o.next();){if(n=t.character,G.test(n))a&&(i=!(a=!1));else{if(i){o.rewind();break}a=!0}r.push(t)}return r}var s=m(e,!1,null,t),l=m(e,!0,null,t),o=n.tokenizer,e=r(!0),t=r(!1).reverse(),i=c(t.concat(e),n,o),a=e.length?i.slice(fe(i,e[0].token)):[],d=t.length?i.slice(0,fe(i,t.pop().token)+1):[];return{nextEndToken:function(){for(var e,t;1==a.length&&!(e=a[0]).isWord&&0<(t=r(!0)).length;)a=c(e.chars.concat(t),n,o);return a.shift()},previousStartToken:function(){for(var e,t;1==d.length&&!(e=d[0]).isWord&&0<(t=r(!1)).length;)d=c(t.reverse().concat(e.chars),n,o);return d.pop()},dispose:function(){s.dispose(),l.dispose(),a=d=null}}}function X(e,t,n,r){var o=e.getRangeBoundaryPosition(t,!0),e=e.getRangeBoundaryPosition(t,!1);return m(r?e:o,!!r,r?o:e,n)}function W(e,t,n,r,o){function i(e,t){var n,r,e=p[e].previousVisible(),t=p[t-1];return{startPos:e,endPos:t,valid:!o.wholeWordsOnly||(e=e,t=t,n=o.wordOptions,(r=N.createRange(e.node)).setStartAndEnd(e.node,e.offset,t.node,t.offset),!r.expand("word",{wordOptions:n}))}}for(var a,s,l,d,c,u=O(o.direction),f=m(e,u,e.session.getRangeBoundaryPosition(r,u),o.characterOptions),h="",p=[],g=null;d=f.next();)if(a=d.character,n||o.caseSensitive||(a=a.toLowerCase()),u?(p.unshift(d),h=a+h):(p.push(d),h+=a),n){if(d=t.exec(h))if(l=(s=d.index)+d[0].length,c){if(!u&&l<h.length||u&&0<s){g=i(s,l);break}}else c=!0}else if(-1!=(s=h.indexOf(t))){g=i(s,s+t.length);break}return c&&(g=i(s,l)),f.dispose(),g}function t(n){return function(){var e=!!M,t=[s()].concat(p.toArray(arguments)),t=n.apply(this,t);return e||i(),t}}function l(i,a){return t(function(e,t,n,r){void 0===n&&(n=t,t=v),r=u(r,ee);var o=i,e=(a&&this.collapse(!(o=0<=n)),function(e,t,n,r,o){var i,a,s,l,d=0,c=e,u=Math.abs(n);if(0!==n){var f=n<0;switch(t){case v:for(a=m(e,f,null,r);(i=a.next())&&d<u;)++d,c=i;s=i,a.dispose();break;case E:for(var h=g(e,r,o),p=f?h.previousStartToken:h.nextEndToken;(l=p())&&d<u;)l.isWord&&(++d,c=f?l.chars[0]:l.chars[l.chars.length-1]);break;default:throw new Error("movePositionBy: unit '"+t+"' not implemented")}f?(c=c.previousVisible(),d=-d):c&&c.isLeadingSpace&&!c.isTrailingSpace&&(t==E&&(s=(a=m(e,!1,null,r)).next(),a.dispose()),s)&&(c=s.previousVisible())}return{position:c,unitsMoved:d}}(e.getRangeBoundaryPosition(this,o),t,n,r.characterOptions,r.wordOptions)),t=e.position;return this[o?"setStart":"setEnd"](t.node,t.offset),e.unitsMoved})}function j(i){return t(function(e,t){for(var n,r=X(e,this,t=y(t,w),!i),o=0;(n=r.next())&&G.test(n.character);)++o;r.dispose();e=0<o;return e&&this[i?"moveStart":"moveEnd"]("character",i?o:-o,{characterOptions:t}),e})}function d(r){return t(function(e,t){var n=!1;return this.changeEachRange(function(e){n=e[r](t)||n}),n})}var v="character",E="word",h=N.dom,p=N.util,C=p.extend,y=p.createOptions,b=h.getBody,K=/^[ \t\f\r\n]+$/,z=/^[ \t\f\r]+$/,G=/^[\t-\r \u0085\u00A0\u1680\u180E\u2000-\u200B\u2028\u2029\u202F\u205F\u3000]+$/,$=/^[\t \u00A0\u1680\u180E\u2000-\u200B\u202F\u205F\u3000]+$/,T="en",O=N.Selection.isDirectionBackward;S=h.createTestElement(document,"<p>1 </p><p></p>",!0),x=S.firstChild,(R=N.getSelection()).collapse(x.lastChild,2),R.setStart(x.firstChild,0),S.innerHTML="1 <br />",R.collapse(S,2),R.setStart(S.firstChild,0),x=1==(""+R).length,S.innerHTML="1 <p>1</p>",R.collapse(S,2),R.setStart(S.firstChild,0),k=1==(""+R).length,h.removeNode(S),R.removeAllRanges();var Y,S,R,Q,w={includeBlockContentTrailingSpace:!0,includeSpaceBeforeBr:!0,includeSpaceBeforeBlock:!0,includePreLineTrailingSpace:!0,ignoreCharacters:""},Z={includeBlockContentTrailingSpace:!1,includeSpaceBeforeBr:!x,includeSpaceBeforeBlock:!k,includePreLineTrailingSpace:!0},A={en:{wordRegex:/[a-z0-9]+('[a-z0-9]+)*/gi,includeTrailingSpace:!1,tokenizer:function(e,t){function n(e,t,n){s.push({start:e,end:t,isWord:n})}for(var r,o,i,a=e.join(""),s=[],l=0;r=t.wordRegex.exec(a);){if(i=(o=r.index)+r[0].length,l<o&&n(l,o,!1),t.includeTrailingSpace)for(;$.test(e[i]);)++i;n(o,i,!0),l=i}return l<e.length&&n(l,e.length,!1),s}}},J={caseSensitive:!1,withinRange:null,wholeWordsOnly:!1,wrap:!1,direction:"forward",wordOptions:null,characterOptions:null},ee={wordOptions:null,characterOptions:null},te={wordOptions:null,characterOptions:null,trim:!1,trimStart:!0,trimEnd:!0},ne={wordOptions:null,characterOptions:null,direction:"forward"},D=h.getComputedStyleProperty,re=(S=document.createElement("table"),(R=b(document)).appendChild(S),Y="block"==D(S,"display"),R.removeChild(S),{table:"table",caption:"table-caption",colgroup:"table-column-group",col:"table-column",thead:"table-header-group",tbody:"table-row-group",tfoot:"table-footer-group",tr:"table-row",td:"table-cell",th:"table-cell"}),x=(a.prototype={get:function(e){return this.store.hasOwnProperty(e)?this.store[e]:null},set:function(e,t){return this.store[e]=t}},{getPosition:function(e){var t=this.positions;return t.get(e)||t.set(e,new q(this,e))},toString:function(){return"[NodeWrapper("+h.inspectNode(this.node)+")]"}}),_="NON_SPACE",oe="UNCOLLAPSIBLE_SPACE",L="COLLAPSIBLE_SPACE",ie="TRAILING_SPACE_BEFORE_BLOCK",ae="TRAILING_SPACE_IN_BLOCK",se="TRAILING_SPACE_BEFORE_BR",le="PRE_LINE_TRAILING_SPACE_BEFORE_LINE_BREAK",de="INCLUDED_TRAILING_LINE_BREAK_AFTER_BR",k=(C(V.prototype=x,{isCharacterDataNode:e("isCharacterDataNode",h.isCharacterDataNode,"node"),getNodeIndex:e("nodeIndex",h.getNodeIndex,"node"),getLength:e("nodeLength",h.getNodeLength,"node"),containsPositions:e("containsPositions",function(e){return h.isCharacterDataNode(e)||!/^(area|base|basefont|br|col|frame|hr|img|input|isindex|link|meta|param)$/i.test(e.nodeName)},"node"),isWhitespace:e("isWhitespace",H,"node"),isCollapsedWhitespace:e("isCollapsedWhitespace",r,"node"),getComputedDisplay:e("computedDisplay",o,"node"),isCollapsed:e("collapsed",f,"node"),isIgnored:e("ignored",F,"node"),next:e("nextPos",B,"node"),previous:e("previous",U,"node"),getTextNodeInfo:e("textNodeInfo",function(e){var t=null,n=!1,r=D(e.parentNode,"whiteSpace"),o="pre-line"==r;return o?(t=z,n=!0):"normal"!=r&&"nowrap"!=r||(t=K,n=!0),{node:e,text:e.data,spaceRegex:t,collapseSpaces:n,preLine:o}},"node"),hasInnerText:e("hasInnerText",function(e,t){for(var n=this.session,r=n.getPosition(e.parentNode,this.getNodeIndex()+1),n=n.getPosition(e,0),o=t?r:n,i=t?n:r;o!==i;){if(o.prepopulateChar(),o.isDefinitelyNonEmpty())return!0;o=t?o.previousVisible():o.nextVisible()}return!1},"node"),isRenderedBlock:e("isRenderedBlock",function(e){for(var t=e.getElementsByTagName("br"),n=0,r=t.length;n<r;++n)if(!f(t[n]))return!0;return this.hasInnerText()},"node"),getTrailingSpace:e("trailingSpace",function(e){if("br"!=e.tagName.toLowerCase())switch(this.getComputedDisplay()){case"inline":for(var t=e.lastChild;t;){if(!F(t))return 1==t.nodeType?this.session.getNodeWrapper(t).getTrailingSpace():"";t=t.previousSibling}break;case"inline-block":case"inline-table":case"none":case"table-column":case"table-column-group":break;case"table-cell":return"\t";default:return this.isRenderedBlock(!0)?"\n":""}return""},"node"),getLeadingSpace:e("leadingSpace",function(){switch(this.getComputedDisplay()){case"inline":case"inline-block":case"inline-table":case"none":case"table-column":case"table-column-group":case"table-cell":break;default:return this.isRenderedBlock(!1)?"\n":""}return""},"node")}),{character:"",characterType:"EMPTY",isBr:!1,prepopulateChar:function(){var e,t,n,r,o,i,a,s,l,d=this;d.prepopulatedChar||(e=d.node,n="",o=!(r="EMPTY"),0<(t=d.offset)&&(3==e.nodeType?(a=(i=e.data).charAt(t-1),s=(l=d.nodeWrapper.getTextNodeInfo()).spaceRegex,l.collapseSpaces?s.test(a)?1<t&&s.test(i.charAt(t-2))||(r=l.preLine&&"\n"===i.charAt(t)?(n=" ",le):(n=" ",L)):(n=a,r=_,o=!0):(n=a,r=oe,o=!0)):((s=e.childNodes[t-1])&&1==s.nodeType&&!f(s)&&("br"==s.tagName.toLowerCase()?(n="\n",d.isBr=!0,o=!(r=L)):d.checkForTrailingSpace=!0),n||(l=e.childNodes[t])&&1==l.nodeType&&!f(l)&&(d.checkForLeadingSpace=!0))),d.prepopulatedChar=!0,d.character=n,d.characterType=r,d.isCharInvariant=o)},isDefinitelyNonEmpty:function(){var e=this.characterType;return e==_||e==oe},resolveLeadingAndTrailingSpaces:function(){var e;this.prepopulatedChar||this.prepopulateChar(),this.checkForTrailingSpace&&((e=this.session.getNodeWrapper(this.node.childNodes[this.offset-1]).getTrailingSpace())&&(this.isTrailingSpace=!0,this.character=e,this.characterType=L),this.checkForTrailingSpace=!1),this.checkForLeadingSpace&&((e=this.session.getNodeWrapper(this.node.childNodes[this.offset]).getLeadingSpace())&&(this.isLeadingSpace=!0,this.character=e,this.characterType=L),this.checkForLeadingSpace=!1)},getPrecedingUncollapsedPosition:function(e){for(var t=this;t=t.previousVisible();)if(""!==t.getCharacter(e))return t;return null},getCharacter:function(e){function t(){return i||(n=a.getPrecedingUncollapsedPosition(e),i=!0),n}this.resolveLeadingAndTrailingSpaces();var n,r,o,i,a,s=this.character,l=((l="string"==typeof(l=(l=e.ignoreCharacters)||"")?l.split(""):l).sort(function(e,t){return e.charCodeAt(0)-t.charCodeAt(0)}),l.join("").replace(/(.)\1+/g,"$1")),d=""!==s&&-1<l.indexOf(s);return this.isCharInvariant?d?"":s:(d=["character",e.includeSpaceBeforeBr,e.includeBlockContentTrailingSpace,e.includePreLineTrailingSpace,l].join("_"),null!==(r=this.cache.get(d))?r:(r="",o=this.characterType==L,i=!1,a=this,o&&(this.type==de?r="\n":" "==s&&(!t()||n.isTrailingSpace||"\n"==n.character||" "==n.character&&n.characterType==L)||("\n"==s&&this.isLeadingSpace?t()&&"\n"!=n.character&&(r="\n"):(o=this.nextUncollapsed())&&(o.isBr?this.type=se:o.isTrailingSpace&&"\n"==o.character?this.type=ae:o.isLeadingSpace&&"\n"==o.character&&(this.type=ie),"\n"==o.character?this.type==se&&!e.includeSpaceBeforeBr||this.type==ie&&!e.includeSpaceBeforeBlock||this.type==ae&&o.isTrailingSpace&&!e.includeBlockContentTrailingSpace||this.type==le&&o.type==_&&!e.includePreLineTrailingSpace||("\n"==s?o.isTrailingSpace?this.isTrailingSpace||this.isBr&&(o.type="TRAILING_LINE_BREAK_AFTER_BR",t()&&n.isLeadingSpace&&!n.isTrailingSpace&&"\n"==n.character?o.character="":o.type=de):r="\n":" "==s&&(r=" ")):r=s))),-1<l.indexOf(r)&&(r=""),this.cache.set(d,r),r))},equals:function(e){return!!e&&this.node===e.node&&this.offset===e.offset},inspect:function(){return"[Position("+h.inspectNode(this.node)+":"+this.offset+")]"},toString:function(){return this.character}}),M=(C(q.prototype=k,{next:e("nextPos",function(e){var t,n=e.nodeWrapper,r=e.node,e=e.offset,o=n.session;return r&&(n=e==n.getLength()?(t=r.parentNode)?n.getNodeIndex()+1:0:!n.isCharacterDataNode()&&(n=r.childNodes[e],o.getNodeWrapper(n).containsPositions())?(t=n,0):(t=r,e+1),t)?o.getPosition(t,n):null}),previous:e("previous",function(e){var t,n=e.nodeWrapper,r=e.node,e=e.offset,o=n.session,n=0==e?(t=r.parentNode)?n.getNodeIndex():0:!n.isCharacterDataNode()&&(n=r.childNodes[e-1],o.getNodeWrapper(n).containsPositions())?h.getNodeLength(t=n):(t=r,e-1);return t?o.getPosition(t,n):null}),nextVisible:e("nextVisible",function(e){var t,n,e=e.next();return e?(t=e.nodeWrapper,n=e.node,e=e,t.isCollapsed()?t.session.getPosition(n.parentNode,t.getNodeIndex()+1):e):null}),nextUncollapsed:e("nextUncollapsed",function(e){for(var t=e;t=t.nextVisible();)if(t.resolveLeadingAndTrailingSpaces(),""!==t.character)return t;return null}),previousVisible:e("previousVisible",function(e){var t,n,e=e.previous();return e?(t=e.nodeWrapper,n=e.node,e=e,t.isCollapsed()?t.session.getPosition(n.parentNode,t.getNodeIndex()):e):null})}),null),ce=(Q=p.isHostProperty(document.documentElement,"uniqueID"),ue.prototype={initCaches:function(){var t;this.elementCache=Q?(t=new a,{get:function(e){return t.get(e.uniqueID)},set:function(e){t.set(e.node.uniqueID,e)}}):I("tagName"),this.textNodeCache=I("data"),this.otherNodeCache=I("nodeName")},getNodeWrapper:function(e){var t;switch(e.nodeType){case 1:t=this.elementCache;break;case 3:t=this.textNodeCache;break;default:t=this.otherNodeCache}var n=t.get(e);return n||(n=new V(e,this),t.set(n)),n},getPosition:function(e,t){return this.getNodeWrapper(e).getPosition(t)},getRangeBoundaryPosition:function(e,t){t=t?"start":"end";return this.getPosition(e[t+"Container"],e[t+"Offset"])},detach:function(){this.elementCache=this.textNodeCache=this.otherNodeCache=null}},ue);function I(o){var i=new a;return{get:function(e){var t=i.get(e[o]);if(t)for(var n,r=0;n=t[r++];)if(n.node===e)return n;return null},set:function(e){var t=e.node[o];(i.get(t)||i.set(t,[])).push(e)}}}function ue(){this.initCaches()}C(h,{nextNode:B,previousNode:U});var fe=Array.prototype.indexOf?function(e,t){return e.indexOf(t)}:function(e,t){for(var n=0,r=e.length;n<r;++n)if(e[n]===t)return n;return-1};C(N.rangePrototype,{moveStart:l(!0,!1),moveEnd:l(!1,!1),move:l(!0,!0),trimStart:j(!0),trimEnd:j(!1),trim:t(function(e,t){var n=this.trimStart(t),t=this.trimEnd(t);return n||t}),expand:t(function(e,t,n){var r,o,i,a=!1,s=(n=u(n,te)).characterOptions;return(t=t||v)==E?(t=n.wordOptions,r=e.getRangeBoundaryPosition(this,!0),e=e.getRangeBoundaryPosition(this,!1),o=(i=g(r,s,t).nextEndToken()).chars[0].previousVisible(),t=(i=this.collapsed?i:g(e,s,t).previousStartToken()).chars[i.chars.length-1],o.equals(r)||(this.setStart(o.node,o.offset),a=!0),t&&!t.equals(e)&&(this.setEnd(t.node,t.offset),a=!0),n.trim&&(n.trimStart&&(a=this.trimStart(s)||a),n.trimEnd)&&this.trimEnd(s)||a):this.moveEnd(v,1,n)}),text:t(function(e,t){return this.collapsed?"":function(e,t,n){for(var r,o=[],i=X(e,t,n);r=i.next();)o.push(r);return i.dispose(),o}(e,this,y(t,w)).join("")}),selectCharacters:t(function(e,t,n,r,o){o={characterOptions:o};t=t||b(this.getDocument()),this.selectNodeContents(t),this.collapse(!0),this.moveStart("character",n,o),this.collapse(!0),this.moveEnd("character",r-n,o)}),toCharacterRange:t(function(e,t,n){var r=(t=t||b(this.getDocument())).parentNode,t=h.getNodeIndex(t),o=-1==h.comparePoints(this.startContainer,this.endContainer,r,t),i=this.cloneRange(),o=o?(i.setStartAndEnd(this.startContainer,this.startOffset,r,t),-i.text(n).length):(i.setStartAndEnd(r,t,this.startContainer,this.startOffset),i.text(n).length);return{start:o,end:o+this.text(n).length}}),findText:t(function(e,t,n){(n=u(n,J)).wholeWordsOnly&&(n.wordOptions.includeTrailingSpace=!1);var r=O(n.direction),o=n.withinRange,i=(o||(o=N.createRange()).selectNodeContents(this.getDocument()),t),a=!1,s=("string"==typeof i?n.caseSensitive||(i=i.toLowerCase()):a=!0,e.getRangeBoundaryPosition(this,!r)),t=o.comparePoint(s.node,s.offset);-1===t?s=e.getRangeBoundaryPosition(o,!0):1===t&&(s=e.getRangeBoundaryPosition(o,!1));for(var l,d=s,c=!1;;)if(l=W(d,i,a,o,n)){if(l.valid)return this.setStartAndEnd(l.startPos.node,l.startPos.offset,l.endPos.node,l.endPos.offset),!0;d=r?l.startPos:l.endPos}else{if(!n.wrap||c)return!1;o=o.cloneRange(),d=e.getRangeBoundaryPosition(o,!r),o.setBoundary(s.node,s.offset,r),c=!0}}),pasteHtml:function(e){var t;this.deleteContents(),e&&(t=(e=this.createContextualFragment(e)).lastChild,this.insertNode(e),this.collapseAfter(t))}}),C(N.selectionPrototype,{expand:t(function(e,t,n){this.changeEachRange(function(e){e.expand(t,n)})}),move:t(function(e,t,n,r){var o,i=0;return this.focusNode&&(this.collapse(this.focusNode,this.focusOffset),o=this.getRangeAt(0),(r=r||{}).characterOptions=y(r.characterOptions,Z),i=o.move(t,n,r),this.setSingleRange(o)),i}),trimStart:d("trimStart"),trimEnd:d("trimEnd"),trim:d("trim"),selectCharacters:t(function(e,t,n,r,o,i){var a=N.createRange(t);a.selectCharacters(t,n,r,i),this.setSingleRange(a,o)}),saveCharacterRanges:t(function(e,t,n){for(var r=this.getAllRanges(),o=[],i=1==r.length&&this.isBackward(),a=0,s=r.length;a<s;++a)o[a]={characterRange:r[a].toCharacterRange(t,n),backward:i,characterOptions:n};return o}),restoreCharacterRanges:t(function(e,t,n){this.removeAllRanges();for(var r,o,i,a=0,s=n.length;a<s;++a)i=(o=n[a]).characterRange,(r=N.createRange(t)).selectCharacters(t,i.start,i.end,o.characterOptions),this.addRange(r,o.backward)}),text:t(function(e,t){for(var n=[],r=0,o=this.rangeCount;r<o;++r)n[r]=this.getRangeAt(r).text(t);return n.join("")})}),N.innerText=function(e,t){var n=N.createRange(e);return n.selectNodeContents(e),n.text(t)},N.createWordIterator=function(e,t,n){var r=s();n=u(n,ne);var o=g(r.getPosition(e,t),n.characterOptions,n.wordOptions),i=O(n.direction);return{next:function(){return i?o.previousStartToken():o.nextEndToken()},dispose:function(){o.dispose(),this.next=function(){}}}},N.noMutation=function(e){e(s()),i()},N.noMutation.createEntryPointFunction=t,N.textRange={isBlockNode:function(e){return e&&(1==e.nodeType&&!/^(inline(-block|-table)?|none)$/.test(o(e))||9==e.nodeType||11==e.nodeType)},isCollapsedWhitespaceNode:r,createPosition:t(function(e,t,n){return e.getPosition(t,n)})}}),!function(){function n(e,t){return function(){return e.apply(t,arguments)}}function e(e){this.el=e,this.dragleave=n(this.dragleave,this),this.dragenter=n(this.dragenter,this);var t=this;this.supportsEventConstructors()&&(this.first=!1,this.second=!1,this.el.addEventListener("dragenter",this.dragenter,!1),this.el.addEventListener("dragleave",this.dragleave,!1),this.el.addEventListener("drop",function(){t.first=!1,t.second=!1},!1))}e.prototype.dragenter=function(e){return this.first?this.second=!0:(this.first=!0,this.el.dispatchEvent(new CustomEvent("dragster:enter",{bubbles:!0,cancelable:!0,detail:{dataTransfer:e.dataTransfer,originalEvent:e}})))},e.prototype.dragleave=function(e){if(this.second?this.second=!1:this.first&&(this.first=!1),!this.first&&!this.second)return this.el.dispatchEvent(new CustomEvent("dragster:leave",{bubbles:!0,cancelable:!0,detail:{dataTransfer:e.dataTransfer,originalEvent:e}}))},e.prototype.removeListeners=function(){return this.el.removeEventListener("dragenter",this.dragenter,!1),this.el.removeEventListener("dragleave",this.dragleave,!1)},e.prototype.supportsEventConstructors=function(){try{new CustomEvent("z")}catch(e){return!1}return!0},e.prototype.reset=function(){return this.first=!1,this.second=!1},this.Dragster=e}.call(this),!function(){function d(e){e=e||{};for(var t=1;t<arguments.length;t++)if(arguments[t])for(var n in arguments[t])arguments[t].hasOwnProperty(n)&&(e[n]=arguments[t][n]);return e}var t,c,m,y,b,u,T,D,e,z,n,G;function f(e,t){var n,r,o,i,a,s,l,d;return t=t||{},(e=e||"")instanceof f?e:this instanceof f?(r={r:0,g:0,b:0},s=a=i=null,d=l=!(o=1),o=ce(o="object"==typeof(n="string"==typeof(n=e)?function(e){e=e.replace(m,"").replace(y,"").toLowerCase();var t,n=!1;if(z[e])e=z[e],n=!0;else if("transparent"==e)return{r:0,g:0,b:0,a:0,format:"name"};return(t=G.rgb.exec(e))?{r:t[1],g:t[2],b:t[3]}:(t=G.rgba.exec(e))?{r:t[1],g:t[2],b:t[3],a:t[4]}:(t=G.hsl.exec(e))?{h:t[1],s:t[2],l:t[3]}:(t=G.hsla.exec(e))?{h:t[1],s:t[2],l:t[3],a:t[4]}:(t=G.hsv.exec(e))?{h:t[1],s:t[2],v:t[3]}:(t=G.hsva.exec(e))?{h:t[1],s:t[2],v:t[3],a:t[4]}:(t=G.hex8.exec(e))?{r:p(t[1]),g:p(t[2]),b:p(t[3]),a:ge(t[4]),format:n?"name":"hex8"}:(t=G.hex6.exec(e))?{r:p(t[1]),g:p(t[2]),b:p(t[3]),format:n?"name":"hex"}:(t=G.hex4.exec(e))?{r:p(t[1]+""+t[1]),g:p(t[2]+""+t[2]),b:p(t[3]+""+t[3]),a:ge(t[4]+""+t[4]),format:n?"name":"hex8"}:!!(t=G.hex3.exec(e))&&{r:p(t[1]+""+t[1]),g:p(t[2]+""+t[2]),b:p(t[3]+""+t[3]),format:n?"name":"hex"}}(n):n)&&(Ne(n.r)&&Ne(n.g)&&Ne(n.b)?(r=function(e,t,n){return{r:255*h(e,255),g:255*h(t,255),b:255*h(n,255)}}(n.r,n.g,n.b),l=!0,d="%"===String(n.r).substr(-1)?"prgb":"rgb"):Ne(n.h)&&Ne(n.s)&&Ne(n.v)?(i=he(n.s),a=he(n.v),r=function(e,t,n){e=6*h(e,360),t=h(t,100),n=h(n,100);var r=c.floor(e),e=e-r,o=n*(1-t),i=n*(1-e*t),e=n*(1-(1-e)*t),t=r%6;return{r:255*[n,i,o,o,e,n][t],g:255*[e,n,n,i,o,o][t],b:255*[o,o,e,n,n,i][t]}}(n.h,i,a),l=!0,d="hsv"):Ne(n.h)&&Ne(n.s)&&Ne(n.l)&&(i=he(n.s),s=he(n.l),r=function(e,t,n){function r(e,t,n){return n<0&&(n+=1),1<n&&--n,n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+6*(t-e)*(2/3-n):e}var o,i,a;e=h(e,360),t=h(t,100),n=h(n,100),0===t?o=i=a=n:(o=r(t=2*n-(n=n<.5?n*(1+t):n+t-n*t),n,e+1/3),i=r(t,n,e),a=r(t,n,e-1/3));return{r:255*o,g:255*i,b:255*a}}(n.h,i,s),l=!0,d="hsl"),n.hasOwnProperty("a"))?n.a:o),a={ok:l,format:n.format||d,r:T(255,D(r.r,0)),g:T(255,D(r.g,0)),b:T(255,D(r.b,0)),a:o},this._originalInput=e,this._r=a.r,this._g=a.g,this._b=a.b,this._a=a.a,this._roundA=u(100*this._a)/100,this._format=t.format||a.format,this._gradientType=t.gradientType,this._r<1&&(this._r=u(this._r)),this._g<1&&(this._g=u(this._g)),this._b<1&&(this._b=u(this._b)),this._ok=a.ok,void(this._tc_id=b++)):new f(e,t)}function r(e,t,n){e=h(e,255),t=h(t,255),n=h(n,255);var r,o=D(e,t,n),i=T(e,t,n),a=(o+i)/2;if(o==i)r=l=0;else{var s=o-i,l=.5<a?s/(2-o-i):s/(o+i);switch(o){case e:r=(t-n)/s+(t<n?6:0);break;case t:r=(n-e)/s+2;break;case n:r=(e-t)/s+4}r/=6}return{h:r,s:l,l:a}}function l(e,t,n){e=h(e,255),t=h(t,255),n=h(n,255);var r,o=D(e,t,n),i=T(e,t,n),a=o,s=o-i,l=0===o?0:s/o;if(o==i)r=0;else{switch(o){case e:r=(t-n)/s+(t<n?6:0);break;case t:r=(n-e)/s+2;break;case n:r=(e-t)/s+4}r/=6}return{h:r,s:l,v:a}}function $(e,t,n,r){e=[fe(u(e).toString(16)),fe(u(t).toString(16)),fe(u(n).toString(16))];return r&&e[0].charAt(0)==e[0].charAt(1)&&e[1].charAt(0)==e[1].charAt(1)&&e[2].charAt(0)==e[2].charAt(1)?e[0].charAt(0)+e[1].charAt(0)+e[2].charAt(0):e.join("")}function Y(e,t,n,r){return[fe(pe(r)),fe(u(e).toString(16)),fe(u(t).toString(16)),fe(u(n).toString(16))].join("")}function Q(e,t){t=0===t?0:t||10;e=f(e).toHsl();return e.s-=t/100,e.s=ue(e.s),f(e)}function Z(e,t){t=0===t?0:t||10;e=f(e).toHsl();return e.s+=t/100,e.s=ue(e.s),f(e)}function J(e){return f(e).desaturate(100)}function ee(e,t){t=0===t?0:t||10;e=f(e).toHsl();return e.l+=t/100,e.l=ue(e.l),f(e)}function te(e,t){t=0===t?0:t||10;e=f(e).toRgb();return e.r=D(0,T(255,e.r-u(-t/100*255))),e.g=D(0,T(255,e.g-u(-t/100*255))),e.b=D(0,T(255,e.b-u(-t/100*255))),f(e)}function ne(e,t){t=0===t?0:t||10;e=f(e).toHsl();return e.l-=t/100,e.l=ue(e.l),f(e)}function re(e,t){e=f(e).toHsl(),t=(e.h+t)%360;return e.h=t<0?360+t:t,f(e)}function oe(e){e=f(e).toHsl();return e.h=(e.h+180)%360,f(e)}function ie(e){var t=f(e).toHsl(),n=t.h;return[f(e),f({h:(n+120)%360,s:t.s,l:t.l}),f({h:(n+240)%360,s:t.s,l:t.l})]}function ae(e){var t=f(e).toHsl(),n=t.h;return[f(e),f({h:(n+90)%360,s:t.s,l:t.l}),f({h:(n+180)%360,s:t.s,l:t.l}),f({h:(n+270)%360,s:t.s,l:t.l})]}function se(e){var t=f(e).toHsl(),n=t.h;return[f(e),f({h:(n+72)%360,s:t.s,l:t.l}),f({h:(n+216)%360,s:t.s,l:t.l})]}function le(e,t,n){t=t||6,n=n||30;var r=f(e).toHsl(),o=360/n,i=[f(e)];for(r.h=(r.h-(o*t>>1)+720)%360;--t;)r.h=(r.h+o)%360,i.push(f(r));return i}function de(e,t){t=t||6;for(var e=f(e).toHsv(),n=e.h,r=e.s,o=e.v,i=[],a=1/t;t--;)i.push(f({h:n,s:r,v:o})),o=(o+a)%1;return i}function ce(e){return e=parseFloat(e),e=isNaN(e)||e<0||1<e?1:e}function h(e,t){"string"==typeof(n=e)&&-1!=n.indexOf(".")&&1===parseFloat(n)&&(e="100%");var n="string"==typeof(n=e)&&-1!=n.indexOf("%");return e=T(t,D(0,parseFloat(e))),n&&(e=parseInt(e*t,10)/100),c.abs(e-t)<1e-6?1:e%t/parseFloat(t)}function ue(e){return T(1,D(0,e))}function p(e){return parseInt(e,16)}function fe(e){return 1==e.length?"0"+e:""+e}function he(e){return e=e<=1?100*e+"%":e}function pe(e){return c.round(255*parseFloat(e)).toString(16)}function ge(e){return p(e)/255}function Ne(e){return G.CSS_UNIT.exec(e)}c=Math,m=/^\s+/,y=/\s+$/,b=0,u=c.round,T=c.min,D=c.max,e=c.random,f.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var e=this.toRgb();return(299*e.r+587*e.g+114*e.b)/1e3},getLuminance:function(){var e=this.toRgb(),t=e.r/255,n=e.g/255,e=e.b/255;return.2126*(t<=.03928?t/12.92:c.pow((.055+t)/1.055,2.4))+.7152*(n<=.03928?n/12.92:c.pow((.055+n)/1.055,2.4))+.0722*(e<=.03928?e/12.92:c.pow((.055+e)/1.055,2.4))},setAlpha:function(e){return this._a=ce(e),this._roundA=u(100*this._a)/100,this},toHsv:function(){var e=l(this._r,this._g,this._b);return{h:360*e.h,s:e.s,v:e.v,a:this._a}},toHsvString:function(){var e=l(this._r,this._g,this._b),t=u(360*e.h),n=u(100*e.s),e=u(100*e.v);return 1==this._a?"hsv("+t+", "+n+"%, "+e+"%)":"hsva("+t+", "+n+"%, "+e+"%, "+this._roundA+")"},toHsl:function(){var e=r(this._r,this._g,this._b);return{h:360*e.h,s:e.s,l:e.l,a:this._a}},toHslString:function(){var e=r(this._r,this._g,this._b),t=u(360*e.h),n=u(100*e.s),e=u(100*e.l);return 1==this._a?"hsl("+t+", "+n+"%, "+e+"%)":"hsla("+t+", "+n+"%, "+e+"%, "+this._roundA+")"},toHex:function(e){return $(this._r,this._g,this._b,e)},toHexString:function(e){return"#"+this.toHex(e)},toHex8:function(e){return t=this._r,n=this._g,r=this._b,o=this._a,e=e,t=[fe(u(t).toString(16)),fe(u(n).toString(16)),fe(u(r).toString(16)),fe(pe(o))],e&&t[0].charAt(0)==t[0].charAt(1)&&t[1].charAt(0)==t[1].charAt(1)&&t[2].charAt(0)==t[2].charAt(1)&&t[3].charAt(0)==t[3].charAt(1)?t[0].charAt(0)+t[1].charAt(0)+t[2].charAt(0)+t[3].charAt(0):t.join("");var t,n,r,o},toHex8String:function(e){return"#"+this.toHex8(e)},toRgb:function(){return{r:u(this._r),g:u(this._g),b:u(this._b),a:this._a}},toRgbString:function(){return 1==this._a?"rgb("+u(this._r)+", "+u(this._g)+", "+u(this._b)+")":"rgba("+u(this._r)+", "+u(this._g)+", "+u(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:u(100*h(this._r,255))+"%",g:u(100*h(this._g,255))+"%",b:u(100*h(this._b,255))+"%",a:this._a}},toPercentageRgbString:function(){return 1==this._a?"rgb("+u(100*h(this._r,255))+"%, "+u(100*h(this._g,255))+"%, "+u(100*h(this._b,255))+"%)":"rgba("+u(100*h(this._r,255))+"%, "+u(100*h(this._g,255))+"%, "+u(100*h(this._b,255))+"%, "+this._roundA+")"},toName:function(){return 0===this._a?"transparent":!(this._a<1)&&n[$(this._r,this._g,this._b,!0)]||!1},toFilter:function(e){var t="#"+Y(this._r,this._g,this._b,this._a),n=t;return"progid:DXImageTransform.Microsoft.gradient("+(this._gradientType?"GradientType = 1, ":"")+"startColorstr="+t+",endColorstr="+(n=e?"#"+Y((t=f(e))._r,t._g,t._b,t._a):n)+")"},toString:function(e){var t=!!e,n=(e=e||this._format,!1),r=this._a<1&&0<=this._a;return!t&&r&&("hex"===e||"hex6"===e||"hex3"===e||"hex4"===e||"hex8"===e||"name"===e)?"name"===e&&0===this._a?this.toName():this.toRgbString():("rgb"===e&&(n=this.toRgbString()),"prgb"===e&&(n=this.toPercentageRgbString()),"hex"!==e&&"hex6"!==e||(n=this.toHexString()),"hex3"===e&&(n=this.toHexString(!0)),"hex4"===e&&(n=this.toHex8String(!0)),"hex8"===e&&(n=this.toHex8String()),"name"===e&&(n=this.toName()),"hsl"===e&&(n=this.toHslString()),(n="hsv"===e?this.toHsvString():n)||this.toHexString())},clone:function(){return f(this.toString())},_applyModification:function(e,t){e=e.apply(null,[this].concat([].slice.call(t)));return this._r=e._r,this._g=e._g,this._b=e._b,this.setAlpha(e._a),this},lighten:function(){return this._applyModification(ee,arguments)},brighten:function(){return this._applyModification(te,arguments)},darken:function(){return this._applyModification(ne,arguments)},desaturate:function(){return this._applyModification(Q,arguments)},saturate:function(){return this._applyModification(Z,arguments)},greyscale:function(){return this._applyModification(J,arguments)},spin:function(){return this._applyModification(re,arguments)},_applyCombination:function(e,t){return e.apply(null,[this].concat([].slice.call(t)))},analogous:function(){return this._applyCombination(le,arguments)},complement:function(){return this._applyCombination(oe,arguments)},monochromatic:function(){return this._applyCombination(de,arguments)},splitcomplement:function(){return this._applyCombination(se,arguments)},triad:function(){return this._applyCombination(ie,arguments)},tetrad:function(){return this._applyCombination(ae,arguments)}},f.fromRatio=function(e,t){if("object"==typeof e){var n,r={};for(n in e)e.hasOwnProperty(n)&&(r[n]="a"===n?e[n]:he(e[n]));e=r}return f(e,t)},f.equals=function(e,t){return!(!e||!t)&&f(e).toRgbString()==f(t).toRgbString()},f.random=function(){return f.fromRatio({r:e(),g:e(),b:e()})},f.mix=function(e,t,n){n=0===n?0:n||50;e=f(e).toRgb(),t=f(t).toRgb(),n/=100;return f({r:(t.r-e.r)*n+e.r,g:(t.g-e.g)*n+e.g,b:(t.b-e.b)*n+e.b,a:(t.a-e.a)*n+e.a})},f.readability=function(e,t){e=f(e),t=f(t);return(c.max(e.getLuminance(),t.getLuminance())+.05)/(c.min(e.getLuminance(),t.getLuminance())+.05)},f.isReadable=function(e,t,n){var r=f.readability(e,t),o=!1;switch((n={level:t="AA"!==(t=((e=(e=n)||{level:"AA",size:"small"}).level||"AA").toUpperCase())&&"AAA"!==t?"AA":t,size:t="small"!==(t=(e.size||"small").toLowerCase())&&"large"!==t?"small":t}).level+n.size){case"AAsmall":case"AAAlarge":o=4.5<=r;break;case"AAlarge":o=3<=r;break;case"AAAsmall":o=7<=r}return o},f.mostReadable=function(e,t,n){for(var r,o=null,i=0,a=(n=n||{}).includeFallbackColors,s=n.level,l=n.size,d=0;d<t.length;d++)i<(r=f.readability(e,t[d]))&&(i=r,o=f(t[d]));return f.isReadable(e,o,{level:s,size:l})||!a?o:(n.includeFallbackColors=!1,f.mostReadable(e,["#fff","#000"],n))},z=f.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},n=f.hexNames=function(e){var t,n={};for(t in e)e.hasOwnProperty(t)&&(n[e[t]]=t);return n}(z),Ae="[\\s|\\(]+("+(we="(?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?)")+")[,|\\s]+("+we+")[,|\\s]+("+we+")\\s*\\)?",qt="[\\s|\\(]+("+we+")[,|\\s]+("+we+")[,|\\s]+("+we+")[,|\\s]+("+we+")\\s*\\)?",G={CSS_UNIT:new RegExp(we),rgb:new RegExp("rgb"+Ae),rgba:new RegExp("rgba"+qt),hsl:new RegExp("hsl"+Ae),hsla:new RegExp("hsla"+qt),hsv:new RegExp("hsv"+Ae),hsva:new RegExp("hsva"+qt),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/},t=f;var me=/([\p{Emoji}\u180B-\u180D\uFE00-\uFE0F]|\uDB40[\uDD00-\uDDEF])/u,ve={},Ee=!0,Ce=[],ye={},be=(!function(){var n=["li"],r=["caption","colgroup","col","thead","tbody","tfoot","td","th"];var o=function(e){for(var t in e)e.hasOwnProperty(t)&&((Arrays.contains(e[t],"ol")||Arrays.contains(e[t],"ul"))&&(e[t]=Arrays.concat(e[t],n)),Arrays.contains(e[t],"table"))&&(e[t]=Arrays.concat(e[t],r));return e}({}),i={},a={};function s(e,t){var n,r=[];for(n in t)t.hasOwnProperty(n)&&e.matches(n)&&r.push(t[n]);return r}function l(e){var t=[];return[].forEach.call(e,function(e){t=t.concat(e)}),t.filter(function(e,t,n){return n.indexOf(e)===t})}var f={FIELDSET:!0,OBJECT:!0,FIGURE:!0,"MEDIA-ITEM":!0,AUDIO:!0,SELECT:!0,COLGROUP:!0,"COLUMN-SET":!0,HGROUP:!0,TABLE:!0,TBODY:!0,TR:!0,OL:!0,UL:!0,DL:!0,MENU:!0},h={"COLUMN-UNIT":["COLUMN-SET"],LI:["OL","UL","DL"],DT:["DL"],DD:["DL"],TBODY:["TABLE"],TR:["TABLE","TBODY"],TH:["TABLE","TBODY"],TD:["TR","TH"]};function p(e,t){var n=s(e,o);return!(0<n.length&&!Arrays.contains(l(["#text"].concat(n)),t.toLowerCase())||0<(n=s(e,i)).length&&Arrays.contains(l(n),t.toLowerCase()))}function g(e,t){return d({},s(e,a))[t.toLowerCase()]||t}function N(e){if(e.firstChild)return e.firstChild;for(var t=e;t&&!t.nextSibling;)t=t.parentNode;return t&&t.nextSibling}this.isAllowed=p,this.translate=g,this.applyRules=function(e,t){for(var n=t.ownerDocument,r=n.createElement("div"),o=(r.innerHTML=e,N(r));o;){var i=g(t,o.nodeName);if(i!==o.nodeName&&((i=n.createElement(i)).innerHTML=o.innerHTML,o.parentNode.replaceChild(i,o),o=i),p(t,o.nodeName))o=N(o);else if(f[o.nodeName]||h[o.nodeName]){i=function(e){for(var t=e.previousSibling;t&&t.lastChild;)t=t.lastChild;return t||e.parentNode}(o);o.parentNode.removeChild(o),o=N(i)}else{for(var i=N(o),a=(u=c=d=l=s=a=void 0,o),s=a.parentNode,l=s,d=a.firstChild,c=a;d;){var u=d.nextSibling;l.insertBefore(d,c),d=u}s.removeChild(a),o=i}}return r.innerHTML}}.call(ye),!function(){this.isEmpty=function(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0},this.fillKeys=function(e,t,n){for(var r=t.length;r--;)e[t[r]]=n;return e},this.fillTuples=function(e,t){for(var n,r=t.length;r--;)e[(n=t[r])[0]]=n[1];return e},this.keys=function(e){var t,n=[];for(t in e)e.hasOwnProperty(t)&&n.push(t);return n},this.forEach=function(e,t){for(var n in e)e.hasOwnProperty(n)&&t(e[n],n,e)}}.call(ve),["p","h1","h2","h3","h4","h5","h6","blockquote","div","pre"]),Te=["li","ol","ul"],Oe=["br","iframe","audio-player","cargo-map","media-item","text-icon","digital-clock","shop-product"],Se=["area","base","br","col","command","embed","hr","img","input","keygen","link","meta","param","source","track","wbr"];function Re(e){if(!((t=e)&&1===t.nodeType&&0<=be.indexOf(t.nodeName.toLowerCase())))return!1;var t;if(e.childNodes)for(var n,r=e.childNodes.length,o=!1,i=0;i<r;i++)if("BR"===(n=e.childNodes[i]).nodeName){if(o)return!1;o=!0}else if(!S(n))return!1;return!0}function S(e){if(e){if(-1!=Oe.indexOf(e.nodeName.toLowerCase()))return!1;if(-1!=Se.indexOf(e.nodeName.toLowerCase()))return!1;if(3===e.nodeType)return q(e);for(var t=0,n=e.childNodes.length;t<n;++t)if(!S(e.childNodes[t]))return!1}return!0}function x(e){if(e)for(var t=e.parentNode.childNodes,n=t.length,r=0;r<n;r++)if(t[r]===e)return r;return-1}var we={},Ae=["address","article","aside","audio","blockquote","canvas","dd","div","dl","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","hr","main","nav","noscript","ol","output","p","pre","section","table","tfoot","ul","video"];ve.fillKeys(we,Ae,!0),ve.fillKeys(we,Array.prototype.map.call(Ae,function(e){return e.toUpperCase()}),!0);var De,xe={bind:function(e){var t=this.obj||this,n=Function.prototype.bind,r=Array.prototype.slice.call(arguments,1);return n?n.apply(t,arguments):function(){return t.apply(e,0===arguments.length?r:r.concat(Array.prototype.slice.call(arguments)))}},trim:function(){var e=this.obj||this,t=String.prototype.trim;return t?t.call(e):e.replace(/^\s+/,"").replace(/\s+$/,"")},indexOf:function(e,t){var n,r=this.obj||this,o=Array.prototype.indexOf;if(o)return o.call(r,e,t);for((t=void 0===t?0:t)<0&&(t+=r.length),t<0&&(t=0),n=r.length;t<n;t++)if(void 0!==r[t]&&r[t]===e)return t;return-1},forEach:function(e,t){var n,r,o=this.obj||this,i=Array.prototype.forEach;if(i)return i.call(o,e,t);for(n=0,r=o.length;n<r;n++)void 0!==o[n]&&e.call(t,o[n],n,o)},map:function(e,t,n){var r=this.obj||this,o=Array.prototype.map,i="boolean"==typeof arguments[arguments.length-1]&&Array.prototype.pop.call(arguments),a=[];if(o)a=o.call(r,e,t);else{for(var s=[],l=0,d=r.length;l<d;l++)void 0!==r[l]&&(s[l]=e.call(t,r[l],l,r));a=s}return i?_(a):a},filter:function(e,t,n){var r=this.obj||this,o=Array.prototype.filter,i="boolean"==typeof arguments[arguments.length-1]&&Array.prototype.pop.call(arguments),a=[];if(o)a=o.call(r,e,t);else{for(var s,l=[],d=0,c=r.length;d<c;d++)void 0!==r[d]&&e.call(t,s=r[d],d,r)&&l.push(s);a=l}return i?_(a):a},every:function(e,t){var n,r,o=this.obj||this,i=Array.prototype.every;if(i)return i.call(o,e,t);for(n=0,r=o.length;n<r;n++)if(void 0!==o[n]&&!e.call(t,o[n],n,o))return!1;return!0},some:function(e,t){var n,r,o=this.obj||this,i=Array.prototype.some;if(i)return i.call(o,e,t);for(n=0,r=o.length;n<r;n++)if(void 0!==o[n]&&e.call(t,o[n],n,o))return!0;return!1},hasAttribute:function(e){var t=this.obj||this;return t.hasAttribute?t.hasAttribute(e):!!t.getAttribute(e)}},_=function(e){function t(){}t.prototype=xe;var n=new t;return n.obj=e,n};for(De in xe)xe.hasOwnProperty(De)&&(_[De]=xe[De]);function _e(e){var t=null;if(e)for(;null!=(e=(t=e).parentNode););return t}function Le(e,t){return(e.contains(t)&&16)+(t.contains(e)&&8)+(0<=e.sourceIndex&&0<=t.sourceIndex?(e.sourceIndex<t.sourceIndex&&4)+(e.sourceIndex>t.sourceIndex&&2):1)}function ke(e){return null!=e.sourceIndex?e:e.parentNode.insertBefore(document.createComment(""),e)}function s(e,t){return e.hasAttribute?e.hasAttribute(t):void 0!==e.attributes[t]}function Me(e,t){var n,r=e.cloneNode(!1);return r.deleteData(0,t),e.deleteData(t,e.length-t),t=r,n=(e=e).nextSibling,e=e.parentNode,n?e.insertBefore(t,n):e.appendChild(t),r}void 0!==window.Node?_.Node=window.Node:_.Node={ELEMENT_NODE:1,ATTRIBUTE_NODE:2,TEXT_NODE:3,CDATA_SECTION_NODE:4,ENTITY_REFERENCE_NODE:5,ENTITY_NODE:6,PROCESSING_INSTRUCTION_NODE:7,COMMENT_NODE:8,DOCUMENT_NODE:9,DOCUMENT_TYPE_NODE:10,DOCUMENT_FRAGMENT_NODE:11,NOTATION_NODE:12,DOCUMENT_POSITION_DISCONNECTED:1,DOCUMENT_POSITION_PRECEDING:2,DOCUMENT_POSITION_FOLLOWING:4,DOCUMENT_POSITION_CONTAINS:8,DOCUMENT_POSITION_CONTAINED_BY:16,DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC:32},_.compareDocumentPosition=function(e,t){if(document.documentElement.compareDocumentPosition)return e.compareDocumentPosition(t);var n,r,o;if(document.documentElement.contains)return e==t?0:_e(e)!=_e(t)?1:null!=e.sourceIndex&&null!=t.sourceIndex?Le(e,t):e==document?20:t==document?10:(o=Le(n=ke(e),r=ke(t)),e!=n&&n.parentNode.removeChild(n),t!=r&&r.parentNode.removeChild(r),o);throw"neither compareDocumentPosition nor contains is supported by this browser."},_.getComputedStyle=function(e,t){return window.getComputedStyle?window.getComputedStyle(e,t):e.currentStyle||null};var Ie,Pe,Be,Ue,He,Fe,Ve,qe="http://www.w3.org/1999/xhtml",Xe=!1,g=null,L={};function We(e){return null===e||!e||e===qe}function je(e){return e&&1==e.nodeType&&We(e.namespaceURI)}function k(e,t){return e&&1==e.nodeType&&We(e.namespaceURI)&&t.toUpperCase()===e.nodeName}function M(e,t){return!(!t||!e||!e.nodeType==Node.ELEMENT_NODE)&&(t="object"==typeof(t="string"==typeof t?[t]:t)?t.map(function(e){return e.toUpperCase()}):t).includes(e.tagName)}function Ke(e,t){return e&&1==e.nodeType&&We(e.namespaceURI)&&t[e.nodeName]}function ze(e){var t,n=0;if(!e)return 0;if(!e.style)return 0;if(void 0!==e.style.length)return e.style.length;for(t in e.style)e.style[t]&&0!==e.style[t]&&"false"!==e.style[t]&&n++;return n}function Ge(e){if(!e)return null;for(var t=[],n=e.length>>>0;n--;)t[n]=e[n];return t}function $e(e){for(;e&&!e.nextSibling;)e=e.parentNode;return e?e.nextSibling:null}function E(e){return e.hasChildNodes()?e.firstChild:$e(e)}function Ye(e){if(e.previousSibling){for(e=e.previousSibling;e.hasChildNodes();)e=e.lastChild;return e}return e.parentNode&&e.parentNode.nodeType==Node.ELEMENT_NODE?e.parentNode:null}function Qe(e,t){return e&&t&&Boolean(e.compareDocumentPosition(t)&Node.DOCUMENT_POSITION_CONTAINED_BY)}function Ze(e,t){return t&&e&&Boolean(t.compareDocumentPosition(e)&Node.DOCUMENT_POSITION_CONTAINED_BY)}function Je(e,t){return Boolean(e.compareDocumentPosition(t)&Node.DOCUMENT_POSITION_FOLLOWING)}function et(e){for(var t=[];e.parentNode;)t.unshift(e.parentNode),e=e.parentNode;return t}function tt(e){for(var t=[],n=$e(e);null!=(e=E(e))&&e!=n;)t.push(e);return t}function nt(e){return"ltr"==e.dir?"ltr":"rtl"==e.dir?"rtl":je(e.parentNode)?nt(e.parentNode):"ltr"}function I(e){switch(e.nodeType){case Node.PROCESSING_INSTRUCTION_NODE:case Node.DOCUMENT_TYPE_NODE:return 0;case Node.TEXT_NODE:case Node.COMMENT_NODE:return e.length;default:return e.childNodes.length}}function rt(e,t,n,r){if(e==n){if(t==r)return"equal";if(t<r)return"before";if(r<t)return"after"}var o=n.compareDocumentPosition(e);if(o&Node.DOCUMENT_POSITION_FOLLOWING){r=rt(n,r,e,t);if("before"==r)return"after";if("after"==r)return"before"}if(o&Node.DOCUMENT_POSITION_CONTAINS){for(var i=n;i.parentNode!=e;)i=i.parentNode;if(x(i)<t)return"after"}return"before"}function ot(e){for(var t=e;null!=t.parentNode;)t=t.parentNode;return t}function it(e,t){return e&&t&&t.startContainer&&t.endContainer&&"after"===rt(e,0,t.startContainer,t.startOffset)&&"before"===rt(e,I(e),t.endContainer,t.endOffset)&&ot(e)==ot(t.startContainer)}function at(e,t){void 0===t&&(t=function(){return!0});for(var n=(n=e.startContainer).hasChildNodes()&&e.startOffset<n.childNodes.length?n.childNodes[e.startOffset]:(e.startOffset==I(n)?$e:E)(n),r=(r=e.endContainer).hasChildNodes()&&e.endOffset<r.childNodes.length?r.childNodes[e.endOffset]:$e(r),o=[];Je(n,r);)n=(it(n,e)&&t(n)?(o.push(n),$e):E)(n);return o}function C(e,t){void 0===t&&(t=function(){return!0});for(var n=(n=e.startContainer).hasChildNodes()&&e.startOffset<n.childNodes.length?n.childNodes[e.startOffset]:(e.startOffset==I(n)?$e:E)(n),r=(r=e.endContainer).hasChildNodes()&&e.endOffset<r.childNodes.length?r.childNodes[e.endOffset]:$e(r),o=[];Je(n,r);)it(n,e)&&t(n)&&o.push(n),n=E(n);return o}function st(e){return"currentcolor"==e.toLowerCase()||!0!==(e=t(e)).isValid()?null:e.toRgbString()}function lt(e){e=t(e);return!0===e.isValid()&&e.toString()}var dt=0;function ct(e,t,n,r){var o;0===dt&&(g=n),dt++;try{o=r()}catch(e){throw 0===--dt&&(g=null),e}return 0===--dt&&(g=null),o}function ut(e,t){return e=e.toLowerCase(),ct(0,0,t,(n=e,function(){return-1!=["copy","cut","paste","selectall","stylewithcss","usecss"].indexOf(n)||null!==t}));var n}function ft(e){if(void 0!==e)return e.startContainer.nodeType===Node.ELEMENT_NODE&&e.startOffset>e.startContainer.childNodes.length?e.setStart(e.startContainer,e.startContainer.childNodes.length):e.startContainer.nodeType===Node.TEXT_NODE&&e.startOffset>e.startContainer.length&&e.setStart(e.startContainer,e.startContainer.length),e.endContainer.nodeType===Node.ELEMENT_NODE&&e.endOffset>=e.endContainer.childNodes.length?e.endContainer===e.startContainer&&0===e.startOffset?(e.setEnd(e.endContainer,e.endContainer.childNodes.length),e.setStart(e.startContainer,0)):e.setEnd(e.endContainer,e.endContainer.childNodes.length):e.endContainer.nodeType===Node.TEXT_NODE&&e.endOffset>e.endContainer.length&&e.setEnd(e.endContainer,e.endContainer.length),e}function ht(e){if(void 0===e)return{shadowDomElementAdjacentToCollapsedRange:null,collapseDirection:null,needsForcedRange:!1,rangeToSelectInShadowDom:null,singleSelectedElementWithShadowDom:null,normalizedRange:null};var t=-1!=navigator.userAgent.indexOf("Safari")&&-1==navigator.userAgent.indexOf("Chrome"),n=/Firefox\/\d+\.\d+/.test(navigator.userAgent),r=!1,o=null,i=null,a=null,s=null,l=rr.rangy.createRange(),e=(l.setStart(e.startContainer,e.startOffset),l.setEnd(e.endContainer,e.endOffset),rr.getActiveEditor());if(!e||(e=e.getElement()).contains(l.commonAncestorContainer)||(l.selectNodeContents(e),l.collapsed&&l.collapse(),r=!0),rr.plugins.shadowDom&&(l.startContainer.shadowRoot&&rr.plugins.shadowDom.canBeEntirelySelected(l.startContainer)&&l.setStartBefore(l.startContainer),l.endContainer.shadowRoot)&&rr.plugins.shadowDom.canBeEntirelySelected(l.endContainer)&&l.setEndAfter(l.endContainer),bt(l.commonAncestorContainer))l.selectNode(l.commonAncestorContainer.host),(o=rr.rangy.createRange()).setStart(l.startContainer,l.startOffset),o.setEnd(l.endContainer,l.endOffset),s=l.commonAncestorContainer.host,r=!0;else if(l.startContainer==l.endContainer&&l.startContainer.nodeType==Node.ELEMENT_NODE&&l.endOffset-l.startOffset==1&&l.startContainer.childNodes[l.startOffset]&&l.startContainer.childNodes[l.startOffset].shadowRoot){var d=l.startContainer.childNodes[l.startOffset];(o=rr.rangy.createRange()).setStart(l.startContainer,l.startOffset),o.setEnd(l.endContainer,l.endOffset),r=!0,s=d}else if(l.collapsed){var c=null,u=null;if(l.startContainer.nodeType===Node.TEXT_NODE){for(var f=l.cloneRange();0===l.startOffset&&0<f.startOffset&&0==f.startContainer.data.charAt(f.startOffset).trim().length;)f.setStart(f.startContainer,f.startOffset-1),f.collapse(!0);if(0===f.startOffset)for(c=l.startContainer.previousSibling;c&&q(c);)c=c.previousSibling;for(f=l.cloneRange();l.startOffset===l.startContainer.length&&f.startOffset<f.startContainer.length&&0==f.startContainer.data.charAt(f.startOffset+1).trim().length;)f.setStart(f.startContainer,f.startOffset+1),f.collapse(!0);if(f.startOffset===f.startContainer.length)for(u=f.startContainer.nextSibling;u&&q(u);)u=u.nextSibling}else if(l.startContainer.nodeType===Node.ELEMENT_NODE){for(c=l.startContainer.childNodes[l.startOffset-1];c&&q(c);)c=c.previousSibling;for(u=l.startContainer.childNodes[l.startOffset];u&&q(u);)u=u.nextSibling}u&&u.shadowRoot?(i=u,a="before",r=!0):c&&c.shadowRoot&&(i=c,a="after",r=!0)}else r=!Vn(l);if(s)if("DIGITAL-CLOCK"===s.nodeName||"MEDIA-ITEM"===s.nodeName||"TEXT-ICON"===s.nodeName||"SHOP-PRODUCT"===s.nodeName||"AUDIO-PLAYER"===s.nodeName)try{n?(l.selectNode(s),o=null):t?o.selectNodeContents(s.shadowRoot):(o.selectNodeContents(s.shadowRoot),o.setEndAfter(s))}catch(e){o=null,l.selectNode(d)}else o=null,l.selectNode(d);return{needsForcedRange:r,normalizedRange:l,rangeToSelectInShadowDom:o,shadowDomElementAdjacentToCollapsedRange:i,singleSelectedElementWithShadowDom:s,collapseDirection:a}}function P(e){if(e){var e=ht(e=ft(e)),t=rr.rangy.createRange(),n=(t.setStart(e.normalizedRange.startContainer,e.normalizedRange.startOffset),t.setEnd(e.normalizedRange.endContainer,e.normalizedRange.endOffset),e.needsForcedRange?rr.forcedRange=t:rr.forcedRange=null,/Firefox\/\d+\.\d+/.test(navigator.userAgent));-1!=navigator.userAgent.indexOf("Safari")&&navigator.userAgent.indexOf("Chrome");if(e.needsForcedRange&&!n){var r=j(t);if(e.rangeToSelectInShadowDom)e.rangeToSelectInShadowDom.select();else if(t.collapsed)t.select();else{for(var o=t.cloneRange(),i=0;i<r.length&&r[i].__shadow_selection;i++)o.setStartAfter(r[i]);for(i=r.length-1;0<=i&&r[i].__shadow_selection;i--)o.setEndBefore(r[i]);o.collapsed&&0<r.length&&(o.selectNode(r[r.length-1]),o.collapse(!1)),o.select()}}else t.select()}else rr.forcedRange=null}function pt(e,t,n,r){var o,i,e=e.toLowerCase();(1==arguments.length||4<=arguments.length&&void 0===t)&&(t=!1),(arguments.length<=2||4<=arguments.length&&void 0===n)&&(n=""),rr.rangy.getSelection();if(r=(r=r&&bt(r.commonAncestorContainer)?null:r)||O())return ct(0,0,r,(o=e,i=n,function(){return!!ut(o)&&(L[o].action(i,r),!0)}))}function gt(e,t){e=e.toLowerCase();var n,r=rr.rangy.getSelection();if(!t){if(0===r.rangeCount)return;t=O()}return ct(0,0,t,(n=e,function(){return!!ut(n,t)&&(void 0!==Ie(n,t)?Ie(n,t):L[n].state(t))}))}function Nt(e,t){e=e.toLowerCase();var n=rr.rangy.getSelection();if(!t){if(0===n.rangeCount)return;t=O()}return ct(0,0,t,function(){return L.hasOwnProperty(e)&&L[e].hasOwnProperty("value")?void 0!==He(e,t)?He(e,t):L[e].value(t):""})}var o={ADDRESS:!0,ARTICLE:!0,ASIDE:!0,BLOCKQUOTE:!0,CAPTION:!0,CENTER:!0,COL:!0,COLGROUP:!0,DD:!0,DETAILS:!0,DIR:!0,DIV:!0,DL:!0,DT:!0,FIELDSET:!0,FIGCAPTION:!0,FIGURE:!0,FOOTER:!0,FORM:!0,H1:!0,H2:!0,H3:!0,H4:!0,H5:!0,H6:!0,HEADER:!0,HGROUP:!0,HR:!0,LISTING:!0,MENU:!0,NAV:!0,P:!0,PLAINTEXT:!0,PRE:!0,SECTION:!0,SUMMARY:!0,TABLE:!0,TBODY:!0,TD:!0,TFOOT:!0,TH:!0,THEAD:!0,TR:!0,XMP:!0};function mt(e){return Ke(e,o)}var vt,Et,Ct,yt={contents:!0,inline:!0,"inline-flex":!0,"inline-grid":!0,"inline-block":!0,"inline-table":!0,none:!0};function B(e){return e&&(e.nodeType==Node.ELEMENT_NODE&&!yt[_.getComputedStyle(e).display]||e.nodeType==Node.DOCUMENT_NODE||e.nodeType==Node.DOCUMENT_FRAGMENT_NODE)}function U(e){return e&&!B(e)}function H(e){return null!=e&&null!==e.parentNode&&e&&e.nodeType==Node.ELEMENT_NODE&&("true"==e.contentEditable||e.parentNode&&e.parentNode.nodeType==Node.DOCUMENT_NODE&&"on"==e.parentNode.designMode)}function F(e){return null!=e&&e&&!bt(e)&&!H(e)&&(e.nodeType!=Node.ELEMENT_NODE||"false"!=e.contentEditable)&&(H(e.parentNode)||F(e.parentNode))}function bt(e){var t;return null!=e&&((t=e.getRootNode())instanceof ShadowRoot||!(e!==t||!e.host||!e.host.shadowRoot||e.host.shadowRoot!==e))}function Tt(e){if(H(e))return e;if(F(e=bt(e)?e.getRootNode():e)){for(var t=e.parentNode;!H(t);)t=t.parentNode;return t}return null}function V(e,t){return Tt(e)&&Tt(e)==Tt(t)}function Ot(e){return St(e)}function St(e){if(!k(e,"br"))return!1;if(k(e.parentNode,"li")&&1==e.parentNode.childNodes.length)return!1;if(k(e.parentNode,"a")){if(null===e.nextElementSibling)for(var t=e.parentNode;Lt(t);){if(["COLUMN-UNIT","COLUMN-SET"].includes(t.nodeName)||H(t))return!0;t=t.parentNode}return!1}var n=document.createRange(),r=(n.selectNode(e),n.getBoundingClientRect());if(0!==r.height||0!==r.bottom)if(1===e.parentNode.children.length&&e.parentNode.children[0]===e)for(var o=e.nextSibling;o;){if(!q(o))return!1;o=o.nextSibling}else{for(var i=e.nextSibling;i&&(i.nodeType!==Node.TEXT_NODE||q(i));)i=i.nextSibling;var a=i;if(null===i&&e!==e.parentNode.lastElementChild)for(a=E(e);a&&q(a);)a=E(a);if(a&&!q(a)){n.selectNode(a);var s=n.getBoundingClientRect().bottom;if(0!==s&&r.bottom!==s)return!1}else{for(var l=Ye(e);l&&q(l);)l=Ye(l);if(l&&!q(l)){n.selectNode(l);s=n.getBoundingClientRect().bottom;if(0!==s&&r.bottom!==s)return!1}}}return!0}function q(e){var t=Node;if(e&&e.nodeType===t.TEXT_NODE){var n=e.parentNode,e=e.data;if(0===e.trim().length)return!0;if(n&&/^[\t\n\r ]+$/.test(e))if(n.nodeType===t.ELEMENT_NODE){if(-1!==["normal","nowrap"].indexOf(_.getComputedStyle(n).whiteSpace))return!0;if("pre-line"===_.getComputedStyle(n).whiteSpace)return!0}else if(n.nodeType===t.DOCUMENT_FRAGMENT_NODE)return!0}return!1}function Rt(e){if(q(e)){if(""==e.data)return!0;var t=e.parentNode;if(!t)return!0;if(_(et(e)).some(function(e){return e.nodeType==Node.ELEMENT_NODE&&"none"==_.getComputedStyle(e).display}))return!0;for(;!B(t)&&t.parentNode;)t=t.parentNode;for(var n=e;n!=t;){if(B(n=Ye(n))||k(n,"br"))return!0;if(n.nodeType==Node.TEXT_NODE&&!q(n)||k(n,"img"))break}for(var n=e,r=$e(t);n!=r;){if(B(n=E(n))||k(n,"br"))return!0;if(n&&n.nodeType==Node.TEXT_NODE&&!q(n)||k(n,"img"))break}}return!1}function i(e){var t;if(e){if(-1!=Oe.indexOf(e.nodeName.toLowerCase()))return!0;if(!_(et(e).concat(e)).filter(function(e){return e.nodeType==Node.ELEMENT_NODE},!0).some(function(e){return"none"==_.getComputedStyle(e).display})){if(e.nodeType===Node.TEXT_NODE&&null!==e.textContent.match(/\xA0| {2,}/gi))return!0;if(B(e)||e.nodeType==Node.TEXT_NODE&&!Rt(e)||k(e,"img")||k(e,"br")&&!St(e))return!0;for(t=0;t<e.childNodes.length;t++)if(i(e.childNodes[t]))return!0}}return!1}function wt(e){return e&&!i(e)}function At(e){if(Ot(e)&&!St(e))return!0;if(!U(e)||e.nodeType!=Node.ELEMENT_NODE)return!1;for(var t=!1,n=0;n<e.childNodes.length;n++){if(!wt(e.childNodes[n])&&!At(e.childNodes[n]))return!1;At(e.childNodes[n])&&(t=!0)}return t}function Dt(e){return e&&S(e)&&H(e.parentNode)&&!e.previousSibling&&!e.nextSibling}function xt(e){var t=e.parentNode,n=x(e);return t.removeChild(e),{node:t,offset:n}}function O(e={}){var t,n=!1;if(rr.forcedRange||g?(t=rr.rangy.createRange(),rr.forcedRange&&rr.forcedRange.isValid()?(n=!0,t.setStart(rr.forcedRange.startContainer,rr.forcedRange.startOffset),t.setEnd(rr.forcedRange.endContainer,rr.forcedRange.endOffset)):g?(ft(g),t.setStart(g.startContainer,g.startOffset),t.setEnd(g.endContainer,g.endOffset)):rr.forcedRange=null):rr.rangy.getSelection&&rr.rangy.getSelection().rangeCount&&(t=rr.rangy.getSelection().getRangeAt(0)),t)return t&&!_t(t)&&(n?(rr.forcedRange=null,t=O(),e.silent||console.warn("forced range is invalid, fallback to real range",t)):e.silent||console.error("Invalid active range")),t}function _t(e){return e&&!!(e.isValid()&&-1!=[Node.TEXT_NODE,Node.ELEMENT_NODE].indexOf(e.startContainer.nodeType)&&-1!=[Node.TEXT_NODE,Node.ELEMENT_NODE].indexOf(e.endContainer.nodeType)&&e.startContainer.ownerDocument&&e.endContainer.ownerDocument&&Ze(e.startContainer,e.startContainer.ownerDocument)&&Ze(e.endContainer,e.endContainer.ownerDocument))}function Lt(e){if(!e)return!1;if(null!==e.nextSibling)for(var t=e.nextSibling;null!==t;){if(t.nodeType===Node.ELEMENT_NODE&&("BR"!==t.nodeName||!Ot(t)))return!1;if(t.nodeType===Node.TEXT_NODE&&!1===q(t))return!1;t=t.nextSibling}return!0}function kt(e){if(null===e)return!1;if(null!==e.previousSibling)for(var t=e.previousSibling;null!==t;){if(t.nodeType===Node.ELEMENT_NODE&&("BR"!==t.nodeName||!Ot(t)))return!1;if(t.nodeType===Node.TEXT_NODE&&!1===q(t))return!1;t=t.previousSibling}return!0}function X(e,t,n,r){-1==n&&(n=t.childNodes.length);var o,i=e.parentNode,a=x(e),s=[r],l=O({silent:!0}),d=(_t(l)&&s.push(l),[]),c=(_(s).forEach(function(e){d.push([e.startContainer,e.startOffset]),d.push([e.endContainer,e.endOffset])}),_(d).forEach(function(e){e[0]==t&&e[1]>n&&e[1]++,e[0]!=i||e[1]!=a&&e[1]!=a+1||(e[0]=t,e[1]+=n-a),e[0]==i&&e[1]>a+1&&e[1]--}),t.childNodes.length==n?t.appendChild(e):t!==e&&t.insertBefore(e,t.childNodes[n]),null);if(d[0][0].nodeType!==Node.TEXT_NODE&&d[0][1]>d[0][0].childNodes.length&&d[1][0].nodeType!==Node.TEXT_NODE&&d[1][1]>d[1][0].childNodes.length)r.setStart(e,0),r.setEnd(e,0);else{for(d[0][0].nodeType===Node.ELEMENT_NODE?d[0][1]>d[0][0].childNodes.length&&(d[0][1]=d[0][0].childNodes.length):d[0][0].nodeType===Node.TEXT_NODE&&d[0][1]>d[0][0].length&&(d[0][1]=d[0][0].length),d[1][0].nodeType===Node.ELEMENT_NODE?d[1][1]>d[1][0].childNodes.length&&(d[1][1]=d[1][0].childNodes.length):d[1][0].nodeType===Node.TEXT_NODE&&d[1][1]>d[1][0].length&&(d[1][1]=d[1][0].length),r.setStart(d[0][0],d[0][1]),r.setEnd(d[1][0],d[1][1]),rr.rangy.getSelection().removeAllRanges(),o=1;o<s.length;o++)(c=rr.rangy.createRange()).setStart(d[2*o][0],d[2*o][1]),c.setEnd(d[2*o+1][0],d[2*o+1][1]),P(c=ft(c));c&&(r=c)}return r}function Mt(e,t){for(var n,r,o=e.attributes,i=0;i<o.length;i++)r=(n=o[i]).value,"style"===n.name&&"SPAN"===t.nodeName||"href"===n.name&&"A"===e.nodeName||void 0!==n.specified&&!n.specified||("function"==typeof t.setAttributeNS?t.setAttributeNS(n.namespaceURI,n.name,r):t.setAttribute(n.name,r))}function It(e,t,n){if(k(e,t))return e;if(!e.parentNode)return e;var r=e.ownerDocument.createElement(t);for(e.parentNode.insertBefore(r,e),Mt(e,r);e.childNodes.length;)X(e.firstChild,r,r.childNodes.length,n);return e.parentNode.removeChild(e),n.startContainer===e&&n.setStart(r,n.startOffset),n.endContainer===e&&n.setEnd(r,n.endOffset),r}function Pt(e){var t=e.previousSibling;if(t){for(;t.hasChildNodes();)t=t.lastChild;for(;wt(t)&&!St(t)&&t!=e.parentNode;)t=Ye(t);F(t)&&St(t)&&t.parentNode.removeChild(t)}}function Bt(e){for(var t=e;t.hasChildNodes();)t=t.lastChild;for(;wt(t)&&!St(t)&&t!=e;)t=Ye(t);F(t)&&St(t)&&t.parentNode.removeChild(t)}function Ut(e,t,n,r,o){var i,a,s,l,d;if(void 0===t&&(t=function(){return!1}),void 0===n&&(n=function(){return null}),!0!==o&&(o=!1),!e.length||!F(e[0]))return null;if(!(a=F(e[0].previousSibling)&&t(e[0].previousSibling)?e[0].previousSibling:F(e[e.length-1].nextSibling)&&t(e[e.length-1].nextSibling)?e[e.length-1].nextSibling:n()))return null;a.parentNode||(e[0].parentNode.insertBefore(a,e[0]),n=r.startContainer,c=r.startOffset,s=r.endContainer,l=r.endOffset,(d=x(a))<=c&&n==a.parentNode&&r.setStart(n,c+1),d<=l&&s==a.parentNode&&(l+=1,s.nodeType===Node.ELEMENT_NODE&&l>s.childNodes.length&&(l=s.childNodes.length),r.setEnd(s,l)),g&&g!==r&&(n=g.startContainer,c=g.startOffset,s=g.endContainer,l=g.endOffset,n==a.parentNode&&d<=c&&g.setStart(n,c+1),s==a.parentNode)&&d<=l&&g.setEnd(s,Math.min(l+1,s.childNodes.length)));var c,n=e[0].parentNode;if(Je(a,e[0]))for(U(a)||!U(a.lastChild)||!U(e[0])||k(a.lastChild,"BR")||o||a.appendChild(a.ownerDocument.createElement("br")),i=0;i<e.length;i++)X(e[i],a,-1,r);else for(U(a)||!U(a.firstChild)||!U(e[e.length-1])||k(e[e.length-1],"BR")||o||(c=a.ownerDocument.createElement("br"),a.insertBefore(c,a.firstChild)),i=e.length-1;0<=i;i--)X(e[i],a,0,r);if(F(n)&&!n.hasChildNodes()&&n.parentNode.removeChild(n),F(a.nextSibling)&&t(a.nextSibling)){for(U(a)||!U(a.lastChild)||!U(a.nextSibling.firstChild)||k(a.lastChild,"BR")||o||a.appendChild(a.ownerDocument.createElement("br"));a.nextSibling.hasChildNodes();)X(a.nextSibling.firstChild,a,-1,r);a.parentNode.removeChild(a.nextSibling)}return a}vt={},Et={},Be=function(e){return!(Ct&&Ct.startContainer==e.startContainer&&Ct.endContainer==e.endContainer&&Ct.startOffset==e.startOffset&&Ct.endOffset==e.endOffset||(Ct={startContainer:e.startContainer,endContainer:e.endContainer,startOffset:e.startOffset,endOffset:e.endOffset},ve.isEmpty(vt)&&ve.isEmpty(Et))||(vt={},Et={},0))},Ie=function(e,t){return Be(t),vt[e]},Pe=function(e,t,n){Be(n),vt[e]=t},Ue=function(e,t){Be(t),delete vt[e]},He=function(e,t){return Be(t),Et[e]},Fe=function(e,t,n){Be(n),Et[e]=t,"backcolor"==e?Et.hilitecolor=t:"hilitecolor"==e&&(Et.backcolor=t)},Ve=function(e,t){Be(t),delete Et[e],"backcolor"==e?delete Et.hilitecolor:"hilitecolor"==e&&delete Et.backcolor};var Ht={A:!(Ct=null),ABBR:!0,B:!0,BDI:!0,BDO:!0,CITE:!0,CODE:!0,DFN:!0,EM:!0,H1:!0,H2:!0,H3:!0,H4:!0,H5:!0,H6:!0,I:!0,KBD:!0,MARK:!0,P:!0,PRE:!0,Q:!0,RP:!0,RT:!0,RUBY:!0,S:!0,SAMP:!0,SMALL:!0,SPAN:!0,STRONG:!0,SUB:!0,SUP:!0,U:!0,VAR:!0,ACRONYM:!0,LISTING:!0,STRIKE:!0,XMP:!0,BIG:!0,BLINK:!0,FONT:!0,MARQUEE:!0,NOBR:!0,TT:!0},Ft={colgroup:!0,table:!0,tbody:!0,tfoot:!0,thead:!0,tr:!0},Vt={script:!0,style:!0,plaintext:!0,xmp:!0},qt=d({H1:!0,H2:!0,H3:!0,H4:!0,H5:!0,H6:!0},o),we={CAPTION:!0,COL:!0,COLGROUP:!0,TBODY:!0,TD:!0,TFOOT:!0,TH:!0,THEAD:!0,TR:!0},Ae={DD:!0,DT:!0},Xt={A:d({A:!0},o),DD:Ae,DT:Ae,LI:{LI:!0},NOBR:d({NOBR:!0},o),H1:qt,H2:qt,H3:qt,H4:qt,H5:qt,H6:qt,TD:we,TH:we,ABBR:o,B:o,BDI:o,BDO:o,CITE:o,CODE:o,DFN:o,EM:o,I:o,KBD:o,MARK:o,P:o,PRE:o,Q:o,RP:o,RT:o,RUBY:o,S:o,SAMP:o,SMALL:o,SPAN:o,STRONG:o,SUB:o,SUP:o,U:o,VAR:o,ACRONYM:o,LISTING:o,STRIKE:o,XMP:o,BIG:o,BLINK:o,FONT:o,MARQUEE:o,TT:o};function W(e,t){if((Ft[t]||M(t,["colgroup","table","tbody","tfoot","thead","tr"]))&&"object"==typeof e&&e.nodeType==Node.TEXT_NODE&&!/^[ \t\n\f\r]*$/.test(e.data))return!1;if((Vt[t]||M(t,["script","style","plaintext","xmp"]))&&("object"!=typeof e||e.nodeType!=Node.TEXT_NODE))return!1;if("object"==typeof e&&(e.nodeType==Node.DOCUMENT_NODE||e.nodeType==Node.DOCUMENT_FRAGMENT_NODE||e.nodeType==Node.DOCUMENT_TYPE_NODE))return!1;var n=e;if("string"==typeof(e=je(e)?e.tagName.toLowerCase():e)){if(je(t)){if("COLUMN-UNIT"===t.nodeName||"COLUMN-SET"===t.nodeName)return"li"!==e;for(var r=t;r;){if(r!==n){if("a"==e&&k(r,"a"))return!1;if(o[e.toUpperCase()]&&Ke(r,Ht))return!1;if(/^h[1-6]$/.test(e)&&je(r)&&/^H[1-6]$/.test(r.tagName))return!1}r=r.parentNode}t=t.tagName.toLowerCase()}if("object"!=typeof t||t.nodeType!=Node.ELEMENT_NODE&&t.nodeType!=Node.DOCUMENT_FRAGMENT_NODE){if("string"!=typeof t)return!1;switch(t){case"colgroup":return"col"==e;case"table":return-1!=["caption","col","colgroup","tbody","td","tfoot","th","thead","tr"].indexOf(e);case"tbody":case"thead":case"tfoot":return-1!=["td","th","tr"].indexOf(e);case"tr":return-1!=["td","th"].indexOf(e);case"dl":return-1!=["dt","dd"].indexOf(e);case"dir":case"ol":case"ul":return-1!=["dir","li","ol","ul"].indexOf(e);case"hgroup":return/^h[1-6]$/.test(e)}if(-1!=["body","caption","col","colgroup","frame","frameset","head","html","tbody","td","tfoot","th","thead","tr","column-unit","column-set"].indexOf(e))return!1;if(-1!=["dd","dt"].indexOf(e)&&"dl"!=t)return!1;if("li"==e&&"ol"!=t&&"ul"!=t)return!1;t=Xt[t.toUpperCase()];if(t)if(t[e.toUpperCase()])return!1}}return!0}function Wt(e,t){return!(!e||t.collapsed)&&(!!it(e,t)||e==t.startContainer&&e.nodeType==Node.TEXT_NODE&&I(e)!=t.startOffset||e==t.endContainer&&e.nodeType==Node.TEXT_NODE&&0!=t.endOffset||!(!e.hasChildNodes()||!_(e.childNodes).every(function(e){return Wt(e,t)})||Ze(t.startContainer,e)&&t.startContainer.nodeType==Node.TEXT_NODE&&0!=t.startOffset||Ze(t.endContainer,e)&&t.endContainer.nodeType==Node.TEXT_NODE&&t.endOffset!=I(t.endContainer)))}function jt(e,t){void 0===t&&(t=function(){return!0});for(var n=e.startContainer;null!==n.parentNode&&Wt(n.parentNode,e);)n=n.parentNode;for(var r=$e(e.endContainer),o=[];n&&r&&Je(n,r);)n=(Wt(n,e)&&t(n)?(o.push(n),$e):E)(n);return o}function j(n,r){if(!n)return[];void 0===r&&(r=function(){return!0});for(var e=n.startContainer;Wt(e.parentNode,n);)e=e.parentNode;var t=n.startContainer,o=n.endContainer,i=n.commonAncestorContainer;function a(e){return e===i||e.parentNode===i||null===e.parentNode?e:a(e.parentNode)}var s=a(t),l=a(o);return n.getNodes(!1,function(e){var t=a(e);if(t!==s&&t!==e&&t!==l&&t!==e){if(r(e))return e}else if(Wt(e,n)&&r(e))return e})}function Kt(e){if(je(e)){if(-1!=["B","EM","I","S","SPAN","STRIKE","STRONG","SUB","SUP","U"].indexOf(e.tagName)){if(0==e.attributes.length)return 1;if(1==e.attributes.length&&s(e,"style"))return 1}if("FONT"==e.tagName||"A"==e.tagName){var t=e.attributes.length;if(s(e,"style")&&t--,"FONT"==e.tagName&&(s(e,"color")&&t--,s(e,"face")&&t--,s(e,"size"))&&t--,"A"==e.tagName&&s(e,"href")&&t--,0==t)return 1}}}function zt(e){return!(!je(e)||-1==["A","B","EM","FONT","I","S","SPAN","STRIKE","STRONG","SUB","SUP","U","SMALL"].indexOf(e.tagName)||0!=e.attributes.length&&(1<e.attributes.length||(!s(e,"style")||0!=ze(e))&&!("A"==e.tagName&&s(e,"href")||"FONT"==e.tagName&&(s(e,"color")||s(e,"face")||s(e,"size"))||("B"==e.tagName||"STRONG"==e.tagName)&&s(e,"style")&&1==ze(e)&&""!=e.style.fontWeight||"SMALL"==e.tagName&&s(e,"style")&&1==ze(e)&&""!=e.style.fontSize||("I"==e.tagName||"EM"==e.tagName)&&s(e,"style")&&1==ze(e)&&""!=e.style.fontStyle||("A"==e.tagName||"FONT"==e.tagName||"SPAN"==e.tagName)&&s(e,"style")&&1==ze(e)&&""==e.style.textDecoration||-1!=["A","FONT","S","SPAN","STRIKE","U","SMALL"].indexOf(e.tagName)&&s(e,"style")&&1==ze(e)&&("line-through"==e.style.textDecoration||"underline"==e.style.textDecoration||"overline"==e.style.textDecoration||"none"==e.style.textDecoration))))}function Gt(e,t,n){return null===t&&null===n||"string"==typeof t&&"string"==typeof n&&t==n&&!L[e].hasOwnProperty("equivalentValues")||!("string"!=typeof t||"string"!=typeof n||!L[e].hasOwnProperty("equivalentValues")||!L[e].equivalentValues(t,n))}function $t(e,t,n){return Gt(e,t,n)}function K(e,t){if(e.nodeType!=Node.ELEMENT_NODE&&(!e.parentNode||e.parentNode.nodeType!=Node.ELEMENT_NODE))return null;if(e.nodeType!=Node.ELEMENT_NODE)return K(e.parentNode,t);if("createlink"==t||"unlink"==t){for(;e&&(!je(e)||"A"!=e.tagName||!s(e,"href"));)e=e.parentNode;return e?e.getAttribute("href"):null}if("backcolor"==t||"hilitecolor"==t){for(;("rgba(0, 0, 0, 0)"==_.getComputedStyle(e).background||""===_.getComputedStyle(e).background||"transparent"==_.getComputedStyle(e).background)&&e.parentNode&&e.parentNode.nodeType==Node.ELEMENT_NODE;)e=e.parentNode;return"rgba(0, 0, 0, 0)"==_.getComputedStyle(e).background||""===_.getComputedStyle(e).background||"transparent"==_.getComputedStyle(e).background?"rgb(255, 255, 255)":_.getComputedStyle(e).background}if("subscript"==t||"superscript"==t){for(var n=!1,r=!1;U(e);){_.getComputedStyle(e).verticalAlign;k(e,"sub")?n=!0:k(e,"sup")&&(r=!0),e=e.parentNode}return n&&r?"mixed":n?"subscript":r?"superscript":null}if("small"==t){do{if(k(e,"SMALL"))return"small"}while((e=e.parentNode)&&e.nodeType==Node.ELEMENT_NODE);return null}if("bold"==t){do{if(k(e,"B"))return"bold"}while((e=e.parentNode)&&e.nodeType==Node.ELEMENT_NODE);return null}if("strikethrough"==t){do{if(-1!=_.getComputedStyle(e).textDecoration.indexOf("line-through"))return"line-through"}while((e=e.parentNode)&&e.nodeType==Node.ELEMENT_NODE);return null}if("underline"==t){do{if(e&&"U"===e.nodeName)return"underline"}while((e=e.parentNode)&&e.nodeType==Node.ELEMENT_NODE);return null}if(L[t].hasOwnProperty("relevantCssProperty"))return _.getComputedStyle(e)[L[t].relevantCssProperty].toString();throw"Bug: no relevantCssProperty for "+t+" in getEffectiveCommandValue"}function v(e,t){return"backcolor"!=t&&"hilitecolor"!=t||"inline"==_.getComputedStyle(e).display?"createlink"==t||"unlink"==t?je(e)&&"A"==e.tagName&&s(e,"href")?e.getAttribute("href"):null:"subscript"==t||"superscript"==t?k(e,"sup")?"superscript":k(e,"sub")?"subscript":null:"strikethrough"==t&&""!=e.style.textDecoration?-1!=e.style.textDecoration.indexOf("line-through")?"line-through":null:"strikethrough"==t&&M(e,["S","STRIKE"])?"line-through":"underline"==t&&k(e,"U")?"underline":"small"==t&&k(e,"SMALL")?"small":"bold"==t&&k(e,"B")?"bold":null===(t=L[t].relevantCssProperty)?null:""!=e.style[t]?e.style[t]:"fontWeight"!=t||"B"!=e.tagName&&"STRONG"!=e.tagName?"fontStyle"!=t||"I"!=e.tagName&&"EM"!=e.tagName?null:"italic":"bold":null}function Yt(e,t,n,r){for(var o=e;Kt(o)&&1==o.childNodes.length&&Kt(o.firstChild)&&(!zt(o)||!Gt(t,v(o,t),n));)o=o.firstChild;if(o!=e&&zt(o)&&Gt(t,v(o,t),n)&&$t(t,K(o,t),n)){for(;o.hasChildNodes();)X(o.firstChild,o.parentNode,x(o),r);e.parentNode.insertBefore(o,e.nextSibling),X(e,o,-1,r)}}var Qt=["subscript","bold","small","forecolor","hilitecolor","italic","strikethrough","underline"];function Zt(e){for(var t,n,r,o,i,a=[],s=[].slice.call(e),l=0;l<s.length;l++)for(n=s[l],t=0;t<Qt.length;t++){for(r=Qt[t],1!=(o=n).nodeType&&(o=o.parentNode),i=null;o&&1==o.nodeType&&null===(i=v(o,r));)o=o.parentNode;a.push([n,r,i])}return a}function Jt(e,t,n){if(F(e)&&null!==v(e,t))if(zt(e)){for(var r=Array.prototype.slice.call(Ge(e.childNodes)),o=0;o<r.length;o++)X(r[o],e.parentNode,x(e),n);e.parentNode.removeChild(e)}else"strikethrough"==t&&-1!=e.style.textDecoration.indexOf("line-through")&&("line-through"==e.style.textDecoration?e.style.textDecoration="":e.style.textDecoration=e.style.textDecoration.replace("line-through",""),""==e.getAttribute("style"))&&e.removeAttribute("style"),"underline"==t&&-1!=e.style.textDecoration.indexOf("underline")&&("underline"==e.style.textDecoration?e.style.textDecoration="":e.style.textDecoration=e.style.textDecoration.replace("underline",""),""==e.getAttribute("style"))&&e.removeAttribute("style"),null!==L[t].relevantCssProperty&&(e.style[L[t].relevantCssProperty]="")==e.getAttribute("style")&&e.removeAttribute("style"),We(e.namespaceURI)&&"FONT"==e.tagName&&"forecolor"==t&&e.removeAttribute("color"),!k(e,"A")||"createlink"!=t&&"unlink"!=t||An(e,n),null!==v(e,t)&&It(e,"span",n)}var en=/((?:^|\s|;)color:)(?:.*?);/g,tn=/((?:^|\s|;)background:)(?:.*?);/g;function nn(e,t,n,r){var o,i,a=[];if(e.parentNode&&null!==n&&(W(e,"span")&&(Yt(e.previousSibling,t,n,r),Yt(e.nextSibling,t,n,r),Ut([e],function(e){return zt(e)&&Gt(t,v(e,t),n)&&$t(t,K(e,t),n)},function(){return null},r)),!$t(t,K(e,t),n)))if(W(e,"span")){if(!$t(t,K(e,t),n)){var s=null,l=!1;if(!Xe&&("bold"!=t||"bold"!=n&&"700"!=n||(s=e.ownerDocument.createElement("b")),"small"==t&&"small"==n&&(s=e.ownerDocument.createElement("small")),"italic"==t&&"italic"==n&&(s=e.ownerDocument.createElement("i")),"strikethrough"==t&&"line-through"==n&&(s=e.ownerDocument.createElement("s")),"underline"==t&&"underline"==n&&(s=e.ownerDocument.createElement("u")),"forecolor"==t||"backcolor"==t||"hilitecolor"==t)&&lt(n)){var d=null;if(r){var c=rr.rangy.createRange();if(c.selectNode(e),null!==(c=r.intersection(c))){var u=e,f=c.toString(),h=function(e){if(e.nodeType===Node.ELEMENT_NODE&&"SPAN"===e.nodeName)return d=e,!1},p=!0;for(u.nodeType!==Node.ELEMENT_NODE&&(u=u.parentNode),p&&(f=f.trim());null!==u&&!1===H(u)&&(!0===p?u.textContent.trim():u.textContent)===f&&(!h||!1!==h(u));)u=u.parentNode;null===d&&"SPAN"===r.commonAncestorContainer.nodeName&&r.toString()===r.commonAncestorContainer.textContent&&(d=r.commonAncestorContainer)}}d?(s=d,l=!0):s=e.ownerDocument.createElement("span");var g,N,c=s.getAttribute("style");"hilitecolor"==t||"backcolor"==t?(N="background: "+n+";","string"==typeof c&&(g=!1,N=c.replace(tn,function(e,t){return g=!0,t+" "+n+";"}),g||(N="background: "+n+"; "+c)),s.setAttribute("style",N)):"forecolor"==t&&(N="color: "+n+";","string"==typeof c&&(g=!1,N=c.replace(en,function(e,t){return g=!0,t+" "+n+";"}),g||(N="color: "+n+"; "+c)),s.setAttribute("style",N))}if("createlink"==t||"unlink"==t){(s=e.ownerDocument.createElement("a")).setAttribute("href",n);for(var m=e.parentNode;m;)m=(m=k(m,"A")?It(m,"span",r):m).parentNode}if("subscript"!=t&&"superscript"!=t||"subscript"!=n||(s=e.ownerDocument.createElement("sub")),s=(s="subscript"!=t&&"superscript"!=t||"superscript"!=n?s:e.ownerDocument.createElement("sup"))||e.ownerDocument.createElement("span"),null!==e.parentNode){!0!==l&&e.parentNode.insertBefore(s,e),Ce.push(s);c=L[t].relevantCssProperty;if(null===c||$t(t,K(s,t),n)||"small"===t&&"fontSize"===c||"bold"===t&&"fontWeight"===c||(s.style[c]=n),"strikethrough"==t&&"line-through"==n&&"line-through"!=K(s,"strikethrough")&&(s.style.textDecoration="line-through"),"underline"==t&&"underline"==n&&"underline"!=K(s,"underline")&&(s.style.textDecoration="underline"),!0!==l&&X(e,s,s.childNodes.length,r),e.nodeType==Node.ELEMENT_NODE&&!Gt(t,K(e,t),n)){for(!0!==l&&(X(e,s.parentNode,x(s),r),s.parentNode.removeChild(s)),a=[],o=0;o<e.childNodes.length;o++)e.childNodes[o].nodeType==Node.ELEMENT_NODE&&null!==(i=v(e.childNodes[o],t))&&!Gt(t,n,i)||a.push(e.childNodes[o]);for(o=0;o<a.length;o++)nn(a[o],t,n,r)}}}}else{for(o=0;o<e.childNodes.length;o++)e.childNodes[o].nodeType==Node.ELEMENT_NODE&&null!==(i=v(e.childNodes[o],t))&&!Gt(t,n,i)||a.push(e.childNodes[o]);for(o=0;o<a.length;o++)nn(a[o],t,n,r)}}function rn(e,t,n,r){if(e.parentNode&&e.parentNode.nodeType==Node.ELEMENT_NODE&&!$t(t,K(e,t),n)){for(var o=e.parentNode,i=[];F(o)&&o.nodeType==Node.ELEMENT_NODE&&!$t(t,K(o,t),n);)i.push(o),o=o.parentNode;if(i.length){var a=v(i[i.length-1],t);if((null!==a||a==n)&&(null===n||$t(t,K(i[i.length-1].parentNode,t),n)))for(;i.length;){null!==v(o=i.pop(),t)&&(a=v(o,t));var s,l=Array.prototype.slice.call(Ge(o.childNodes));for(null!==v(o,t)&&Jt(o,t,r),s=0;s<l.length;s++){var d=l[s];d==e||d.nodeType==Node.ELEMENT_NODE&&null!==v(d,t)&&!Gt(t,a,v(d,t))||d==i[i.length-1]||nn(d,t,a,r)}}}}}function on(e,o){_(e).forEach(function(e){var t=e[0],n=e[1],e=e[2],r=t;for(r&&r.nodeType==Node.ELEMENT_NODE||(r=r.parentNode);r&&r.nodeType==Node.ELEMENT_NODE&&null===v(r,n);)r=r.parentNode;null===e&&r&&r.nodeType==Node.ELEMENT_NODE?rn(t,n,null,o):(!r||r.nodeType!=Node.ELEMENT_NODE||Gt(n,v(r,n),e))&&(r&&r.nodeType==Node.ELEMENT_NODE||null===e)||nn(t,n,e,o)})}function a(t,n,r){for(var e,o,i,a=(r=r||O()).startContainer,s=!1;a.parentNode;){if(a.nodeType===Node.ELEMENT_NODE&&("OL"===a.nodeName||"UL"===a.nodeName)){s=!0;break}a=a.parentNode}for(a=r.endContainer;a.parentNode&&!s;){if(a.nodeType===Node.ELEMENT_NODE&&("OL"===a.nodeName||"UL"===a.nodeName)){s=!0;break}a=a.parentNode}s&&(r=Hn(r)),_(j(r)).filter(function(e){return!("forecolor"!=t&&"backcolor"!=t&&"hilitecolor"!=t&&"italic"!=t&&"bold"!=t&&"strikethrough"!=t&&"underline"!=t&&"subscript"!=t&&"superscript"!=t&&"createlink"!=t||"TEXT-ICON"!==e.nodeName&&"DIGITAL-CLOCK"!==e.nodeName)||"createlink"==t&&"IMG"===e.nodeName||"createlink"==t&&"VIDEO"===e.nodeName||e.nodeType==Node.TEXT_NODE},!0).some(F)?(F(r.startContainer)&&r.startContainer.nodeType==Node.TEXT_NODE&&0!=r.startOffset&&r.startOffset!=I(r.startContainer)&&(i=Me(r.startContainer,r.startOffset),o=rr.rangy.createRange(),r.startContainer==r.endContainer&&(e=r.endOffset-r.startOffset,o.setEnd(i,e),r.setEnd(i,e)),o.setStart(i,0),o.setEnd(r.endContainer,r.endOffset),rr.rangy.getSelection().removeAllRanges(),rr.rangy.getSelection().addRange(o),r.setStart(i,0)),F(r.endContainer)&&r.endContainer.nodeType==Node.TEXT_NODE&&0!=r.endOffset&&r.endOffset!=I(r.endContainer)&&(o=[(e=r).startContainer,e.startOffset],i=[e.endContainer,e.endOffset],Me(e.endContainer,e.endOffset),e.setStart(o[0],o[1]),e.setEnd(i[0],i[1]),rr.rangy.getSelection().removeAllRanges(),rr.rangy.getSelection().addRange(e)),_(j(O(),function(e){return F(e)&&e.nodeType==Node.ELEMENT_NODE})).forEach(function(e){(null===n||"SPAN"!=e.tagName||"forecolor"!==t&&"backcolor"!==t&&"hilitecolor"!==t)&&Jt(e,t,r)}),Ce=[],_(j(r,F)).forEach(function(e){rn(e,t,n,r),nn(e,t,n,r)}),[].forEach.call(Ce,function(e){S(e)&&!H(e)?Rn(e,r):null!==n&&(Pt(e=e),Bt(e))})):(L[t].hasOwnProperty("inlineCommandActivatedValues")&&Pe(t,-1!=_(L[t].inlineCommandActivatedValues).indexOf(n),r),"subscript"==t&&Ue("superscript",r),"superscript"==t&&Ue("subscript",r),null===n?Ve(t,r):L[t].hasOwnProperty("value")&&Fe(t,n,r))}function an(e,t){return!e.parentNode&&0==t||0<=t-1&&t-1<e.childNodes.length&&i(e.childNodes[t-1])&&(B(e.childNodes[t-1])||k(e.childNodes[t-1],"br"))}function sn(e,t){return!e.parentNode&&t==I(e)||t<e.childNodes.length&&i(e.childNodes[t])&&B(e.childNodes[t])}function ln(e,t){return an(e,t)||sn(e,t)}function dn(e){for(var t=0;!ln(e,t);){if(0<=t-1&&t-1<e.childNodes.length&&i(e.childNodes[t-1]))return!1;0!=t&&e.hasChildNodes()?t=I(e=e.childNodes[t-1]):(t=x(e),e=e.parentNode)}return!0}function cn(e){for(var t=I(e);!ln(e,t);){if(t<e.childNodes.length&&i(e.childNodes[t]))return!1;t!=I(e)&&e.hasChildNodes()?(e=e.childNodes[t],t=0):(t=1+x(e),e=e.parentNode)}return!0}function un(e,t,n){!0!==n&&(n=!1);var r,o=e[0].parentNode;if(F(o)&&o.parentNode){-1==e.indexOf(o.firstChild)||n||Pt(o);var i=-1!=e.indexOf(o.firstChild),a=-1!=e.indexOf(o.lastChild),s=i&&dn(o),l=a&&cn(o);if(!i&&a){for(r=e.length-1;0<=r;r--)X(e[r],o.parentNode,1+x(o),t);!l||cn(e[e.length-1])||n||e[e.length-1].parentNode.insertBefore(document.createElement("br"),e[e.length-1].nextSibling),Bt(o)}else{if(!i){var d=o.cloneNode(!1);for(o.removeAttribute("id"),o.parentNode.insertBefore(d,o);e[0].previousSibling;)X(o.firstChild,d,d.childNodes.length,t);null!==d.parentNode&&S(d)&&rr.helpers.unwrap(d,!0,t)}for(r=0;r<e.length;r++)X(e[r],o.parentNode,x(o),t);!s||dn(e[0])||n||(a=document.createElement("br"),e[0].parentNode.insertBefore(a,e[0]),t.startContainer.nodeType===Node.ELEMENT_NODE&&t.startContainer.childNodes[t.startOffset]===a&&t.setStartAfter(a)),!U(e[e.length-1])||k(e[e.length-1],"br")||!k(o.firstChild,"br")||U(o)||n||wn(o.firstChild,t),o.hasChildNodes()?n||Pt(o):(o.parentNode===t.startContainer&&o.parentNode===t.endContainer&&t.startContainer===t.endContainer&&t.startOffset===t.endOffset&&o.parentNode.childNodes.length===t.startOffset&&(t.setStart(t.startContainer,o.parentNode.childNodes.length-1),t.setEnd(t.endContainer,t.startOffset)),wn(o,t),!l||cn(e[e.length-1])||n||e[e.length-1].parentNode.insertBefore(document.createElement("br"),e[e.length-1].nextSibling)),!e[e.length-1].nextSibling&&e[e.length-1].parentNode&&Bt(e[e.length-1].parentNode)}return o}}function fn(){return!1}function hn(e){return M(e,["address","div","h1","h2","h3","h4","h5","h6","listing","p","pre","xmp"])}function pn(e){return hn(e)||M(e,["li","dt","dd"])}L.backcolor={action:function(e,t){/^([0-9a-fA-F]{3}){1,2}$/.test(e)&&(e="#"+e),(/^(rgba?|hsla?)\(.*\)$/.test(e)||lt(e)||"transparent"==e.toLowerCase())&&a("backcolor",e,t)},standardInlineValueCommand:!0,relevantCssProperty:"background",equivalentValues:function(e,t){return st(e)===st(t)},ignoreWhiteSpaceNodes:!0},L.bold={action:function(e,t){gt("bold",t)?a("bold",null,t):a("bold","bold",t)},inlineCommandActivatedValues:["bold"],ignoreWhiteSpaceNodes:!0},L.small={action:function(e,t){gt("small",t)?a("small",null,t):a("small","small",t)},inlineCommandActivatedValues:["small"],relevantCssProperty:"fontSize",equivalentValues:function(e,t){return e==t},ignoreWhiteSpaceNodes:!0},L.createlink={action:function(t,e){var n;""!==t&&(_(j(O())).forEach(function(e){_(et(e)).forEach(function(e){F(e)&&k(e,"a")&&s(e,"href")&&e.setAttribute("href",t)})}),a("createlink",t,e),1===(n=e.getNodes()).length)&&"IMG"===n[0].nodeName&&(e.selectNode(n[0]),P(e))},standardInlineValueCommand:!0},L.forecolor={action:function(e,t){e&&(/^([0-9a-fA-F]{3}){1,2}$/.test(e)&&(e="#"+e),/^(rgba?|hsla?)\(.*\)$/.test(e)||lt(e)||"transparent"==e.toLowerCase())&&a("forecolor",e,t)},standardInlineValueCommand:!0,relevantCssProperty:"color",equivalentValues:function(e,t){return st(e)===st(t)},ignoreWhiteSpaceNodes:!0},L.hilitecolor={action:function(e,t){/^([0-9a-fA-F]{3}){1,2}$/.test(e)&&(e="#"+e),(/^(rgba?|hsla?)\(.*\)$/.test(e)||lt(e)||"transparent"==e.toLowerCase())&&a("hilitecolor",e,t)},indeterm:function(){return 2<=_(j(O(),function(e){return F(e)&&e.nodeType==Node.TEXT_NODE})).map(function(e){return K(e,"hilitecolor")},!0).filter(function(e,t,n){return-1==_(n.slice(0,t)).indexOf(e)}).length},standardInlineValueCommand:!0,relevantCssProperty:"background",equivalentValues:function(e,t){return st(e)===st(t)},ignoreWhiteSpaceNodes:!0},L.italic={action:function(e,t){gt("italic",t)?a("italic",null,t):a("italic","italic",t)},inlineCommandActivatedValues:["italic","oblique"],relevantCssProperty:"fontStyle",ignoreWhiteSpaceNodes:!0},L.removeformat={action:function(e,t){var n;function r(e){return F(e)&&M(e,["abbr","acronym","b","bdi","bdo","big","blink","cite","code","dfn","em","font","i","ins","kbd","mark","nobr","q","s","samp","small","span","strike","strong","sub","sup","tt","u","var"])}var o=j(O(),r);_(o).forEach(function(e){for(;e.hasChildNodes();)X(e.firstChild,e.parentNode,x(e),O());e.parentNode.removeChild(e)}),F(O().startContainer)&&O().startContainer.nodeType==Node.TEXT_NODE&&0!=O().startOffset&&O().startOffset!=I(O().startContainer)&&(O().startContainer==O().endContainer?(n=O().endOffset-O().startOffset,o=Me(O().startContainer,O().startOffset),O().setStart(o,0),O().setEnd(o,n)):O().setStart(Me(O().startContainer,O().startOffset),0)),F(O().endContainer)&&O().endContainer.nodeType==Node.TEXT_NODE&&0!=O().endOffset&&O().endOffset!=I(O().endContainer)&&(o=[O().startContainer,O().startOffset],n=[O().endContainer,O().endOffset],O().setEnd(document.documentElement,0),Me(n[0],n[1]),O().setStart(o[0],o[1]),O().setEnd(n[0],n[1])),_(j(O(),F)).forEach(function(e){for(;r(e.parentNode)&&V(e.parentNode,e);)un([e],O())}),_(["subscript","bold","forecolor","hilitecolor","italic","strikethrough","underline"]).forEach(function(e){a(e,null,t)})}},L.strikethrough={action:function(e,t){gt("strikethrough",t)?a("strikethrough",null,t):a("strikethrough","line-through",t)},inlineCommandActivatedValues:["line-through"]},L.subscript={action:function(e,t){var n=gt("subscript",t);a("subscript",null,t),n||a("subscript","subscript",t)},indeterm:function(){var e=j(O(),function(e){return F(e)&&e.nodeType==Node.TEXT_NODE});return _(e).some(function(e){return"subscript"==K(e,"subscript")})&&_(e).some(function(e){return"subscript"!=K(e,"subscript")})||_(e).some(function(e){return"mixed"==K(e,"subscript")})},inlineCommandActivatedValues:["subscript"]},L.superscript={action:function(e,t){var n=gt("superscript",t);a("superscript",null,t),n||a("superscript","superscript",t)},indeterm:function(){var e=j(O(),function(e){return F(e)&&e.nodeType==Node.TEXT_NODE});return _(e).some(function(e){return"superscript"==K(e,"superscript")})&&_(e).some(function(e){return"superscript"!=K(e,"superscript")})||_(e).some(function(e){return"mixed"==K(e,"superscript")})},inlineCommandActivatedValues:["superscript"]},L.underline={action:function(e,t){gt("underline",t)?a("underline",null,t):a("underline","underline",t)},inlineCommandActivatedValues:["underline"]},L.unlink={action:function(){for(var e,t=O(),n=[],r=t.startContainer;r;r=r.parentNode)k(r,"A")&&s(r,"href")&&n.unshift(r);for(r=t.startContainer;r!=$e(t.endContainer);r=E(r))k(r,"A")&&s(r,"href")&&(it(r,t)||Qe(r,t.endContainer)||r==t.endContainer)&&n.push(r);for(e=0;e<n.length;e++)Jt(n[e],"unlink",t)},standardInlineValueCommand:!0};var gn="p";function Nn(){return document.createElement("br")}function mn(e){!e||H(e)||k(e.lastChild,"br")||_(e.childNodes).some(i)||e.appendChild(Nn())}function vn(e,t){if((F(e)||H(e))&&S(e))if(!1===H(e)&&S(e)&&null!==e.parentNode){for(var n=e,r=t,o=void 0,i=n;null!==(i=i.previousSibling);){if(i.nodeType===Node.TEXT_NODE&&!Rt(i)){n=i;break}if(i.nodeType===Node.ELEMENT_NODE){n=0<i.childNodes.length?i.lastChild:i;break}}!0===(o=null===i?!0:o)?(r.setStartBefore(n),r.setEndBefore(n)):(r.setStartAfter(n),r.setEndAfter(n));o=e.parentNode;null!==o&&(o.removeChild(e),vn(o,t))}else mn(e);else mn(e)}var En=["TABLE","OL","UL","DL"];function R(t,e){if(null!=t&&null!=t.parentNode&&F(t))if(_(et(t)).every(function(e){return!V(t,e)||!W(t,e)})&&!M(t,gn)){if(M(t,["dd","dt"]))Ut([t],function(e){return k(e,"dl")&&!e.attributes.length},function(){return document.createElement("dl")},e);else if("LI"===t.nodeName&&t.parentNode&&"OL"!==t.parentNode.nodeName&&"UL"!==t.parentNode.nodeName)a=t.parentNode,An(t,e);else if(mt(t)){mn(t=It(t,gn,e)),R(t,e);for(var n=tt(t),r=0;r<n.length;r++)R(n[r],e)}}else{for(var o,i,a,s=Zt([t]);!W(t,t.parentNode);){for(r=t.parentNode.childNodes.length-1;0<=r;--r)3==t.parentNode.childNodes[r].nodeType&&0==t.parentNode.childNodes[r].data.length&&(t.parentNode.removeChild(t.parentNode.childNodes[r]),e.startContainer==t.parentNode&&e.startOffset>r&&e.startOffset--,e.endContainer==t.parentNode)&&e.endOffset>r&&e.endOffset--;if(1==t.parentNode.childNodes.length&&(l=t,-1===En.indexOf(l.nodeName))){W(a=t.parentNode,t)&&t.textContent===a.textContent?(or.unwrap(t,!1),a.parentNode.insertBefore(t,a),t.appendChild(a)):(o=e.startOffset,i=e.endOffset,e.startContainer===t.parentNode&&e.startOffset>x(t)&&(o=e.startOffset+(t.childNodes.length-1)),e.endContainer===t.parentNode&&e.endOffset>x(t)&&(i=e.endOffset+(t.childNodes.length-1)),[].forEach.call(t.childNodes,function(e){rr.helpers.unwrap(e)}),e.startOffset=o,e.endOffset=i,ft(e));break}var l=t.parentNode,d=!1;if("SPAN"===l.nodeName&&(d=!0),un([t],e),d){for(var c=l.cloneNode();0<t.childNodes.length;)c.appendChild(t.childNodes[0]);t.appendChild(c)}if(l===t.parentNode){o=e.startOffset,i=e.endOffset,e.startContainer===t.parentNode&&e.startOffset>x(t)&&(o=e.startOffset+(t.childNodes.length-1)),e.endContainer===t.parentNode&&e.endOffset>x(t)&&(i=e.endOffset+(t.childNodes.length-1)),[].forEach.call(t.childNodes,function(e){rr.helpers.unwrap(e)}),e.setStart(e.startContainer,o),e.setEnd(e.endContainer,i);break}}on(s,e)}}function Cn(e,t){if(k(e,"LI")&&F(e)&&F(e.parentNode))for(var n=null;_(e.childNodes).some(o);){var r=e.lastChild;M(r,["OL","UL"])||!n&&r.nodeType==Node.TEXT_NODE&&/^[ \t\n\f\r]*$/.test(r.data)?(n=null,X(r,e.parentNode,1+x(e),t)):(n||(n=e.ownerDocument.createElement("li"),e.parentNode.insertBefore(n,e.nextSibling)),X(r,n,0,t))}function o(e){return M(e,["OL","UL"])}}function yn(e){if((e=void 0===e?O():e).commonAncestorContainer.nodeType!==Node.TEXT_NODE||0!==e.startOffset||e.startContainer.length!==e.endOffset){for(var t,n,r,o=e.endContainer,i=e.extractContents(),a=i.firstChild;null!==a;)a.nodeType===Node.ELEMENT_NODE&&S(a)&&a.parentNode.removeChild(a),a=a.nextSibling;0!==i.childNodes.length&&(t=i.childNodes[0],n=i.childNodes[i.childNodes.length-1],e.insertNode(i),i=t.previousSibling,r=n.nextSibling,null!==i&&t.nodeType===Node.ELEMENT_NODE&&i.nodeName===t.nodeName&&S(i)&&wn(i,e),null!==r&&n.nodeType===Node.ELEMENT_NODE&&r.nodeName===n.nodeName&&S(r)&&wn(r,e),e.setStartBefore(t),e.setEndAfter(n),Rn(o.parentNode,e))}return e}function bn(e,t,n){n=n||e.ownerDocument.body,e.nodeType==Node.TEXT_NODE?t==e.nodeValue.length?(r=e.ownerDocument.createTextNode(""),e.parentNode.insertBefore(r,e.nextSibling)):r=e.splitText(t):e=t?e.childNodes[t-1]:r=e.firstChild||e;for(var r,o,i=e,a=r,s=n;i!=s&&(o=i.parentNode);)a=function(e,t,n){var r=e.cloneNode(!1);for(;t.nextSibling;)r.appendChild(t.nextSibling);n&&r.insertBefore(n,r.firstChild);return r}(o,i,a),i=o;return a}function w(e){var t=e.startContainer,n=e.startOffset,r=e.endContainer,o=e.endOffset,e=_(et(t).concat(t)).filter(function(e){return k(e,"li")}).slice(-1);if(e.length&&(n=x(e[0]),t=e[0].parentNode),!an(t,n))for(;"COLUMN-UNIT"!==t.nodeName&&(0==n?(n=x(t),t=t.parentNode):n--,!ln(t,n)););for(;0==n&&t.parentNode;)n=x(t),t=t.parentNode;if((e=_(et(r).concat(r)).filter(function(e){return k(e,"li")}).slice(-1)).length&&(o=1+x(e[0]),r=e[0].parentNode),!sn(r,o))for(;"COLUMN-UNIT"!==r.nodeName&&(o==I(r)?(o=1+x(r),r=r.parentNode):o++,!ln(r,o)););for(;o==I(r)&&r.parentNode;)o=1+x(r),r=r.parentNode;e=rr.rangy.createRange();return e.setStart(t,n),e.setEnd(r,o),t.childNodes[n]!==r.childNodes[n]&&t.childNodes[n]!==r||!t.childNodes[n]||t.childNodes[n].nodeType!==Node.ELEMENT_NODE||"COLUMN-UNIT"!=t.childNodes[n].nodeName||e.selectNodeContents(t.childNodes[n]),e}function Tn(){var e,t=at(w(O()),function(e){return F(e)&&!q(e)&&(M(e,["ol","ul"])||M(e.parentNode,["ol","ul"])||W(e,"li"))}),n=[];return t.forEach(function(e){"COLUMN-UNIT"===e.nodeName?[].forEach.call(e.childNodes,function(e){n.push(e)}):n.push(e)}),(t=n).length?_(t).every(function(e){return k(e,"ol")||k(e.parentNode,"ol")||k(e.parentNode,"li")&&k(e.parentNode.parentNode,"ol")})&&!_(t).some(function(e){return k(e,"ul")||e.querySelector&&e.querySelector("ul")})?"ol":_(t).every(function(e){return k(e,"ul")||k(e.parentNode,"ul")||k(e.parentNode,"li")&&k(e.parentNode.parentNode,"ul")})&&!_(t).some(function(e){return k(e,"ol")||e.querySelector&&e.querySelector("ol")})?"ul":(e=_(t).some(function(e){return k(e,"ol")||k(e.parentNode,"ol")||e.querySelector&&e.querySelector("ol")||k(e.parentNode,"li")&&k(e.parentNode.parentNode,"ol")}),t=_(t).some(function(e){return k(e,"ul")||k(e.parentNode,"ul")||e.querySelector&&e.querySelector("ul")||k(e.parentNode,"li")&&k(e.parentNode.parentNode,"ul")}),e&&t?"mixed":e?"mixed ol":t?"mixed ul":"none"):"none"}function N(e){for(;e&&e.nodeType!=Node.ELEMENT_NODE||e.nodeType==Node.ELEMENT_NODE&&-1!=["inline","none"].indexOf(_.getComputedStyle(e).display);)e=e.parentNode;var t;return e&&e.nodeType==Node.ELEMENT_NODE?"start"==(t=_.getComputedStyle(e).textAlign.replace(/^-(moz|webkit)-/,"").replace(/^auto$/,"start"))?"ltr"==nt(e)?"left":"right":"end"==t?"ltr"==nt(e)?"right":"left":-1!=["center","justify","left","right"].indexOf(t)?t:"left":"left"}function On(e,t){var n,r,o,i=_(j(t)).filter(function(e){return F(e)&&e.nodeType==Node.TEXT_NODE})[0];function a(e){return F(e)&&e.nodeType==Node.TEXT_NODE}if(i)for(n=0;n<e.length;n++)r=e[n][0],("boolean"==typeof(o=e[n][1])&&gt(r,t)!=o||"string"==typeof o&&!Gt(r,Nt(r,t),o))&&(pt(r,!1,o,t),i=_(j(t)).filter(a)[0]||i);else for(n=0;n<e.length;n++)r=e[n][0],"boolean"==typeof(o=e[n][1])&&Pe(r,o,t),"string"==typeof o&&Fe(r,o,t)}function Sn(e){F(e)||H(e)}function Rn(e,t){if(!e||!e.parentNode||!t||H(e)||!e.ownerDocument.contains(e))return!1;if(0<e.childNodes.length)for(var n=0,r=0;r<e.childNodes.length;r++)if("BR"===e.childNodes[r].nodeName){if(2<++n)return!1}else if(!q(e.childNodes[r]))return!1;return 0<e.childNodes.length?rr.helpers.unwrap(e,!0,t):wn(e,t),!0}function wn(e,t){var n,r;e&&e.parentNode&&t&&!H(e)&&(n=x(e),r=e.parentNode,t.collapsed?(r.removeChild(e),t.setStart(r,n),t.setEnd(r,n)):(t.startContainer===e?t.setStartBefore(e):t.startContainer===e.parentNode&&0<t.startOffset&&n<=t.startOffset&&t.setStart(t.startContainer,Math.min(t.startOffset-1,t.startContainer.childNodes.length)),t.endContainer===e?t.setEndAfter(e):t.endContainer===e.parentNode&&0<t.endOffset&&n<t.endOffset&&t.setEnd(t.endContainer,Math.min(t.endOffset-1,t.endContainer.childNodes.length)),r.removeChild(e)))}function A(e,t,n,r,o){var i,a={},e=(arguments.length<3?i=e:((i=rr.rangy.createRange()).setStart(e,t),i.setEnd(n,r)),2==arguments.length&&(a=t),null==(a=5==arguments.length?o:a).blockMerging||!!a.blockMerging),s=null==a.stripWrappers||!!a.stripWrappers,n=null!=a.stripLinks&&!!a.stripLinks;if(i){for(var l,d=i.startContainer,c=i.startOffset,u=i.endContainer,f=i.endOffset;d.hasChildNodes();)if(c==I(d)&&V(d,d.parentNode)&&U(d))c=1+x(d),d=d.parentNode;else{if(c==I(d))break;if(B(l=d.childNodes[c])||l.nodeType==Node.ELEMENT_NODE&&!l.hasChildNodes()||l.nodeType!=Node.ELEMENT_NODE&&l.nodeType!=Node.TEXT_NODE)break;d=l,c=0}for(;u.hasChildNodes();)if(0==f&&V(u,u.parentNode)&&U(u))f=x(u),u=u.parentNode;else{if(0==f)break;if(B(l=u.childNodes[f-1])||l.nodeType==Node.ELEMENT_NODE&&!l.hasChildNodes()||l.nodeType!=Node.ELEMENT_NODE&&l.nodeType!=Node.TEXT_NODE)break;f=I(u=l)}if("after"!==rt(u,f,d,c))i.setEnd(i.startContainer,i.startOffset);else{u.nodeType==Node.TEXT_NODE&&f==I(u)&&d!=u&&(f=1+x(u),u=u.parentNode),i.setStart(d,c),i.setEnd(u,f);for(var h=i.startContainer;V(h,h.parentNode)&&U(h);)h=h.parentNode;(B(h)||H(h))&&W("span",h)&&!M(h,["td","th"])||(h=null);for(var p=i.endContainer;V(p,p.parentNode)&&U(p);)p=p.parentNode;(B(p)||H(p))&&W("span",p)&&!M(p,["td","th"])||(p=null);N=[],(m=_(j(g=i)).filter(function(e){return F(e)&&e.nodeType==Node.TEXT_NODE})[0])&&(N.push(["createlink",L.createlink.value(g)]),_(["bold","italic","small","strikethrough","subscript","superscript","underline"]).forEach(function(e){-1!=_(L[e].inlineCommandActivatedValues).indexOf(K(m,e))?N.push([e,!0]):N.push([e,!1])}),_(["forecolor","hilitecolor"]).forEach(function(e){N.push([e,L[e].value(g)])}));var g,N,m,v,E,r=N;if(d==u&&F(d)&&d.nodeType==Node.TEXT_NODE){if(E=(v=d.parentNode).parentNode,d.deleteData(c,f-c),0===d.data.length)for(var C=d.previousSibling;C;){if(C.nodeType===Node.ELEMENT_NODE||C.nodeType===Node.TEXT_NODE&&!q(C)){i.setStartAfter(C),i.setEndAfter(C);break}C=C.previousSibling}0<c&&" "===d.data.substr(c-1,1)&&c<d.data.length&&" "===d.data.substr(c,1)&&d.replaceData(c-1,1," ");t=d.data.length;for(Sn(d),0<t-d.data.length&&(c-=t-d.data.length,i.setStart(i.startContainer,c)),U(v)&&(!1==s||Rn(v,i))&&(!1==n||"A"!==v.nodeName||Rn(v,i))||(i.setStart(i.startContainer,i.startOffset>i.startContainer.length?i.startContainer.length:i.startOffset),i.setEnd(i.startContainer,i.startOffset>i.startContainer.length?i.startContainer.length:i.startOffset)),v&&"A"===v.nodeName&&!v.ownerDocument.contains(v)&&(r=r.filter(function(e){return"createlink"!==e[0]}));null!==E;){var y=E.parentNode;if(!1===Rn(E,i)){document.contains(i.startContainer)?(i.setStart(i.startContainer,i.startOffset>i.startContainer.length?i.startContainer.length:i.startOffset),i.setEnd(i.startContainer,i.startOffset>i.startContainer.length?i.startContainer.length:i.startOffset)):i.selectNodeContents(E);break}E=y}for(On(r,i),!1!=s&&"LI"!==v.nodeName&&vn(v,i);v&&!1!=s&&!H(v)&&"COLUMN-UNIT"!==v.nodeName&&"COLUMN-SET"!==v.nodeName;){var b=v.parentNode;Rn(v,i),v=b}}else{F(d)&&d.nodeType==Node.TEXT_NODE&&d.deleteData(c,I(d)-c);for(var T,O,S=at(i,function(e){return(!!Ee||F(e))&&!M(e,["thead","tbody","tfoot","tr","th","td"])}),R=0;R<S.length;R++){var w=S[R];if(!H(w)){if((v=w.parentNode).removeChild(w),s||!Qe(v,d)&&v!=d)for(;F(v)&&U(v)&&0==I(v);){var A=v.parentNode;A.removeChild(v),v=A}!F(v)&&!H(v)||U(v)||mn(v)}}if(F(u)&&u.nodeType==Node.TEXT_NODE&&u.deleteData(0,f),!U(d.parentNode)||!1==s&&d.parentNode===i.commonAncestorContainer||Rn(d.parentNode,i),Sn(i.startContainer,i.startOffset),Sn(i.endContainer,i.endOffset),e&&h&&p&&V(h,p)&&h!=p){if(1==h.children.length&&At(h.firstChild)&&h.removeChild(h.firstChild),1==p.children.length&&At(p.firstChild)&&p.removeChild(p.firstChild),Qe(h,p)){for(l=p;l.parentNode!=h;)l=l.parentNode;if(i.setStart(h,x(l)),i.setEnd(h,x(l)),!p.hasChildNodes()){for(;null!=p.parentNode&&F(p)&&1==p.parentNode.childNodes.length&&p.parentNode!=h;)(v=p).removeChild(p),p=v;return F(p)&&!U(p)&&U(p.previousSibling)&&U(p.nextSibling)&&p.parentNode.insertBefore(document.createElement("br"),p.nextSibling),F(p)&&p.parentNode.removeChild(p),On(r,i),P(i),i}if(!U(p.firstChild))return On(r,i),P(i),i;var D=[];for(D.push(p.firstChild);!k(D[D.length-1],"br")&&U(D[D.length-1].nextSibling);)D.push(D[D.length-1].nextSibling);for(O=Zt(D);F(D[0].parentNode)&&D[0].parentNode!=h;)un(D,i);F(D[0].previousSibling)&&k(D[0].previousSibling,"br")&&D[0].parentNode.removeChild(D[0].previousSibling)}else if(Ze(h,p)){for(i.setStart(h,I(h)),i.setEnd(h,I(h)),l=h;l.parentNode!=p;)l=l.parentNode;U(l.nextSibling)&&k(h.lastChild,"br")&&h.removeChild(h.lastChild);o=[];!l.nextSibling||k(l.nextSibling,"br")||B(l.nextSibling)||o.push(l.nextSibling),o.length&&o[o.length-1].nextSibling&&!k(o[o.length-1].nextSibling,"br")&&!B(o[o.length-1].nextSibling)&&o.push(o[o.length-1].nextSibling),O=Zt(o),_(o).forEach(function(e){X(e,h,-1,i)}),k(l.nextSibling,"br")&&l.parentNode.removeChild(l.nextSibling)}else{for(i.setStart(h,I(h)),i.setEnd(h,I(h)),U(p.firstChild)&&k(h.lastChild,"br")&&h.removeChild(h.lastChild),O=Zt([].slice.call(Ge(p.childNodes)));p.hasChildNodes();)X(p.firstChild,h,-1,i);for(;!p.hasChildNodes();)(v=p.parentNode).removeChild(p),p=v}on(O,i),Dt(h)&&(T=xt(h),i.setStart(T.node,T.offset),i.setEnd(T.node,T.offset),h=T.node),mn(h),On(r,i)}else i.collapse(),Dt(a=h||p)&&(T=xt(a),i.setStart(T.node,T.offset),i.setEnd(T.node,T.offset)),On(r,i),!1===H(a)&&Re(a)&&"COLUMN-UNIT"==!a.nodeName&&null!==a.parentNode&&(i.setStartBefore(a),i.setEndBefore(a),a.parentNode,a.parentNode.removeChild(a),a=a.parentNode)}}return P(i),i}}function An(e,t,n){e.hasChildNodes()?un([].slice.call(Ge(e.childNodes)),t,n):null!==e.parentNode&&e.parentNode.removeChild(e)}function Dn(e,i){e&&([].forEach.call(e.querySelectorAll("ul,ol,li"),function(e){[].forEach.call(e.childNodes,function(e){var t,n,r,o;q(t=e)&&("UL"===t.parentNode.nodeName||"OL"===t.parentNode.nodeName||("LI"===t.parentNode.nodeName?(n=x(t),r=t.parentNode.childNodes.length-1,o=be.concat(Te),(0===n||-1<o.indexOf(t.previousSibling.nodeName.toLowerCase()))&&(n===r||-1<o.indexOf(t.nextSibling.nodeName.toLowerCase()))):void 0))&&(n=x(e),i.startContainer===e.parentNode&&i.startOffset>n?i.startOffset--:i.startContainer===e&&(i.startContainer=e.parentNode,i.startOffset=n),i.endContainer===e.parentNode&&i.endOffset>n?i.endOffset--:i.endContainer===e&&(i.endContainer=e.parentNode,i.endOffset=n),e.remove())})}),i.setStart(i.startContainer,i.startOffset),i.setEnd(i.endContainer,i.endOffset))}function xn(e,t){var n,r;e.length&&(M((n=e[0]).parentNode,["OL","UL"])?(r=n.parentNode.tagName,Ut(e,function(e){return M(e,r)},function(){return n.ownerDocument.createElement(r)},t)):R(Ut(e,function(e){return!1},function(){return n.ownerDocument.createElement("blockquote")},t),t))}function _n(e,t){if(F(e)){for(var n=e.parentNode,r=[];F(n)&&n.nodeType==Node.ELEMENT_NODE&&!M(n,["ol","ul"]);)r.push(n),n=n.parentNode;for(F(n),n=e.parentNode,r=[];F(n)&&n.nodeType==Node.ELEMENT_NODE&&!M(n,["ol","ul"]);)r.push(n),n=n.parentNode;if(M(e,["OL","UL"])&&(F(n),1)){e.removeAttribute("reversed"),e.removeAttribute("start"),e.removeAttribute("type");var o,i,a=[].slice.call(Ge(e.childNodes));for(e.attributes.length&&!M(e.parentNode,["OL","UL"])?It(e,"div",t):(o=Zt([].slice.call(Ge(e.childNodes))),An(e,t),on(o,t)),i=0;i<a.length;i++)R(a[i],t)}else F(n)}}function Ln(r,o){for(var e=Tn()==r?"disable":"enable",t="OL"==(r=r.toUpperCase())?"UL":"OL",n=[],i=o.endContainer;i!=o.commonAncestorContainer;i=i.parentNode)k(i,"li")&&n.unshift(i);for(i=o.startContainer;i;i=i.parentNode)k(i,"li")&&n.unshift(i);_(n).forEach(function(e){Cn(e,o)});var a,s,l=w(o),d=("enable"==e&&_(C(l,function(e){return F(e)&&k(e,t)})).forEach(function(e){var t,n;F(e.previousSibling)&&k(e.previousSibling,r)||F(e.nextSibling)&&k(e.nextSibling,r)?(n=Zt(t=[].slice.call(Ge(e.childNodes))),un(t,o),Ut(t,function(e){return k(e,r)},function(){return null},o),on(n,o)):It(e,r,o)}),at(l,function(e){return F(e)&&(M(e,["OL","UL"])||M(e.parentNode,["OL","UL"])||W(e,"li"))})),c=[];function u(){return document.createElement("li")}function f(e){return M(e,["ol","ul"])}function h(t){return function(e){return M(e,t)}}if(d.forEach(function(e){"COLUMN-UNIT"===e.nodeName?[].forEach.call(e.childNodes,function(e){c.push(e)}):c.push(e)}),1<(d=c).length&&d[d.length-1].nodeType===Node.TEXT_NODE&&S(d[d.length-1])&&d.pop(),"enable"==e&&(d=_(d).filter(function(e){return!M(e,["ol","ul"])||M(e.parentNode,["ol","ul"])})),"disable"==e)for(;d.length;)if((a=[]).push(d.shift()),M(a[0],r))_n(a[0],o);else{for(;d.length&&d[0]==a[a.length-1].nextSibling&&!M(d[0],r);)a.push(d.shift());var p,g=Zt(a);for(un(a,o),p=0;p<a.length;p++)R(a[p],o);on(g,o)}else for(;d.length;){for(a=[];!a.length||d.length&&d[0]==a[a.length-1].nextSibling;)if(M(d[0],["li","ol","ul"]))a.push(d.shift());else{if(0===d.length)break;for(var N=[];!N.length||d.length&&d[0]==N[N.length-1].nextSibling&&U(d[0])&&U(N[N.length-1])&&!k(N[N.length-1],"br");)N.push(d.shift());a.push(Ut(N,void 0,u,o))}0===a.length||M(a[0].parentNode,r)||_(a).every(f)||(M(a[0].parentNode,t)?(g=Zt(a),un(a,o),Ut(a,h(r),function(e){return function(){return document.createElement(e)}}(r),o),on(g,o),a.forEach(function(e){S(e)&&e.parentNode.removeChild(e)})):(R(s=Ut(a,h(r),function(e,t){return function(){return F(t[0].parentNode)&&fn(t[0].parentNode),document.createElement(e)}}(r,a),o),o),1===s.children.length&&S(s.children[0])&&s.children[0].appendChild(document.createElement("br")),a.forEach(function(e){null!==e.parentNode.nextElementSibling&&"COLUMN-UNIT"==e.parentNode.nextElementSibling.nodeName&&X(e.parentNode,e.parentNode.nextElementSibling,-1,o),S(e)&&e.parentNode.removeChild(e)})))}}function kn(t,e){for(var n=C(w(e),function(e){return e.nodeType==Node.ELEMENT_NODE&&F(e)&&(s(e,"align")||""!=e.style.textAlign||k(e,"center"))}),r=0;r<n.length;r++){var o=n[r];o.removeAttribute("align"),(o.style.textAlign="")==o.getAttribute("style")&&o.removeAttribute("style"),M(o,["div","span","center"])&&!o.attributes.length&&An(o,e),k(o,"center")&&o.attributes.length&&It(o,"div",e)}var i=[];for(i=at(w(g),function(e){return F(e)&&W(e,"div")&&N(e)!=t});i.length;){var a=[];for(a.push(i.shift());i.length&&i[0]==a[a.length-1].nextSibling;)a.push(i.shift());Ut(a,function(n){return function(t){return k(t,"div")&&_(t.attributes).every(function(e){return"align"==e.name&&e.value.toLowerCase()==n||"style"==e.name&&1==ze(t)&&t.style.textAlign==n})}}(t),function(t){return function(){var e=document.createElement("div");return e.setAttribute("style","text-align: "+t),e}}(t),e)}}function Mn(e,t){if(e.attributes.length===t.attributes.length){for(var n,r,o=e.attributes,i=0;i<o.length;i++)if(n=o[i],null===(r=t.attributes.getNamedItem(n.name))||n.value!==r.value)return;return 1}}function In(e){Bn(e),Pn(e);if(void 0!==e&&!1===e.collapsed){if(e.endContainer.nodeType===Node.ELEMENT_NODE&&(0===e.endOffset||e.endOffset>=e.endContainer.childNodes.length)){var t=j(e);t.sort(function(e,t){return e===t?0:t.compareDocumentPosition(e)&Node.DOCUMENT_POSITION_FOLLOWING?1:-1});for(var n=t.length-1;0<=n;n--)if(!S(t[n])){t[n].nodeType===Node.TEXT_NODE?e.setEnd(t[n],t[n].length):e.setEndAfter(t[n]);break}}else if(e.commonAncestorContainer.nodeType===Node.ELEMENT_NODE&&e.endContainer.nodeType===Node.TEXT_NODE&&0===e.endOffset){for(var r=Ye(e.endContainer);r;){if(r===e.commonAncestorContainer){r=e.endContainer;break}if(!q(r)&&r.nodeType===Node.TEXT_NODE||"MEDIA-ITEM"===r.nodeName||"TEXT-ICON"===r.nodeName||"DIGITAL-CLOCK"===r.nodeName)break;r=Ye(r)}r&&r!==e.endContainer&&e.commonAncestorContainer.contains(r)&&e.setEndAfter(r)}if(e.startContainer.nodeType===Node.ELEMENT_NODE){var o=j(e);o.sort(function(e,t){return e===t?0:e.compareDocumentPosition(t)&Node.DOCUMENT_POSITION_CONTAINS?-1:1});for(n=0;n<o.length;n++)if(!S(o[n])){o[n].nodeType===Node.TEXT_NODE?e.setStart(o[n],0):e.setStartBefore(o[n]);break}}else if(e.commonAncestorContainer.nodeType===Node.ELEMENT_NODE&&e.startContainer.nodeType===Node.TEXT_NODE&&e.startOffset===e.startContainer.length){for(var i=E(e.startContainer);i;){if(i===e.commonAncestorContainer){i=e.startContainer;break}if(!q(i)&&i.nodeType===Node.TEXT_NODE||"MEDIA-ITEM"===i.nodeName||"TEXT-ICON"===i.nodeName||"DIGITAL-CLOCK"===i.nodeName)break;i=E(i)}i&&i!==e.startContainer&&e.commonAncestorContainer.contains(i)&&e.setStartBefore(i)}}return e}function Pn(e){return e.startContainer.nodeType===Node.ELEMENT_NODE&&e.startContainer.childNodes[e.startOffset]?e.startContainer.childNodes[e.startOffset]:e.startContainer}function Bn(e){return e.endContainer.nodeType===Node.ELEMENT_NODE?e.endContainer.childNodes[Math.max(0,e.endOffset-1)]:e.endContainer}function Un(e,t){return q(e)||!i(e)||t&&"BR"===e.nodeName}function Hn(e,t){if(void 0!==e){var n=Pn(e),r=!1;if(!H(n))for(;n&&null!==n.parentNode&&!H(n.parentNode);){for(var o=n.parentNode.firstChild;o!==n&&o.nextSibling&&Un(o);)o=o.nextSibling;if(r=n===o,!(r=n===e.startContainer&&e.startContainer.nodeType===Node.TEXT_NODE&&0<e.startContainer.data.substring(0,e.startOffset).replace(/\s/g,"").length?!1:r))break;if(n.parentNode&&("COLUMN-UNIT"===n.parentNode.nodeName||"COLUMN-SET"===n.parentNode.nodeName))break;n=n.parentNode,r&&!H(n)&&e.setStartBefore(n)}var i=Bn(e),a=!1;if(!H(i))for(;i&&null!==i.parentNode&&!H(i.parentNode);){for(var s=i.parentNode.lastChild;s!==i&&s.previousSibling&&Un(s);)s=s.previousSibling;if(a=i===s,!(a=i===e.endContainer&&e.endContainer.nodeType===Node.TEXT_NODE&&0<e.endContainer.data.substring(e.endOffset).replace(/\s/g,"").length?!1:a))break;if(i.parentNode&&("COLUMN-UNIT"===i.parentNode.nodeName||"COLUMN-SET"===i.parentNode.nodeName))break;i=i.parentNode,a&&!H(i)&&e.setEndAfter(i)}}return e}function Fn(e,t){return _(j(e)).some(function(e){if(e===t||!t.contains(e))return!1;for(;null!==e.parentNode&&(e=e.parentNode)!==t;)if(B(e))return!0})}function Vn(e){if(e){var t=(e=e.getNodes?e:rr.rangy.WrappedRange(e)).getNodes(Node.ELEMENT_NODE,function(e){return e.shadowRoot});if(0===t.length)return!0;for(var n=!1,r=!1,o=Ye(t[0]);o&&e.containsNode(o);)o=(o.contains(t[0])||S(o)||(n=!0),Ye(o));for(var i=E(t[t.length-1]);i&&e.containsNode(i);)i=(i.contains(t[0])?Ye:(S(i)||(r=!0),E))(i);return n&&r}}function qn(e){var n=[];return function t(e){U(e)?n.push(e):[].forEach.call(function(e){for(;1===e.childNodes.length&&e.childNodes[0].nodeType!=Node.TEXT_NODE;)e=e.childNodes[0];return 0===e.childNodes.length?[e]:e.childNodes}(e),function(e){"DIV"===e.nodeName&&0<e.childNodes.length?t(e):n.push(e)})}(e),n}function Xn(e,t){if(null==e)return!1;var n=(e=!0!==(t=t||{}).preventShrinkingRange?In(e):e).commonAncestorContainer,r=Fn(e,n),o=!1;if(n.nodeType!==Node.ELEMENT_NODE&&(o=!0,n=n.parentNode),!U(n)&&!t.attemptToBreakBlockParent||r||H(n)||"COLUMN-UNIT"===n.nodeName||"COLUMN-SET"===n.nodeName)e=(!o&&r?function(e){for(var t,n,r=e.startContainer,o=e.endContainer;null!==r.parentNode&&!B(r.parentNode)&&!H(r.parentNode);)r=r.parentNode;for(;null!==o.parentNode&&!B(o.parentNode)&&!H(r.parentNode);)o=o.parentNode;return H(o)||B(o)?e.endContainer.nodeType===Node.TEXT_NODE&&0!==e.endOffset&&e.endOffset!==e.endContainer.length&&(t=e.endContainer.splitText(e.endOffset)):0===e.endOffset||e.endOffset===e.endContainer.length||(t=bn(e.endContainer,e.endOffset,o)).nodeType!==Node.ELEMENT_NODE||S(t)||o.parentNode.insertBefore(t,o.nextSibling),H(r)||B(r)?e.startContainer.nodeType===Node.TEXT_NODE&&0!==e.startOffset&&e.startOffset!==e.startContainer.length&&(n=e.startContainer.splitText(e.startOffset)):0===e.startOffset||e.startOffset===e.startContainer.length||(n=bn(e.startContainer,e.startOffset,r)).nodeType!==Node.ELEMENT_NODE||S(n)||r.parentNode.insertBefore(n,r.nextSibling),null!==r.parentNode&&S(r)&&r.parentNode.removeChild(r),null!==o.parentNode&&S(o)&&o.parentNode.removeChild(o),n!==t&&(n&&(null!==n.parentNode?e.setStartBefore(n):null!==r.parentNode&&e.setStartAfter(r)),t)&&(null!==t.parentNode?e.setEndBefore(t):null!==o.parentNode&&e.setEndAfter(o)),e}:yn)(e);else{var i=e.extractContents(),a=n.cloneNode(),s=n.cloneNode(),l=n.ownerDocument.createTextNode("|");for(e.insertNode(l);null!==l.nextSibling;)a.appendChild(l.nextSibling);for(l.parentNode.removeChild(l);0<i.childNodes.length;)s.appendChild(i.childNodes[0]);n.parentNode.insertBefore(s,n.nextSibling),S(a)||n.parentNode.insertBefore(a,s.nextSibling),Gn(n,e),s.previousElementSibling&&s.previousElementSibling.nodeName===s.nodeName&&Gn(s.previousElementSibling,e),s.nextElementSibling&&s.nextElementSibling.nodeName===s.nodeName&&Gn(s.nextElementSibling,e),e.selectNodeContents(s)}return e}function Wn(e,t){for(var n=0;n<e.length;n++){var r=e[n],o=(r.removeAttribute("align"),r.getAttribute("style"));(r.style.textAlign="")==r.getAttribute("style")&&(r.setAttribute("style",null),r.removeAttribute("style")),M(r,["div","span","center"])&&!r.attributes.length&&(void 0!==t?An(r,t,!0):rr.helpers.unwrap(r),r.setAttribute("style",o)),k(r,"center")&&r.attributes.length&&It(r,"div",t)}}function jn(e){return e.nodeType==Node.ELEMENT_NODE&&F(e)&&(s(e,"align")||""!=e.style.textAlign||k(e,"center"))}function Kn(e){for(var t=[],n=(e=e.nodeType!==Node.ELEMENT_NODE?e.parentNode:e).textContent;null!==e&&!1===H(e)&&e.textContent===n;){if(jn(e)){-1===t.indexOf(e)&&t.push(e);break}e=e.parentNode}return t}function zn(t,e){var n=Xn(e=Hn(e),{attemptToBreakBlockParent:0<Kn(e.commonAncestorContainer).length}),r=(null==o&&(o=j(n,jn)),Kn(e.commonAncestorContainer)),o=o.concat(r),i=(jn(n.startContainer)&&-1===o.indexOf(n.startContainer)&&o.push(n.startContainer),jn(n.endContainer)&&-1===o.indexOf(n.endContainer)&&o.push(n.endContainer),Wn(o,e),[]);jt(n,function(e){return F(e)&&W(e,"div")&&N(e)!=t}).forEach(function(e){i=i.concat(qn(e))});for(var a,s,l=[];i.length;){var d,c=[];for(c.push(i.shift());i.length&&i[0]==c[c.length-1].nextSibling;)c.push(i.shift());1===c.length&&S(c[0])||(d=Ut(c,function(n){return function(t){return k(t,"div")&&0<t.attributes.length&&_(t.attributes).every(function(e){return"align"==e.name&&e.value.toLowerCase()==n||"style"==e.name&&1==ze(t)&&t.style.textAlign==n})}}(t),function(t){return function(){var e=document.createElement("div");return e.setAttribute("style","text-align: "+t),e}}(t),e,!0),l.push(d))}l.reverse(),[].forEach.call(l,function(e){if(S(e))or.unwrap(e,!0,n);else if(null!==(a=e))for(;null!==(a=a.parentNode);)-1!==(s=l.indexOf(a))&&Mn(e,l[s])&&or.unwrap(e,!0,n)}),l.reverse(),[].forEach.call(l,function(e){null!==e&&R(e,n)})}function Gn(t,n){(S(t)?(Array.from(t.childNodes).forEach(function(e){e.nodeType===Node.TEXT_NODE&&0<e.data.length&&X(e,t.parentNode,x(t),n)}),wn):Rn)(t,n)}L.delete={action:function(e,t){if(!t.collapsed){In(t);var n=!0,r=t.startContainer.nodeType===Node.ELEMENT_NODE?t.startContainer.childNodes[t.startOffset]:t.startContainer,o=t.endContainer.nodeType===Node.ELEMENT_NODE?t.endContainer.childNodes[t.endOffset]:t.endContainer;if(null==o&&(o=t.endContainer),r&&o&&t.startContainer.nodeType===Node.TEXT_NODE&&!1===Rt(t.startContainer)){for(var i=[r],a=[o],s=r;null!==(s=s.parentNode)&&s!==t.commonAncestorContainer;)i.push(s);for(s=o;null!==(s=s.parentNode)&&s!==t.commonAncestorContainer;)a.push(s);i.reverse(),a.reverse(),i[0].nodeName!==a[0].nodeName&&(n=!1),"COLUMN-UNIT"===i[0].nodeName&&"COLUMN-UNIT"===a[0].nodeName&&(n=!1)}var l=A(t,{blockMerging:n});return r===o?void 0:(document.contains(r)?(t.setStartAfter(r),t.setEndAfter(r)):document.contains(o)&&(t.setStartBefore(o),t.setEndBefore(o)),void P(t))}Sn(t.startContainer,t.startOffset);var d=t.startContainer,c=t.startOffset,u=!1,f=!1;if("OL"===d.nodeName||"UL"===d.nodeName||"LI"===d.nodeName&&0===c)console.log("native delete for ul"),document.execCommand("delete");else{for(;;){if(0===c&&d.nodeType===Node.ELEMENT_NODE&&null!==d.shadowRoot)return void d.parentNode.removeChild(d);if(0<c&&(u=k(d.childNodes[c-1],"br")||!1,f=k(d.childNodes[c-1],"hr")||!1),0==c&&F(d.previousSibling)&&wt(d.previousSibling))d.parentNode.removeChild(d.previousSibling),c=x(d),d=d.parentNode;else if(0<=c-1&&c-1<d.childNodes.length&&F(d.childNodes[c-1])&&(wt(d.childNodes[c-1])||u||f)){if(d.removeChild(d.childNodes[c-1]),c--,u||f)return t.setStart(d,c),void t.setEnd(d,c)}else{if(void 0!==d.childNodes[c-1]&&!F(d.childNodes[c-1])){var h,p=d.childNodes[c-1];for(p.nodeType!==Node.ELEMENT_NODE&&(p=d.childNodes[c-1].parentNode);null!==p&&p!==d.childNodes[c-1].ownerDocument;){if(p.hasAttribute("contenteditable")&&"false"==p.getAttribute("contenteditable")){h=p;break}p=p.parentNode}if(void 0!==h&&null!==h.parentNode)return p.parentNode.removeChild(p),void c--}if(0==c&&U(d)||wt(d))c=x(d),d=d.parentNode;else{if(!(0<=c-1&&c-1<d.childNodes.length&&F(d.childNodes[c-1])&&k(d.childNodes[c-1],"a"))&&(!(0<=c-1&&c-1<d.childNodes.length)||B(d.childNodes[c-1])||M(d.childNodes[c-1],["br","img"])))break;c=I(d=d.childNodes[c-1])}}}if("OL"===d.nodeName||"UL"===d.nodeName||"LI"===d.nodeName&&0===c)S(d)?(r=d.previousSibling,vn(d,t),r&&"LI"===r.nodeName&&(t.selectNodeContents(r),t.collapse(!1),P(t))):document.execCommand("delete");else if(d.nodeType==Node.TEXT_NODE&&0!=c){for(var g=new RegExp(me,"gu");null!==(m=g.exec(d.data));){var N=m.index,m=m.index+m[0].length;if(N<=c&&c<=m)return console.log("native delete for emoji"),void document.execCommand("delete")}var v=1,o=d.data.substring(0,c),r=/[\s]+$/.exec(o);for(null!==r&&(o=r[0].lastIndexOf(" "),1<r[0].length)&&(v=r[0].length,-1!==o)&&0<v-o&&(v-=o);v<=c&&/^\uFE0E$/.test(d.data[c-v]);)v++;t.setStart(d,c-v),t.setEnd(d,c-v),(r=A(d,c-v,d,c))&&(t.setStart(r.startContainer,r.startOffset),t.setEnd(r.endContainer,r.endOffset))}else if(U(d))console.log("native delete for inline node"),document.execCommand("delete");else if(0<=c-1&&c-1<d.childNodes.length&&M(d.childNodes[c-1],["br","hr","img"]))t.setStart(d,c-1),t.setEnd(d,c),A(t);else if(M(d,["li","dt","dd"])&&d==d.parentNode.firstChild&&0==c){for(var E=[],C=d.parentNode;C;C=C.parentNode)k(C,"li")&&E.unshift(C);for(O=0;O<E.length;O++)Cn(E[O],t);o=Zt([d]);for(un([d],t),on(o,t),R(d=M(d,["dd","dt"])&&_(et(d)).every(function(e){return!V(d,e)||!W(d,e)})?It(d,gn,t):d,t),O=0;O<E.length;O++)!function(e,t){M(e,["OL","UL"])&&F(e)&&[].forEach.call(e.querySelectorAll("ol,ul"),function(e){k(e.previousSibling,"LI")&&X(e,e.previousSibling,e.previousSibling.childNodes.length,t)})}(E[O].parentNode,t)}else{for(var y=d,b=c;;)if(0==b)b=x(y),y=y.parentNode;else{if(!(0<=b-1&&b-1<y.childNodes.length&&F(y.childNodes[b-1])&&wt(y.childNodes[b-1])))break;y.removeChild(y.childNodes[b-1]),b--}if(0==c&&_(et(d).concat(d)).filter(function(e){return F(e)&&V(e,d)&&!1}).length)for(var r=rr.rangy.createRange(),T=(r.setStart(d,0),r.setEnd(d,0),at(r=w(r),function(e){return F(e)&&!function e(t){for(var n=0;n<t.childNodes.length;n++)if(F(t.childNodes[n])||e(t.childNodes[n]))return 1}(e)})),O=0;O<T.length;O++)_n(T[O],t);else if(!k(y.childNodes[b],"table"))if(0<=b-1&&b-1<y.childNodes.length&&k(y.childNodes[b-1],"table"))t.setStart(y,b-1),t.setEnd(y,b);else if(0==c&&(k(y.childNodes[b-1],"hr")||k(y.childNodes[b-1],"br")&&(k(y.childNodes[b-1].previousSibling,"br")||!U(y.childNodes[b-1].previousSibling))))t.setStart(d,c),t.setEnd(d,c),A(y,b-1,y,b);else{if(M(y.childNodes[b],["li","dt","dd"])&&U(y.childNodes[b].firstChild)&&0!=b&&(U((o=y.childNodes[b-1]).lastChild)&&!k(o.lastChild,"br")&&o.appendChild(document.createElement("br")),U(o.lastChild))&&o.appendChild(document.createElement("br")),M(y.childNodes[b],["li","dt","dd"])&&M(y.childNodes[b-1],["li","dt","dd"]))b=I(y=y.childNodes[b-1]),d=y.nextSibling,c=0;else for(;0<=b-1&&b-1<y.childNodes.length;)F(y.childNodes[b-1])&&wt(y.childNodes[b-1])?(y.removeChild(y.childNodes[b-1]),b--):b=I(y=y.childNodes[b-1]);(l=rr.rangy.createRange()).setStart(y,b),l.setEnd(d,c);n=!0,l=A(l,{blockMerging:n=d.nodeType===Node.ELEMENT_NODE&&void 0!==d.childNodes[c]&&(d.childNodes[c].nodeType===Node.TEXT_NODE&&!1===Rt(d.childNodes[c])||d.childNodes[c].nodeType===Node.ELEMENT_NODE&&!1===Re(d.childNodes[c]))?!1:n});r=document.body,o=t.startContainer,!r&&!o||r!=o&&!Qe(r,o)?(l.startContainer.hasChildNodes()||l.startContainer.nodeType==Node.TEXT_NODE||H(l.startContainer)?(t.setStart(l.startContainer,l.startOffset),t.setEnd(l.startContainer,l.startOffset)):(t.setStart(l.startContainer.parentNode,x(l.startContainer)),t.setEnd(l.startContainer.parentNode,x(l.startContainer))),P(t)):null!==Tt(l.startContainer)&&(!0===n?(t.setStart(l.startContainer,l.startOffset),t.setEnd(l.startContainer,l.startOffset)):null!==Tt(y)&&(t.setStartAfter(y),t.setEndAfter(y)),P(t))}}}}};var $n,Yn,Qn,Zn=["address","dd","div","dt","h1","h2","h3","h4","h5","h6","p","pre","text-indent"];L.formatblock={action:function(e){if(e=(e=/^<.*>$/.test(e)?e.slice(1,-1):e).toLowerCase(),-1!=_(Zn).indexOf(e)){for(var t,n=w(O()),r=at(n,function(e){return F(e)&&(hn(e)||W(e,"p")||M(e,["dd","dt"]))&&!_(tt(e)).some(mt)}),o=Zt(r),i=0;i<r.length;i++)for(var a=r[i];_(et(a)).some(function(t){return function(e){return F(e)&&V(e,t)&&M(e,Zn)&&!_(tt(e)).some(mt)}}(a));)un([a],n);for(on(o,n);r.length;){if(pn(r[0]))o=Zt(t=[].slice.call(Ge(r[0].childNodes))),An(r[0],n),on(o,n),r.shift();else for((t=[]).push(r.shift());r.length&&r[0]==t[t.length-1].nextSibling&&!pn(r[0])&&!k(t[t.length-1],"BR");)t.push(r.shift());R(Ut(t,-1==["div","p"].indexOf(e)?function(t){return function(e){return M(e,t)&&!e.attributes.length}}(e):s,function(e){return function(){return document.createElement(e)}}(e),n),n)}}function s(){return!1}},indeterm:function(){var e=C(w(O()),function(e){return i(e)&&F(e)&&!e.hasChildNodes()});if(e.length)for(var t=null,n=0;n<e.length;n++){for(var r=e[n];F(r.parentNode)&&V(r,r.parentNode)&&!M(r,Zn);)r=r.parentNode;var o="";if(F(r)&&M(r,Zn)&&!_(tt(r)).some(mt)&&(o=r.tagName),null===t)t=o;else if(t!=o)return!0}return!1},value:function(){var e=C(w(O()),function(e){return i(e)&&F(e)&&!e.hasChildNodes()});if(!e.length)return"";for(var t=e[0];F(t.parentNode)&&V(t,t.parentNode)&&!M(t,Zn);)t=t.parentNode;return F(t)&&M(t,Zn)&&!_(tt(t)).some(mt)?t.tagName.toLowerCase():""}},L.forwarddelete={action:function(e,t){if(t.collapsed){Sn(t.startContainer,t.startOffset);var n=t.startContainer,r=t.startOffset;if(Re(n))t.setStart(n.parentElement,x(n)),t.setEnd(n.parentElement,t.startOffset+1),A(t);else{for(;;)if(r==I(n)&&F(n.nextSibling)&&wt(n.nextSibling))n.parentNode.removeChild(n.nextSibling);else if(r<n.childNodes.length&&F(n.childNodes[r])&&wt(n.childNodes[r]))n.removeChild(n.childNodes[r]);else if(r<n.childNodes.length&&At(n.childNodes[r]))r++;else if(r==I(n)&&U(n)||wt(n)){if(r=1+x(n),void 0!==(n=n.parentNode).childNodes[r]&&!F(n.childNodes[r])){var o,i=n.childNodes[r];for(i.nodeType!==Node.ELEMENT_NODE&&(i=n.childNodes[r].parentNode);null!==i&&i!==n.childNodes[r].ownerDocument;){if(i.hasAttribute("contenteditable")&&"false"==i.getAttribute("contenteditable")){o=i;break}i=i.parentNode}if(void 0!==o&&null!==o.parentNode){i.parentNode.removeChild(i),r--;break}}}else{if(!(r<n.childNodes.length)||B(n.childNodes[r])||M(n.childNodes[r],["br","img"]))break;n=n.childNodes[r],r=0}if(Sn(t.startContainer,t.startOffset),n.nodeType==Node.TEXT_NODE&&r!=I(n)){for(var a=new RegExp(me,"gu");null!==(l=a.exec(n.data));){var s=l.index,l=l.index+l[0].length;if(s<=r&&r<=l)return console.log("native delete for emoji"),void document.execCommand("forwarddelete")}for(t.setStart(n,r),t.setEnd(n,r),c=r+1;c!=n.length&&/^[\u0300-\u036f\u0591-\u05bd\u05c1\u05c2]$/.test(n.data[c]);)c++;for(;c!=n.length&&/^\uFE0E$/.test(n.data[c]);)c++;A(n,r,n,c)}else if(r<n.childNodes.length&&M(n.childNodes[r],["br","hr","img"]))t.setStart(n,r),t.setEnd(n,r),A(n,r,n,r+1);else if(!U(n)){for(var d=n,c=r;;)if(c==I(d))c=1+x(d),d=d.parentNode;else{if(!(c<d.childNodes.length&&F(d.childNodes[c])&&wt(d.childNodes[c])))break;d.removeChild(d.childNodes[c])}if(!k(d.childNodes[c-1],"table"))if(k(d.childNodes[c],"table"))t.setStart(d,c),t.setEnd(d,c+1);else if(r==I(n)&&M(d.childNodes[c],["br","hr"]))t.setStart(n,r),t.setEnd(n,r),A(d,c,d,c+1);else{for(;c<d.childNodes.length;)F(d.childNodes[c])&&wt(d.childNodes[c])?d.removeChild(d.childNodes[c]):(d=d.childNodes[c],c=0);var u=A(n,r,d,c);t.setStart(u.startContainer,u.startOffset),t.setEnd(u.endContainer,u.endOffset)}}}}else A(t)}},L.indent={action:function(){for(var e,t=[],n=O().endContainer;n!=O().commonAncestorContainer;n=n.parentNode)k(n,"LI")&&t.unshift(n);for(n=O().startContainer;n!=O().commonAncestorContainer;n=n.parentNode)k(n,"LI")&&t.unshift(n);for(n=O().commonAncestorContainer;n;n=n.parentNode)k(n,"LI")&&t.unshift(n);for(e=0;e<t.length;e++)Cn(t[e],O());var r=w(O()),o=[];for(at(r,function(e){return(e.nodeType!==Node.TEXT_NODE||!q(e))&&F(e)&&(W(e,"div")||W(e,"ol"))}).forEach(function(e){qn(e).forEach(function(e){-1!==o.indexOf(e)&&o.splice(o.indexOf(e),1),o.push(e)})}),o.length&&k(o[0],"LI")&&M(o[0].parentNode,["OL","UL"])&&k(o[0].previousSibling,"LI")&&Cn(o[0].previousSibling,r);o.length;){var i=[];for(i.push(o.shift());o.length&&o[0]==i[i.length-1].nextSibling;)i.push(o.shift());xn(i,r)}P(r)}},L.inserthorizontalrule={action:function(e,t){var n;t.collapsed||A(t,{blockMerging:!1}),(F(O().startContainer)||H(O().startContainer))&&(O().startContainer.nodeType==Node.TEXT_NODE&&0==O().startOffset&&(O().setStart(O().startContainer.parentNode,x(O().startContainer)),O().collapse(!0)),O().startContainer.nodeType==Node.TEXT_NODE&&O().startOffset==I(O().startContainer)&&(O().setStart(O().startContainer.parentNode,1+x(O().startContainer)),O().collapse(!0)),n=document.createElement("hr"),t.insertNode(n),R(n,t),t.setStart(n.parentNode,1+x(n)),t.setEnd(n.parentNode,1+x(n)),rr.rangy.getSelection().removeAllRanges(),rr.rangy.getSelection().addRange(t))}},L.inserthtml={action:function(e,t){var n=Tt(t.commonAncestorContainer),n=n?ye.applyRules(e,n):e;if(A(t),F(t.startContainer)||H(t.startContainer)){for(var r,o,e=t.createContextualFragment(n),i=e.childNodes,a=0;a<i.length;a++)if(i[a].nodeType===Node.ELEMENT_NODE)for(r=0,o=i[a].querySelectorAll("a").length;r<o;r++)console.log("link pasted");n=e.lastChild;if(n){var s,l=tt(e);for(B(t.startContainer)&&_(t.startContainer.childNodes).filter(function(e,t){return F(e)&&At(e)&&x(e)>=t.startOffset},!0).forEach(function(e){e.parentNode.removeChild(e)}),t.insertNode(e),B(t.startContainer)&&mn(t.startContainer),t.setStart(n.parentNode,1+x(n)),t.setEnd(n.parentNode,1+x(n)),s=0;s<l.length;s++)R(l[s],t);P(t)}}}},L.insertimage={action:function(e){var t,n;""!==e&&(A(t=O(),{stripWrappers:!1}),F(O().startContainer)||H(O().startContainer))&&(B(t.startContainer)&&1==t.startContainer.childNodes.length&&k(t.startContainer.firstChild,"br")&&0==t.startOffset&&t.startContainer.removeChild(t.startContainer.firstChild),(n=document.createElement("img")).setAttribute("src",e),t.insertNode(n),t.setStart(n.parentNode,1+x(n)),t.setEnd(n.parentNode,1+x(n)),rr.rangy.getSelection().removeAllRanges(),rr.rangy.getSelection().addRange(t),n.removeAttribute("width"),n.removeAttribute("height"))}},L.insertlinebreak={action:function(e,t){if(A(t,{stripWrappers:!1,stripLinks:!(Yn=null)}),(F(t.startContainer)||H(t.startContainer))&&(t.startContainer.nodeType!=Node.ELEMENT_NODE||W("br",t.startContainer))&&(t.startContainer.nodeType==Node.ELEMENT_NODE||W("br",t.startContainer.parentNode))){t.startContainer.nodeType==Node.TEXT_NODE&&0==t.startOffset&&(i=t.startContainer.parentNode,s=x(t.startContainer),rr.rangy.getSelection().collapse(i,s),t.setStart(i,s),t.setEnd(i,s)),t.startContainer.nodeType==Node.TEXT_NODE&&t.startOffset==I(t.startContainer)&&(i=t.startContainer.parentNode,s=1+x(t.startContainer),rr.rangy.getSelection().collapse(i,s),t.setStart(i,s),t.setEnd(i,s));var n=document.createElement("br"),r=(t.insertNode(n),!1),o=!1,i=!1;if($n){for(var a=n.previousSibling;a;){if(!q(a)){r=a===$n;break}a=a.previousSibling}if(!r)for(a=n.nextSibling;a;){if(!q(a)){r=a===$n;break}a=a.nextSibling}o=r&&(Lt(n)||Lt(n.nextElementSibling)),i=r&&(kt(n)||kt(n.previousElementSibling)),o&&i&&(null===$n.previousSibling&&null!==n.nextSibling?o=!1:i=!1)}else if(n.parentNode&&"A"===n.parentNode.nodeName){for(var s=n.parentNode,l=s.lastChild;l&&q(a);)l=l.previousSibling;l===n&&s.parentNode.insertBefore(n,s.nextSibling)}if(o||i)for(var d=n.parentNode;d&&d.parentNode&&!H(d)&&function(e){for(var t=e;(Lt(t)||kt(t))&&!["COLUMN-UNIT","COLUMN-SET"].includes(t.nodeName);){if(H(t.parentNode))return!0;t=t.parentNode}return!(!e||!["DIV","SPAN","H1","H2","H3","H4","H5","H6","A","I","B","U","S","SUB","SUP"].includes(e.nodeName))}(d);)o?d.parentNode.insertBefore(n,d.nextSibling):d.parentNode.insertBefore(n,d),Yn=n,d=d.parentNode;null!==n.nextSibling&&n.nextSibling.nodeType===Node.TEXT_NODE?"\n"!==n.nextSibling.data.charAt(0)&&(n.nextSibling.data="\n"+n.nextSibling.data):n.parentNode.insertBefore(n.ownerDocument.createTextNode("\n"),n.nextSibling);var c,s=$n;if(Ot($n=n)&&(c=document.createElement("br"),n.parentNode.insertBefore(c,n),null!==c.nextSibling&&c.nextSibling.nodeType===Node.TEXT_NODE?"\n"!==c.nextSibling.data.charAt(0)&&(c.nextSibling.data="\n"+c.nextSibling.data):c.parentNode.insertBefore(c.ownerDocument.createTextNode("\n"),c.nextSibling),Qn=c),Yn)s.nextSibling&&s.nextSibling.nodeType===Node.TEXT_NODE&&"\n"===s.nextSibling.data&&s.nextSibling.remove(),s.remove(),Qn&&(Qn.nextSibling&&Qn.nextSibling.nodeType===Node.TEXT_NODE&&"\n"===Qn.nextSibling.data&&Qn.nextSibling.remove(),Qn.remove()),t=rr.rangy.createRange(),o?t.setStartAfter(n.parentNode?n:c):t.setStartBefore(n.parentNode?n:c),t.collapse(),$n=Qn=void 0;else{clearTimeout(void 0),setTimeout(function(){$n=Qn=void 0},350);let e=n;n.nextSibling&&n.nextSibling.nodeType===Node.TEXT_NODE&&"\n"===n.nextSibling.data&&(e=n.nextSibling),(t=rr.rangy.createRange()).setStartAfter(e),t.collapse()}P(t)}}},L.insertorderedlist={action:function(e,t){Ln("ol",t)},indeterm:function(){return/^mixed( ol)?$/.test(Tn())},state:function(){return"ol"==Tn()}};var Jn={LI:!0,DT:!0,DD:!0};L.insertparagraph={action:function(e,t){if(A(t),Dn(Tt(t.startContainer),t),F(t.startContainer)||H(t.startContainer)){var n=Tt(t.commonAncestorContainer);if(n){for(var r,o,i=t.startContainer,a=t.startOffset,s=(i.nodeType==Node.TEXT_NODE&&0!=a&&a!=I(i)&&Me(i,a),i.nodeType==Node.TEXT_NODE&&a==I(i)&&(a=1+x(i),i=i.parentNode),i.nodeType!=Node.TEXT_NODE&&i.nodeType!=Node.COMMENT_NODE||(a=x(i),i=i.parentNode),rr.rangy.getSelection().collapse(i,a),t.setStart(i,a),t.setEnd(i,a),i);!pn(s)&&F(s.parentNode)&&V(i,s.parentNode);)s=s.parentNode;if(!F(s)||!V(s,i)||!pn(s)){if(!(n=Tt(s))||!ye.isAllowed(n,gn))return;var l=gn,d=at(w(t),function(e){return W(e,"p")}).slice(0,1);if(!d.length)return W(l,t.startContainer)?(s=document.createElement(l),t.insertNode(s),s.appendChild(Nn()),rr.rangy.getSelection().collapse(s,0),t.setStart(s,0),void t.setEnd(s,0)):void 0;for(;d[d.length-1].nextSibling&&W(d[d.length-1].nextSibling,"p");)d.push(d[d.length-1].nextSibling);s=Ut(d,function(){return!1},function(){return document.createElement(l)},t)}if(s){if("ADDRESS"==s.tagName||"LISTING"==s.tagName||"PRE"==s.tagName)return ye.isAllowed(n,"br")?(p=document.createElement("br"),o=s.offsetHeight,t.insertNode(p),r=s.offsetHeight,rr.rangy.getSelection().collapse(i,a+1),t.setStart(i,a+1),t.setEnd(i,a+1),void(o!=r||Ze(E(p),s)||(t.insertNode(Nn()),rr.rangy.getSelection().collapse(i,a+1),t.setEnd(i,a+1)))):void 0;if(Jn[s.tagName]&&(!s.hasChildNodes()||1==s.childNodes.length&&k(s.firstChild,"br"))){if(un([s],t),R(s=M(s,["dd","dt"])&&_(et(s)).every(function(e){return!V(s,e)||!W(s,e)})?It(s,gn,t):s,t),k(s,"li")&&k(s.nextSibling,"li")&&M(s.nextSibling.firstChild,["ol","ul"])){for(var c=s.nextSibling,u=s.nextSibling.childNodes.length,f=0;f<u;f++)s.appendChild(c.childNodes[0]);c.parentNode.removeChild(c)}}else if(k(s,"p")&&k(s.parentNode,"blockquote")&&!s.nextSibling&&(!s.hasChildNodes()||1===s.childNodes.length&&k(s.firstChild,"br")))s.parentNode.insertAdjacentElement("afterend",s);else{var h=rr.rangy.createRange();for(h.setStart(t.startContainer,t.startOffset),h.setEnd(s,I(s));0==h.startOffset&&h.startContainer!=s;)h.setStart(h.startContainer.parentNode,x(h.startContainer));for(;h.startOffset==I(h.startContainer)&&h.startContainer!=s;)h.setStart(h.startContainer.parentNode,1+x(h.startContainer));var p=at(h),a=!p.length||1==p.length&&k(p[0],"br"),p=/^H[1-6]$/.test(s.tagName)&&a?gn:"DT"==s.tagName&&a?"dd":"DD"==s.tagName&&a?"dt":s.tagName.toLowerCase();if(Jn[p.toUpperCase()]||ye.isAllowed(n,p)){var a=document.createElement(p),g=(Mt(s,a),a.removeAttribute("id"),s.parentNode.insertBefore(a,s.nextSibling),C(h)),n=h.extractContents(),N=tt(n);for(f=0;f<N.length;f++)N[f].nodeType==Node.ELEMENT_NODE&&-1==_(g).indexOf(N[f])&&N[f].removeAttribute("id");var m=[],v=n.firstChild;if(v)for(;q(v)||m.push(v),null!=(v=v.nextSibling););k(a,"li")&&m.length&&M(m[0],["ul","ol"])&&(o=a.offsetHeight,p=Nn(),a.appendChild(p),o!==(r=a.offsetHeight))&&a.removeChild(p),a.appendChild(n),mn(s),mn(a),rr.rangy.getSelection().collapse(a,0),t.setStart(a,0),t.setEnd(a,0)}}}}}}},L.inserttext={action:function(e,t){var n;if(A(t,{stripWrappers:!1}),F(t.startContainer)||H(t.startContainer))if(1<e.length)for(n=0;n<e.length;n++)L.inserttext.action(e[n],t);else if(""!=e){if(10===e.charCodeAt(0)||13===e.charCodeAt(0))return null!==(r=t.commonAncestorContainer.nodeType===Node.TEXT_NODE?t.commonAncestorContainer.parentNode:t.commonAncestorContainer).closest("ol, ul")?void document.execCommand("inserttext",void 0,"\n"):void L.insertlinebreak.action(void 0,t);if(" "===e&&t.collapsed&&t.endContainer.nodeType===Node.TEXT_NODE&&t.endContainer.length===t.endOffset&&Lt(t.endContainer))for(var r=t.endContainer;Lt(r)&&r.parentNode;){if("A"===r.parentNode.nodeName){t.setStartAfter(r.parentNode),t.setEndAfter(r.parentNode);break}r=r.parentNode}for(var o=t.startContainer,i=t.startOffset,a=(0<=(i=0<=i-1&&i-1<o.childNodes.length&&o.childNodes[i-1].nodeType==Node.TEXT_NODE?I(o=o.childNodes[i-1]):i)&&i<o.childNodes.length&&o.childNodes[i].nodeType==Node.TEXT_NODE&&(o=o.childNodes[i],i=0),o.nodeType==Node.ELEMENT_NODE?o:o.parentNode),s=(" "==e&&a.nodeType==Node.ELEMENT_NODE&&-1==["pre","pre-wrap"].indexOf(_.getComputedStyle(a).whiteSpace)&&(e=" "),o);s&&q(s);)s=s.previousSibling;for(var l=o;l&&q(l);)l=l.nextSibling;!s||"BR"!==s.nodeName||Yn===s||l&&l.shadowRoot?(o.nodeType==Node.TEXT_NODE?(o.insertData(i,e),rr.rangy.getSelection().collapse(o,i),t.setStart(o,i),t.setEnd(o,i+1)):(1==o.childNodes.length&&Ot(o.firstChild)&&o.removeChild(o.firstChild),a=document.createTextNode(e),t.insertNode(a),t.setStart(a,0),t.setEnd(a,1)),P(t),rr.rangy.getSelection().collapseToEnd(),t.collapse(!1)):(console.log("native insert",Yn),document.execCommand("insertText",void 0,e))}}},L.insertunorderedlist={action:function(e,t){Ln("ul",t)},indeterm:function(){return/^mixed( ul)?$/.test(Tn())},state:function(){return"ul"==Tn()}},L.justifycenter={action:function(e,t){kn("center",t),P(t)},indeterm:function(){var e=C(w(O()),function(e){return F(e)&&i(e)&&!e.hasChildNodes()});return _(e).some(function(e){return"center"==N(e)})&&_(e).some(function(e){return"center"!=N(e)})},state:function(){var e=C(w(O()),function(e){return F(e)&&i(e)&&!e.hasChildNodes()});return e.length&&_(e).every(function(e){return"center"==N(e)})},value:function(){var e=C(w(O()),function(e){return F(e)&&i(e)&&!e.hasChildNodes()});return e.length?N(e[0]):"left"},relevantCssProperty:"textAlign"},L.justifyrangecenter={action:function(e,t){zn("center",t),P(t)},indeterm:function(){var e=C(w(O()),function(e){return F(e)&&i(e)&&!e.hasChildNodes()});return _(e).some(function(e){return"center"==N(e)})&&_(e).some(function(e){return"center"!=N(e)})},state:function(){var e=C(w(O()),function(e){return F(e)&&!e.hasChildNodes()});return e.length&&_(e).every(function(e){return"center"==N(e)})},value:function(){var e=C(w(O()),function(e){return F(e)&&i(e)&&!e.hasChildNodes()});return e.length?N(e[0]):"left"},relevantCssProperty:"textAlign"},L.justifyfull={action:function(e,t){kn("justify",t),P(t)},indeterm:function(){var e=C(w(O()),function(e){return F(e)&&i(e)&&!e.hasChildNodes()});return _(e).some(function(e){return"justify"==N(e)})&&_(e).some(function(e){return"justify"!=N(e)})},state:function(){var e=C(w(O()),function(e){return F(e)&&i(e)&&!e.hasChildNodes()});return e.length&&_(e).every(function(e){return"justify"==N(e)})},value:function(){var e=C(w(O()),function(e){return F(e)&&i(e)&&!e.hasChildNodes()});return e.length?N(e[0]):"left"}},L.justifyleft={action:function(e,t){kn("left",t),P(t)},indeterm:function(){var e=C(w(O()),function(e){return F(e)&&i(e)&&!e.hasChildNodes()});return _(e).some(function(e){return"left"==N(e)})&&_(e).some(function(e){return"left"!=N(e)})},state:function(){var e=C(w(O()),function(e){return F(e)&&i(e)&&!e.hasChildNodes()});return e.length&&_(e).every(function(e){return"left"==N(e)})},value:function(){var e=C(w(O()),function(e){return F(e)&&i(e)&&!e.hasChildNodes()});return e.length?N(e[0]):"left"},relevantCssProperty:"textAlign"},L.justifyrangeleft={action:function(e,t){zn("left",t),P(t)},indeterm:function(){var e=C(w(O()),function(e){return F(e)&&i(e)&&!e.hasChildNodes()});return _(e).some(function(e){return"left"==N(e)})&&_(e).some(function(e){return"left"!=N(e)})},state:function(){var e=C(w(O()),function(e){return F(e)&&!e.hasChildNodes()});return e.length&&_(e).every(function(e){return"left"==N(e)})},value:function(){var e=C(w(O()),function(e){return F(e)&&i(e)&&!e.hasChildNodes()});return e.length?N(e[0]):"left"},relevantCssProperty:"textAlign"},L.justifyright={action:function(e,t){kn("right",t),P(t)},indeterm:function(){var e=C(w(O()),function(e){return F(e)&&i(e)&&!e.hasChildNodes()});return _(e).some(function(e){return"right"==N(e)})&&_(e).some(function(e){return"right"!=N(e)})},state:function(){var e=C(w(O()),function(e){return F(e)&&i(e)&&!e.hasChildNodes()});return e.length&&_(e).every(function(e){return"right"==N(e)})},value:function(){var e=C(w(O()),function(e){return F(e)&&i(e)&&!e.hasChildNodes()});return e.length?N(e[0]):"left"},relevantCssProperty:"textAlign"},L.justifyrangeright={action:function(e,t){zn("right",t),P(t)},indeterm:function(){var e=C(w(O()),function(e){return F(e)&&i(e)&&!e.hasChildNodes()});return _(e).some(function(e){return"right"==N(e)})&&_(e).some(function(e){return"right"!=N(e)})},state:function(){var e=C(w(O()),function(e){return F(e)&&!e.hasChildNodes()});return e.length&&_(e).every(function(e){return"right"==N(e)})},value:function(){var e=C(w(O()),function(e){return F(e)&&i(e)&&!e.hasChildNodes()});return e.length?N(e[0]):"left"},relevantCssProperty:"textAlign"},L.outdent={preservesOverrides:!0,action:function(){for(var e=[],t=O().endContainer;t!=O().commonAncestorContainer;t=t.parentNode)M(t,"li")&&e.unshift(t);for(t=O().startContainer;t;t=t.parentNode)M(t,"li")&&e.unshift(t);e.forEach(Cn);for(var n=at(w(O()),function(e){return F(e)&&(!tt(e).some(F)||M(e,["ol","ul"])||M(e,"li")&&M(e.parentNode,["ol","ul"]))});n.length;){for(;n.length&&(M(n[0],["OL","UL"])||!M(n[0].parentNode,["OL","UL"]));)_n(n.shift());if(!n.length)break;var r=[];for(r.push(n.shift());n.length&&n[0]==r[r.length-1].nextSibling&&!M(n[0],["OL","UL"]);)r.push(n.shift());var o=Zt(r);un(r),r.forEach(R),on(o)}return!0}},L.selectall={action:function(){var e=document.body;(e=e||document.documentElement)?rr.rangy.getSelection().selectAllChildren(e):rr.rangy.getSelection().removeAllRanges()}},L.stylewithcss={action:function(e){Xe="false"!=String(e).toLowerCase()},state:function(){return Xe}},L.usecss={action:function(e){Xe="false"==String(e).toLowerCase()}};var er,tr=[];for(er in L)L.hasOwnProperty(er)&&tr.push(er);_(tr).forEach(function(n){null==L[n].relevantCssProperty&&(L[n].relevantCssProperty=null),null!=L[n].inlineCommandActivatedValues&&null==L[n].indeterm&&(L[n].indeterm=function(e){var e=_(j(e,function(e){return F(e)&&e.nodeType==Node.TEXT_NODE})).map(function(e){return K(e,n)}),t=_(e).filter(function(e){return-1!=_(L[n].inlineCommandActivatedValues).indexOf(e)});return 1<=t.length&&1<=e.length-t.length}),null!=L[n].inlineCommandActivatedValues&&(L[n].state=function(e){var t=j(e,function(e){return F(e)&&!q(e)&&e.nodeType==Node.TEXT_NODE});return 0==t.length?-1!=_(L[n].inlineCommandActivatedValues).indexOf(K(e.startContainer,n)):_(t).every(function(e){return-1!=_(L[n].inlineCommandActivatedValues).indexOf(K(e,n))})}),null!=L[n].standardInlineValueCommand&&(L[n].indeterm=function(){for(var e=_(j(O())).filter(function(e){return F(e)&&e.nodeType==Node.TEXT_NODE},!0).map(function(e){return K(e,n)}),t=1;t<e.length;t++)if(e[t]!=e[t-1])return!0;return!1},L[n].value=function(e){var t=j(e,function(e){return F(e)&&e.nodeType==Node.TEXT_NODE})[0];return K(t=void 0===t?e.startContainer:t,n)})}),this.helpers.shrinkRangeToNarrowestBoundaries=In,this.helpers.getAllEffectivelyContainedNodes=j,this.helpers.getEffectivelyContainedNodes=jt,this.helpers.removeAlignmentFromElements=Wn,this.helpers.removePreservingDescendants=An,this.helpers.unwrap=function(e,t,n){if(e&&e.parentNode){for(n=n||rr.getActiveRange();0<e.childNodes.length;)X(e.firstChild,e.parentNode,x(e),n);null!==parent&&!1!==t&&wn(e,n)}},this.helpers.recursivelyFindDeepestWrappableNodesInBlockContainer=qn,this.helpers.trimBreaksAndWhitespaceFromEdgesOfRange=function(e){if(e){for(var t=Pn(e),n=Bn(e),r=t;r&&r!==n&&(q(r)||"BR"===r.nodeName);)r=r.nextSibling;for(var o=n;o&&o!==t&&(q(o)||"BR"===o.nodeName);)o=o.previousSibling;for(r&&r!==t&&e.setStartBefore(r),o&&o!==n&&e.setEndAfter(o);e.startContainer.nodeType===Node.ELEMENT_NODE&&0<e.startOffset&&e.startOffset>=e.startContainer.childNodes.length&&e.startContainer!==e.commonAncestorContainer||e.startContainer.nodeType===Node.TEXT_NODE&&0<e.startOffset&&e.startOffset>=e.startContainer.length&&e.startContainer.parentNode!==e.commonAncestorContainer;)e.setStartAfter(e.startContainer.nodeType===Node.ELEMENT_NODE?e.startContainer:e.startContainer.parentNode);for(;e.endContainer.nodeType===Node.ELEMENT_NODE&&0===e.endOffset&&e.endContainer!==e.commonAncestorContainer||e.endContainer.nodeType===Node.TEXT_NODE&&0===e.endOffset&&e.endContainer.parentNode!==e.commonAncestorContainer;)e.setEndBefore(e.endContainer.nodeType===Node.ELEMENT_NODE?e.endContainer:e.endContainer.parentNode);return e}},this.helpers.removeNodeIfEmptyAndCorrectRange=Rn,this.helpers.shrinkRangeToNarrowestBoundaries=In,this.helpers.normalizeRangeAroundShadowDom=ht,this.helpers.growRangeToWidestBoundaries=Hn,this.helpers.canRangeBeNativelySelected=Vn,this.helpers.fixDisallowedAncestors=R,this.helpers.movePreservingRanges=X,this.helpers.isExtraneousLineBreak=St,this.helpers.isCollapsedLineBreak=Ot,this.helpers.getAllContainedNodes=C,this.helpers.advancedSplitRange=Xn,this.helpers.isLastNodeInParent=Lt,this.helpers.inSameEditingHost=V,this.helpers.getContainedNodes=at,this.helpers.isWhitespaceNode=q,this.helpers.splitRangeCustom=function(e,t){if(e.commonAncestorContainer.nodeType!==Node.TEXT_NODE||0!==e.startOffset||e.startContainer.length!==e.endOffset){for(var n=e.startContainer,r=e.endContainer;null!==n&&n!==e.commonAncestorContainer&&n.parentNode!==e.commonAncestorContainer&&(void 0===t||n.parentNode.nodeName.toLowerCase()!==t.toLowerCase());)n=n.parentNode;for(;null!==r&&r!==e.commonAncestorContainer&&r.parentNode!==e.commonAncestorContainer&&(void 0===t||r.parentNode.nodeName.toLowerCase()!==t.toLowerCase());)r=r.parentNode;var o=bn(e.endContainer,e.endOffset,r),o=(o.nodeType!==Node.ELEMENT_NODE||S(o)||r.parentNode.insertBefore(o,r.nextSibling),bn(e.startContainer,e.startOffset,n));o.nodeType!==Node.ELEMENT_NODE||S(o)||n.parentNode.insertBefore(o,n.nextSibling),e.setStartBefore(o),e.setEndAfter(r)}return e},this.helpers.getEditingHostOf=Tt,this.helpers.getIndexInParent=x,this.helpers.fixRangeOffsets=ft,this.helpers.setActiveRange=P,this.helpers.splitNodeTree=bn,this.helpers.isInShadowDom=bt,this.helpers.wrapRangeWith=function(e,o){if(o=o||{},null===e||(e=(e=/^<.*>$/.test(e)?e.slice(1,-1):e).toLowerCase(),Zn.includes(e))||"span"===e||"a"===e){var i=O();if(void 0!==i&&!i.collapsed){rr.plugins.shadowDom&&(rr.plugins.shadowDom.preventSlottedElementCorrectionOnce=!0,setTimeout(function(){rr.plugins.shadowDom.preventSlottedElementCorrectionOnce=!1},1));for(var t,n,r,a=i.startContainer,s=[],l=null;a.parentNode;){if(null===l&&a.nodeType===Node.ELEMENT_NODE&&"SPAN"===a.nodeName&&(l=a),a.nodeType===Node.ELEMENT_NODE&&("OL"===a.nodeName||"UL"===a.nodeName)){s.push(a);break}"COLUMN-UNIT"===a.nodeName&&(t=a),a=a.parentNode}for(a=i.endContainer;a.parentNode;){if(a.nodeType===Node.ELEMENT_NODE&&("OL"===a.nodeName||"UL"===a.nodeName)){s.includes(a)||s.push(a);break}"COLUMN-UNIT"===a.nodeName&&(n=a),a=a.parentNode}0<s.length&&(Hn(r=i.cloneRange()),s.some(function(e){return r.containsNode(e)}))&&(P(r),i=r);var d=null;if("span"===e){var a=i.commonAncestorContainer,c=rr.rangy.createRange();for(c.selectNode(i.commonAncestorContainer),c=i.intersection(c);null!==a&&!H(a);){if(a.nodeType===Node.ELEMENT_NODE&&"SPAN"===a.nodeName){a.textContent===c.toString()&&(d=a);break}a=a.parentNode}}"span"!==e||d||(t||n)&&t!==n?i=Xn(i,{attemptToBreakBlockParent:!1}):yn(i);var u=[],f=[],h=(j(i,function(t){return!(!o.deleteParentFilter&&!0!==o.splitSpans&&"span"===e&&null!==d)&&"COLUMN-UNIT"!==t.nodeName&&"COLUMN-SET"!==t.nodeName&&("MEDIA-ITEM"===t.nodeName?(f.push(t),!0):!(0<f.length&&0<f.filter(function(e){return e.contains(t)}).length)&&F(t)&&(hn(t)||W(t,"p")||M(t,["dd","dt"]))&&!_(tt(t)).some(mt))}).forEach(function(e){"OL"!==e.nodeName&&"UL"!==e.nodeName||u.push(e),qn(e).forEach(function(e){-1!==u.indexOf(e)&&u.splice(u.indexOf(e),1),u.push(e)})}),["h1","h2","h3","h4","h5","h6"]),p=(h.includes(e)&&null!==e&&!1!==o.splitHeaders&&(o.splitHeaders=!0),[]);if((o.splitSpans||o.splitHeaders||o.deleteParentFilter)&&(o.deleteParentFilter&&(delete o.splitSpans,delete o.splitHeaders),u.forEach(function(e){for(;e.parentNode&&!H(e);){var t,n,r=e.parentNode;(o.deleteParentFilter&&o.deleteParentFilter(e.parentNode)||o.splitHeaders&&M(e.parentNode,h)||o.splitSpans&&M(e.parentNode,"span"))&&(t=[],or.getAllDescendants(e.parentNode,function(e){e.nodeType!==Node.TEXT_NODE||q(e)||t.push(e)}),p.push([e.parentNode,t]),(n=un([e],i,!0))&&null!==n.parentNode&&Gn(n,i),e&&e.previousElementSibling&&e.previousElementSibling.nodeName===n.nodeName&&Gn(e.previousElementSibling,i),e)&&e.nextElementSibling&&e.nextElementSibling.nodeName===n.nodeName&&Gn(e.nextElementSibling,i),e.parentNode===r&&(e=e.parentNode)}})),null!==e){for(var g,N,m,v=[];u.length;){var E,C=u[0];if(pn(C)&&"LI"===!C.nodeName&&"OL"===!C.nodeName&&"UL"===!C.nodeName)E=[].slice.call(Ge(C.childNodes)),values=Zt(E),An(C,i),on(values,i),u.shift();else for((E=[]).push(u.shift());u.length&&E.length&&u[0]==E[E.length-1].nextSibling&&!pn(u[0])&&!k(E[E.length-1],"BR");)E.push(u.shift());var y=Ut(E,-1==["div","p"].indexOf(e)?function(t){return function(e){return M(e,t)&&!e.attributes.length}}(e):T,function(e){return function(){return document.createElement(e)}}(e),i,!0);-1==v.indexOf(y)&&v.push(y)}v.reverse(),[].forEach.call(v,function(e){if(S(e))or.unwrap(e,!0,i);else if(null!==(a=e))for(;null!==(a=a.parentNode);)-1!==(g=v.indexOf(a))&&Mn(e,v[g])&&or.unwrap(e,!0,i)}),v.reverse(),[].forEach.call(v,function(e){null!==e&&null!==e.parentNode&&(void 0===N&&(N=e),m=e)}),"span"!==e&&void 0!==N&&void 0!==m&&(null!==N.firstChild?i.setStartBefore(N.firstChild):i.setStartBefore(N),null!==m.lastChild?i.setEndAfter(m.lastChild):i.setEndAfter(N));var b=["class"];v.forEach(function(n){var e=p.find(function(e){var e=e[1],t=[];return or.getAllDescendants(C.parentNode,function(e){e.nodeType!==Node.TEXT_NODE||q(e)||t.push(e)}),n&&0<t.length&&e.length===t.length&&e.every(function(e){return t.includes(e)})});e&&(e=e[0],Array.from(e.attributes).forEach(function(e){b.includes(e.nodeName)||("A"===n.nodeName||"href"!==e.nodeName&&"rel"!==e.nodeName)&&n.setAttribute(e.nodeName,e.nodeValue)}))})}P(i)}}function T(){return!1}},this.helpers.isEditingHost=H,this.helpers.previousNode=Ye,this.helpers.isEmptyNode=S,this.helpers.blockExtend=w,this.helpers.splitRange=yn,this.helpers.isEditable=F,this.helpers.nextNode=E,this.commands=L,this.execCommand=function(){var e=arguments,t=this;"insertlinebreak"!==e[0].toLowerCase()&&($n=Qn=void 0),rr.events.trigger("exec-command",rr.getActiveEditor(),e[0].toLowerCase(),e[1],e[2]),this.mutationManager.execute(function(){return pt.apply(t,e)}),rr.events.trigger("exec-command-after",rr.getActiveEditor(),e[0].toLowerCase(),e[1],e[2])},this.execCommandSilent=function(){var e=arguments,t=this;rr.events.trigger("exec-command",rr.getActiveEditor(),e[0].toLowerCase(),e[1],e[2]),this.mutationManager.execute(function(){return pt.apply(t,e)},!0),rr.events.trigger("exec-command-after",rr.getActiveEditor(),e[0].toLowerCase(),e[1],e[2])},this.setCommand=function(e,t){if(void 0===e||void 0===t)return!1;e=e.toLowerCase(),this.commands[e]=t};var nr=document.createElement("iframe"),Ae=(nr.src="",nr.style.visibility="hidden",nr.style.position="absolute",nr.style.left="-99999px",nr.style.top="0px",nr.id="contentEditableStyleTester",document.getElementsByTagName("html")[0].appendChild(nr),nr.contentWindow.document.createElement("style"));nr.contentWindow.document.getElementsByTagName("head")[0].appendChild(Ae),Ae.innerHTML="h1, h2, h3, h4, h5, h6 {\tfont-weight: 500;}",this.isCommandOverruledByExternalStyle=function(e){if(!L.hasOwnProperty(e))return!1;if(!L[e].hasOwnProperty("relevantCssProperty"))return!1;var t=rr.getActiveRange().commonAncestorContainer,n=Tt(t);if(null===n)return!1;for(var r,o=t=t.nodeType!==Node.ELEMENT_NODE?t.parentNode:t,i=[];null!==o.parentNode&&(i.push(o.cloneNode()),o!==document.body)&&o!==n;)o=o.parentNode;if(0===i.length)return!1;var e=L[e].relevantCssProperty,a=nr.contentDocument.createElement("styletester");for(nr.contentDocument.body.appendChild(a),a.style.setProperty(e,"initial"),i.reverse(),r=0;r<i.length;r++)i[r].className="",(0==r?a:i[r-1]).appendChild(i[r]);var s,l=getComputedStyle(t)[e],d=nr.contentWindow.getComputedStyle(i[i.length-1])[e],c=!1;return c="fontWeight"===e?(s=function(e){if("string"==typeof e)switch(e){case"normal":e=400;break;case"bold":e=700}return 500===parseInt(e)&&(e=400),parseInt(e)})(l)>s(d):"textAlign"===e?(s=getComputedStyle(t).direction,l!==(d="end"===(d="start"===d&&"start"!==l?"ltr"!==s?"right":"left":d)&&"end"!==l?"ltr"!==s?"left":"right":d)):l!==d,a.parentNode.removeChild(a),c},this.getActiveRange=O,this.setSelectionValue=a,this.queryCommandState=gt,this.queryCommandEnabled=ut,this.queryCommandIndeterm=function(e,t){e=e.toLowerCase();var n,r=rr.rangy.getSelection();if(!t){if(0===r.rangeCount)return;t=O()}return ct(0,0,t,(n=e,function(){return!!ut(n,t)&&L[n].indeterm(t)}))},this.queryCommandValue=Nt}.call(this),function(a){var r,t,n,i=this,o=!1,e=!1,s=!1,l=0,d={a:["href","target","rel"],iframe:["data-scale","data-draggable","data-rotation","data-icon-mode"],video:["data-scale","data-draggable","data-rotation","data-icon-mode"],img:["data-scale","data-align","data-no-zoom","data-draggable","data-rotation","data-icon-mode"],span:["style"],div:["data-gallery"],shop:["data-options"]};function c(e){return void 0!==e&&0<e.length&&e.forEach(function(e){i.detectLegalAttributeChangesInSummary(e),rr.events.trigger("editor-summary-created",i,e,s),(0<e.added.length||0<e.removed.length||0<e.reordered.length||0<e.reparented.length||0<e.characterDataChanged.length||0<e.legalAttributeChanges.length)&&rr.events.trigger("editor-content-change",i,e,s)}),e}this.setReportableAttributes=function(e){"object"!=typeof e&&console.warn("Setting new reportable attributes failed. The new value is not an object literal."),d=e},this.getReportableAttributes=function(){return d},this.detectLegalAttributeChangesInSummary=function(n){var r;if(void 0!==n)return n.legalAttributeChanges=[],[].forEach.call(n.attributeChanged,function(e,t){[].forEach.call(e,function(e){r=e.nodeName.toLowerCase(),d.hasOwnProperty(r)&&-1!==d[r].indexOf(t.toLowerCase())&&n.legalAttributeChanges.push({element:e,attribute:t,oldValue:n.getOldAttribute(e,t),newValue:e.getAttribute(t)})})}),n.legalAttributeChanges},this.keyEvents={},this.elementEvents={},this.editorEvents={},this.core=rr;return this.getElement=function(){return a},this.getExecutionDepth=function(){return l},this.getMutationSummaryObserver=function(){return r},this.generateMutationSummaries=function(e){var t,n;return!0===this.destroyed?[]:(t=s,!0===e&&(s=!0),rr.events.trigger("editor-before-summary-report",i),n=c(r.takeSummaries()),rr.events.trigger("editor-after-summary-report",i),!0===e&&(s=t),n)},this.generateUnreportedMutationSummaries=function(e){if(!0===this.destroyed)return[];void 0===e&&(e=r.getQueue());for(var t=r.createSummaries(e),n=0;n<t.length;n++)i.detectLegalAttributeChangesInSummary(t[n]);return t},this.isActive=function(){return o},this.getSaveableNodes=function(){var e=document.createDocumentFragment(),t=[],n=[];e.appendChild(a.persistCloneNode(!0)),or.getAllDescendants(e,function(e){!1===e.isSaveable()&&(0<e.childNodes.length?t:n).push(e)});for(var r=t.length-1;0<=r;r--)or.unwrap(t[r],!0);for(r=0;r<n.length;r++)n[r].parentNode.removeChild(n[r]);return e},this.markAsClean=function(){rr.events.trigger("editor-mark-clean",i)},this.checkIfEmpty=function(){var t=!1,n=0;if(or.getAllDescendants(a,function(e){if(t)return"continue;";("IMG"===e.nodeName||"IFRAME"===e.nodeName||"CARGO-EMBED"===e.nodeName||"PERSONA-EMBED"===e.nodeName||"SHOP"===e.nodeName||"SHOP-PRODUCT"===e.nodeName||"AUDIO-PLAYER"===e.nodeName||"COLUMN-SET"===e.nodeName||"UL"===e.nodeName||"OL"===e.nodeName||"HR"===e.nodeName||e.nodeType===Node.ELEMENT_NODE&&e.hasAttribute("grid-row")||e.nodeType===Node.ELEMENT_NODE&&e.nodeName.startsWith("GALLERY-")||"MEDIA-ITEM"===e.nodeName||"TEXT-ICON"===e.nodeName||"DIGITAL-CLOCK"===e.nodeName||"BR"===e.nodeName&&2<=++n)&&(t=!0)}),/[^\t\n\r\s]/.test(a.textContent)||t){if(!0===e)return e=!1,rr.events.trigger("editor-has-content",i),!1}else if(!1===e)return e=!0,i.moveCaret(),rr.events.trigger("editor-no-content",i),!0;return e},this.moveCaret=function(e,t){if(null===(e=void 0===e?a.firstChild:e)){if(null===a.lastChild)return;e=a.lastChild}var n;a.contains(e)&&a.ownerDocument.documentElement.contains(a)?(isNaN(t)&&(t=0),n=rr.rangy.createRange(),e.nodeType===Node.TEXT_NODE?n.setStart(e,t):0<t?n.setStartAfter(e):n.setStartBefore(e),n.collapse(!0),rr.rangy.getSelection().setSingleRange(n),rr.events.trigger("cursor-activity",i)):console.warn(e,"is not contained inside of the editor or document")},this.moveCaretToEnd=function(){var e=rr.rangy.createRange();e.selectNode(a.lastChild),e.collapse(!1),rr.rangy.getSelection().setSingleRange(e),rr.events.trigger("cursor-activity",i)},this.scrollIntoView=function(){},this.getHTML=function(){return a.innerHTML},this.destroy=function(){if(!0!==this.destroyed){for(var e in rr.events.trigger("editor-before-destroy",i),document.removeEventListener("keypress",n),this.keyEvents)this.removeKeyListener(e);for(e in this.elementEvents)for(;void 0!==this.elementEvents[e]&&0<this.elementEvents[e].length;)this.removeElementEventListener(e,this.elementEvents[e][0]);for(e in this.editorEvents)for(;void 0!==this.editorEvents[e]&&0<this.editorEvents[e].length;)this.removeEditorEventListener(e,this.editorEvents[e][0]);null!==t&&(t.removeListeners(),t=null),null!==r&&(r.disconnect(),r=null),a.removeAttribute("contenteditable"),a.removeAttribute("spellcheck"),rr.events.trigger("editor-destroyed",i),this.destroyed=!0}},function(){function e(e){var t=rr.getActiveRange();if(void 0===t)return!1;for(var n,r=!1,o=!1,i=t.commonAncestorContainer;null!==i.parentNode&&i.parentNode!==a;)"li"!==(n=i.nodeName.toLowerCase())&&"ul"!==n&&"ol"!=n||(r=!0),"code"!==n&&"pre"!==n&&"xpm"!==n||(o=!0),i=i.parentNode;!0===e.shiftKey&&(r=!1),13!==e.keyCode||r?rr.events.once("mutation-before-success",function(e){var t=rr.getActiveRange();[].forEach.call(e.generateUnreportedMutationSummaries(),function(e){[].forEach.call(e.added,function(e){"DIV"!==e.nodeName&&"P"!==e.nodeName||1!==e.children.length||"BR"!==e.children[0].nodeName||rr.helpers.removePreservingDescendants(e,t)})})}):(e.preventDefault(),e.stopPropagation(),o?rr.execCommand("inserthtml",!1,"\n"):(void 0!==(t=rr.getActiveRange())&&!1===t.collapsed&&t.collapse(),rr.events.once("editor-content-change",function(e,t){1===t.added.length&&"BR"===t.added[0].nodeName&&(t=(t=t.added[0].getBoundingClientRect()).bottom+(isNaN(t.height)?0:t.height),t=window.innerHeight-t,!isNaN(t))&&t<0&&window.scrollBy(0,-1*t)}),rr.execCommand("insertlinebreak")))}return a.setAttribute("contenteditable","true"),a.setAttribute("spellcheck","false"),rr.helpers.isEmptyNode(a)&&rr.helpers.getAllDescendants(a,function(e){e.nodeType===Node.TEXT_NODE&&null===e.data.match(/\S/)&&e.parentNode&&0===e.data.replace(/\s/,"").length&&e.parentNode.removeChild(e)},!0),(r=new MutationSummary({callback:function(){c.apply(this,arguments)},rootNode:i.getElement(),oldPreviousSibling:!0,observeOwnChanges:!1,queries:[{all:!0}]})).suspendDelivery(),this.addEditorEventListener("set-active-editor",function(){var e=rr.getActiveRange();!o&&e&&i.getElement()&&i.getElement().contains(e.commonAncestorContainer)&&(rr.events.trigger("editor-activated",i),o=!0)}),this.addEditorEventListener("mutation-start",function(e,t){e===i&&(l++,!1!==t.flushQueuedMutations&&i.generateMutationSummaries(),s=!0)}),this.addEditorEventListener("mutation-success",function(e,t){}),this.addEditorEventListener("mutation-end",function(e,t){e===i&&(l<=1&&(i.generateMutationSummaries(),s=!1),0<l?l--:i.checkIfEmpty())}),this.addEditorEventListener("editor-content-change",function(e,t,n){e===i&&(!0===n&&t.added.forEach(function(e){e.hasOwnProperty("saveable")&&!1===e.saveable||e.setSaveable(!0),0<e.childNodes.length&&e.saveable&&or.getAllDescendants(e,function(e){e.setSaveable(!0)})}),(0<t.added.length||0<t.removed.length||0<t.characterDataChanged.length&&n)&&rr.events.trigger("cursor-activity",i),setTimeout(function(){i.checkIfEmpty()}))}),t=new rr.Dragster(a),this.addElementEventListener("dragster:enter",function(e){e.dataTransfer=e.detail.dataTransfer,rr.events.trigger("editor-dragin",i,e)}),this.addElementEventListener("dragster:leave",function(e){e.dataTransfer=e.detail.dataTransfer,rr.events.trigger("editor-dragout",i,e)}),this.addElementEventListener("copy",function(e){rr.events.trigger("editor-copy",i,e)}),this.addElementEventListener("cut",function(e){rr.events.trigger("editor-cut",i,e)}),this.addElementEventListener("paste",function(e){rr.events.trigger("editor-before-paste",i,e),rr.events.trigger("editor-paste",i,e)}),this.addElementEventListener("dragenter",function(e){rr.events.trigger("editor-dragenter",i,e)}),this.addElementEventListener("dragleave",function(e){rr.events.trigger("editor-dragleave",i,e)}),this.addElementEventListener("dragstart",function(e){rr.events.trigger("editor-dragstart",i,e)}),this.addElementEventListener("dragover",function(e){rr.events.trigger("editor-dragover",i,e)}),this.addElementEventListener("dragend",function(e){rr.events.trigger("editor-dragend",i,e)}),this.addElementEventListener("drop",function(e){rr.events.trigger("editor-drop",i,e),e.preventDefault()}),this.addElementEventListener("mouseenter",function(e){rr.events.trigger("editor-mouseenter",i,e)}),this.addElementEventListener("mouseleave",function(e){rr.events.trigger("editor-mouseleave",i,e)}),this.addElementEventListener("click",function(e){rr.events.trigger("editor-click",i,e)}),this.addElementEventListener("mousedown",function(e){rr.events.trigger("editor-mousedown",i,e),setTimeout(function(){rr.events.trigger("cursor-activity",i);var n,r=rr.getActiveRange();void 0!==r&&(n=function(e){var t=rr.getActiveRange();void 0===t||r.equals(t)||!1!==t.collapsed||rr.events.trigger("cursor-activity",i),document.getElementsByTagName("html")[0].removeEventListener("mouseup",n),a.removeEventListener("mouseup",n)},document.getElementsByTagName("html")[0].addEventListener("mouseup",n),a.addEventListener("mouseup",n))},150)}),this.addElementEventListener("focus",function(e){rr.events.trigger("editor-activated",i,e),o=!0}),this.addElementEventListener("blur",function(e){rr.events.trigger("editor-deactivated",i,e),o=!1}),n=function(e){var t,n,r,o;"TEXTAREA"!==e.target.nodeName&&"INPUT"!==e.target.nodeName&&!0!==e.metaKey&&!0!==e.ctrlKey&&(o=rr.getActiveRange())&&a.contains(o.commonAncestorContainer)&&(rr.helpers.setActiveRange(rr.helpers.shrinkRangeToNarrowestBoundaries(o)),rr.events.trigger("editor-keypress",i,e),t="number"==typeof e.which?e.which:e.keyCode,'"'==(t=String.fromCharCode(t))||"'"==t?(n='"'==t?"“":"‘",r='"'==t?"”":"’",e.preventDefault(),(o=rr.getActiveRange()).commonAncestorContainer.nodeType!==Node.TEXT_NODE||0===(o=o.startContainer.data.substring(0,o.startOffset)).length||null!==o.charAt(o.length-1).match(/\s/)?rr.execCommand("inserttext",!1,n):rr.execCommand("inserttext",!1,r)):0<t.length&&(e.preventDefault(),rr.execCommand("inserttext",!1,t)),rr.helpers.scrollToRange(rr.getActiveRange(),!0))}.bind(this),document.addEventListener("keypress",n),this.addElementEventListener("input",function(e){"INPUT"!==e.target.nodeName&&"TEXTAREA"!==e.target.nodeName&&l<=0&&(i.checkIfEmpty(),rr.mutationManager.execute(function(){i.generateMutationSummaries(!0)},{flushQueuedMutations:!1}))}),this.addElementEventListener("keyup",function(e){rr.events.trigger("editor-keyup",i,e)}),this.addElementEventListener("keydown",function(e){rr.events.trigger("editor-keydown",i,e);var t=e.target;if("TEXTAREA"===t.nodeName||"INPUT"===t.nodeName){if("Backspace"===e.code||"46"===e.keyCode){if(t.setRangeText("",t.selectionStart,t.selectionEnd),0===t.selectionStart&&0==t.selectionEnd)return;t.selectionStart===t.selectionEnd?(t.setRangeText("",t.selectionStart-1,t.selectionEnd),t.currentNode.selectionStart=t.selectionStart-1):t.setRangeText("",t.selectionStart,t.selectionEnd)}}else if(void 0!==rr.getActiveRange())switch(e.keyCode){case 37:case 38:case 39:case 40:setTimeout(function(){rr.events.trigger("cursor-activity",i)});break;case 65:e.metaKey&&(e.preventDefault(),setTimeout(function(){var e=rr.rangy.createRange();e.selectNodeContents(a),rr.helpers.setActiveRange(e),rr.events.trigger("cursor-activity",i)},0))}}),this.addKeyListener("cmd + b",function(e){e.preventDefault()}),this.addKeyListener("cmd + i",function(e){e.preventDefault()}),this.addKeyListener("ctrl + enter/option + enter/option + shift + enter",function(e){e.preventDefault()}),this.addKeyListener("shift + backspace / backspace",function(e){e.preventDefault(),"INPUT"!==e.target.nodeName&&"TEXTAREA"!==e.target.nodeName&&rr.execCommand("delete")}),this.addKeyListener("option + backspace",function(e){e.preventDefault();e=rr.getActiveRange();void 0!==e&&(e.moveStart("word",-1),a.contains(e.commonAncestorContainer))&&(rr.helpers.setActiveRange(e),rr.execCommand("delete"))}),this.addKeyListener("delete",function(e){e.preventDefault(),rr.execCommand("forwardDelete")}),this.addKeyListener("tab",function(e){e.preventDefault();for(var t,n=!1,r=or.getCurrentSelectionTree(e.target.parentNode).nodes,e=rr.getActiveRange(),o=0;o<r.length;o++)if("code"===(t=r[o].nodeName.toLowerCase())||"pre"===t||"xpm"===t){n=!0;break}n?rr.execCommand("inserthtml",!1,"\t"):null!==e&&rr.execCommand("inserthtml",!1,"&nbsp; &nbsp; ")}),this.addKeyListener("shift+tab",function(e){e.preventDefault()}),this.addKeyListener("shift + enter",e),this.addKeyListener("enter",e),rr.events.trigger("editor-instanciated",i),this.checkIfEmpty(),this}.call(this)}),d=(or.extend(c.prototype,{addKeyListener:function(e,t){this.keyEvents.hasOwnProperty(e)&&this.removeKeyListener(e);t=rr.jwerty.event(e,t,this);this.addElementEventListener("keydown",t),this.keyEvents[e]=t},removeKeyListener:function(e){var t;this.keyEvents.hasOwnProperty(e)&&(t=this.keyEvents[e],this.removeElementEventListener("keydown",t),delete this.keyEvents[e])},addElementEventListener:function(e,t){return this.elementEvents.hasOwnProperty(e)||(this.elementEvents[e]=[]),-1===this.elementEvents[e].indexOf(t)&&this.elementEvents[e].push(t),this.getElement().addEventListener(e,t,!1)},removeElementEventListener:function(e,t){var n;this.elementEvents.hasOwnProperty(e)&&-1!==(n=this.elementEvents[e].indexOf(t))&&(this.elementEvents[e].splice(n,1),0===this.elementEvents[e].length)&&delete this.elementEvents[e],this.getElement().removeEventListener(e,t)},addEditorEventListener:function(e,t){this.editorEvents.hasOwnProperty(e)||(this.editorEvents[e]=[]),-1===this.editorEvents[e].indexOf(t)&&this.editorEvents[e].push(t),this.core.events.on(e,t)},removeEditorEventListener:function(e,t){this.core.events.off(e,t),this.editorEvents.hasOwnProperty(e)&&-1!==(t=this.editorEvents[e].indexOf(t))&&(this.editorEvents[e].splice(t,1),0===this.editorEvents[e].length)&&delete this.editorEvents[e]}}),rr.events.on("editor-activated",function(e){t=e}),this),e="undefined"!=typeof module&&module.exports?module.exports:this,o=d.document,i=d.jQuery||d.Zepto||d.ender||o,a="keydown";function u(e,t){return null===e?"null"===t:void 0===e?"undefined"===t:e.is&&e instanceof i?"element"===t:7<Object.prototype.toString.call(e).toLowerCase().indexOf(t)}for(var f=i===o?(s=function(e,t){return e?i.querySelector(e,t||i):i},l=function(e,t){e.addEventListener(a,t,!1)},function(e,t){var n,r=o.createEvent("Event");for(n in r.initEvent(a,!0,!0),t)r[n]=t[n];return(e||i).dispatchEvent(r)}):(s=function(e,t){return i(e||o,t)},l=function(e,t){i(e).bind(a+".jwerty",t)},function(e,t){i(e||o).trigger(i.Event(a,t))}),I={16:"shiftKey",17:"ctrlKey",18:"altKey",91:"metaKey"},h={mods:{"⇧":16,shift:16,"⌃":17,ctrl:17,"⌥":18,alt:18,option:18,"⌘":91,meta:91,cmd:91,super:91,win:91},keys:{"⌫":8,backspace:8,"⇥":9,"⇆":9,tab:9,"↩":13,return:13,enter:13,"⌅":13,pause:19,"pause-break":19,"⇪":20,caps:20,"caps-lock":20,"⎋":27,escape:27,esc:27,space:32,"↖":33,pgup:33,"page-up":33,"↘":34,pgdown:34,"page-down":34,"⇟":35,end:35,"⇞":36,home:36,ins:45,insert:45,del:46,delete:46,"←":37,left:37,"arrow-left":37,"↑":38,up:38,"arrow-up":38,"→":39,right:39,"arrow-right":39,"↓":40,down:40,"arrow-down":40,"*":106,star:106,asterisk:106,multiply:106,"+":107,plus:107,"-":109,subtract:109,"num-.":110,"num-period":110,"num-dot":110,"num-full-stop":110,"num-delete":110,";":186,semicolon:186,"=":187,equals:187,",":188,comma:188,".":190,period:190,"full-stop":190,"/":191,slash:191,"forward-slash":191,"`":192,tick:192,"back-quote":192,"[":219,"open-bracket":219,"\\":220,"back-slash":220,"]":221,"close-bracket":221,"'":222,quote:222,apostraphe:222}},r=47,p=0;++r<106;)h.keys[p]=r,h.keys["num-"+p]=r+48,++p;for(r=111,p=1;++r<136;)h.keys["f"+p]=r,++p;for(r=64;++r<91;)h.keys[String.fromCharCode(r).toLowerCase()]=r;function g(e){var t,n,r,o,i,a,s,l,d;if(e instanceof g)return e;for(t=0,n=(e=u(e,"array")?e:String(e).replace(/\s/g,"").toLowerCase().match(/(?:\+,|[^,])+/g)).length;t<n;++t){for(u(e[t],"array")||(e[t]=String(e[t]).match(/(?:\+\/|[^\/])+/g)),a=[],r=e[t].length;r--;){for(s=e[t][r],i={jwertyCombo:String(s),shiftKey:!1,ctrlKey:!1,altKey:!1,metaKey:!1},o=(s=u(s,"array")?s:String(s).toLowerCase().match(/(?:(?:[^\+])+|\+\+|^\+$)/g)).length;o--;)"++"===s[o]&&(s[o]="+"),s[o]in h.mods?i[I[h.mods[s[o]]]]=!0:s[o]in h.keys?i.keyCode=h.keys[s[o]]:l=s[o].match(/^\[([^-]+\-?[^-]*)-([^-]+\-?[^-]*)\]$/);if(u(i.keyCode,"undefined"))if(l&&l[1]in h.keys&&l[2]in h.keys){for(l[2]=h.keys[l[2]],l[1]=h.keys[l[1]],d=l[1];d<l[2];++d)a.push({altKey:i.altKey,shiftKey:i.shiftKey,metaKey:i.metaKey,ctrlKey:i.ctrlKey,keyCode:d,jwertyCombo:String(s)});i.keyCode=d}else i.keyCode=0;a.push(i)}this[t]=a}return this.length=t,this}var N=e.jwerty={event:function(t,n,r){u(n,"boolean")&&(e=n,n=function(){return e}),t=new g(t);var e,o,i=0,a=t.length-1;return function(e){if(o=N.is(t,e,i))return i<a?void++i:(!1===n.call(r||this,e,o)&&e.preventDefault(),void(i=0));i=N.is(t,e)?1:0}},is:function(e,t,n){e=(e=new g(e))[n=n||0],t=t.originalEvent||t;for(var r=e.length,o=!1;r--;){for(var i in o=e[r].jwertyCombo,e[r])"jwertyCombo"!==i&&t[i]!=e[r][i]&&(o=!1);if(!1!==o)return o}return o},key:function(e,t,n,r,o){var i=u(n,"element")||u(n,"string")?n:r,a=i===n?d:n,n=i===n?r:o;l(u(i,"element")?i:s(i,n),N.event(e,t,a))},fire:function(e,t,n,r){e=new g(e);r=u(n,"number")?n:r;f(u(t,"element")?t:s(t,n),e[r||0][0])},KEYS:h},e=this.__extends||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);function r(){this.constructor=e}r.prototype=t.prototype,e.prototype=new r},m="undefined"!=typeof WebKitMutationObserver?WebKitMutationObserver:MutationObserver;if(void 0===m)throw console.error("DOM Mutation Observers are required."),console.error("https://developer.mozilla.org/en-US/docs/DOM/MutationObserver"),Error("DOM Mutation Observers are required");E.prototype.set=function(e,t){return this.__nativeMap.set(e,t)},E.prototype.get=function(e){return this.__nativeMap.get(e)},E.prototype.has=function(e){return this.__nativeMap.has(e)},E.prototype.delete=function(e){return this.__nativeMap.delete(e)},E.prototype.keys=function(){return Array.from(this.__nativeMap.keys())};var v=E;function E(){this.__nativeMap=new Map}C.prototype.getAttributeOldValue=function(e){if(this.attributeOldValues)return this.isCaseInsensitive&&(e=e.toLowerCase()),this.attributeOldValues[e]},C.prototype.getAttributeNamesMutated=function(){var e=[];if(this.attributeOldValues)for(var t in this.attributeOldValues)e.push(t);return e},C.prototype.attributeMutated=function(e,t){this.attributes=!0,this.attributeOldValues=this.attributeOldValues||{},e in this.attributeOldValues||(this.attributeOldValues[e]=t)},C.prototype.characterDataMutated=function(e){this.characterData||(this.characterData=!0,this.characterDataOldValue=e)},C.prototype.removedFromParent=function(e){this.childList=!0,this.added||this.oldParentNode?this.added=!1:this.oldParentNode=e},C.prototype.insertedIntoParent=function(){this.childList=!0,this.added=!0},C.prototype.getOldParent=function(){if(this.childList){if(this.oldParentNode)return this.oldParentNode;if(this.added)return null}return this.node.parentNode};var P=C;function C(e,t,n,r,o,i,a,s){void 0===t&&(t=!1),void 0===n&&(n=!1),void 0===r&&(r=!1),void 0===o&&(o=null),void 0===i&&(i=!1),void 0===a&&(a=null),void 0===s&&(s=null),this.node=e,this.childList=t,this.attributes=n,this.characterData=r,this.oldParentNode=o,this.added=i,this.attributeOldValues=a,this.characterDataOldValue=s,this.isCaseInsensitive=this.node.nodeType===Node.ELEMENT_NODE&&this.node instanceof HTMLElement&&this.node.ownerDocument instanceof HTMLDocument}var y,b=function(){this.added=new v,this.removed=new v,this.maybeMoved=new v,this.oldPrevious=new v,this.moved=void 0},B=(e(T,y=v),T.prototype.getChange=function(e){var t=this.get(e);return t||(t=new P(e),this.set(e,t)),t},T.prototype.getOldParent=function(e){var t=this.get(e);return t?t.getOldParent():e.parentNode},T.prototype.getIsReachable=function(e){if(e===this.rootNode)return!0;if(!e)return!1;this.reachableCache=this.reachableCache||new v;var t=this.reachableCache.get(e);return void 0===t&&(t=this.getIsReachable(e.parentNode),this.reachableCache.set(e,t)),t},T.prototype.getWasReachable=function(e){if(e===this.rootNode)return!0;if(!e)return!1;this.wasReachableCache=this.wasReachableCache||new v;var t=this.wasReachableCache.get(e);return void 0===t&&(t=this.getWasReachable(this.getOldParent(e)),this.wasReachableCache.set(e,t)),t},T.prototype.reachabilityChange=function(e){return this.getIsReachable(e)?this.getWasReachable(e)?2:1:this.getWasReachable(e)?5:0},T);function T(e,t){y.call(this),this.rootNode=e,this.reachableCache=void 0,this.wasReachableCache=void 0,this.anyParentsChanged=!1,this.anyAttributesChanged=!1,this.anyCharacterDataChanged=!1;for(var n=0;n<t.length;n++){var r=t[n];switch(r.type){case"childList":this.anyParentsChanged=!0;for(var o=0;o<r.removedNodes.length;o++){var i=r.removedNodes[o];this.getChange(i).removedFromParent(r.target)}for(o=0;o<r.addedNodes.length;o++){i=r.addedNodes[o];this.getChange(i).insertedIntoParent()}break;case"attributes":this.anyAttributesChanged=!0,this.getChange(r.target).attributeMutated(r.attributeName,r.oldValue);break;case"characterData":this.anyCharacterDataChanged=!0,this.getChange(r.target).characterDataMutated(r.oldValue)}}}O.prototype.processMutations=function(){if(this.treeChanges.anyParentsChanged||this.treeChanges.anyAttributesChanged)for(var e=this.treeChanges.keys(),t=0;t<e.length;t++)this.visitNode(e[t],void 0)},O.prototype.visitNode=function(e,t){if(!this.visited.has(e)){this.visited.set(e,!0);var n=this.treeChanges.get(e),r=t;if(0!==(r=n&&n.childList||null==r?this.treeChanges.reachabilityChange(e):r))if(this.matchabilityChange(e),1===r?this.entered.push(e):5===r?(this.exited.push(e),this.ensureHasOldPreviousSiblingIfNeeded(e)):2===r&&(t=2,n&&n.childList&&(n.oldParentNode!==e.parentNode?(t=3,this.ensureHasOldPreviousSiblingIfNeeded(e)):this.calcReordered&&this.wasReordered(e)&&(t=4)),this.stayedIn.set(e,t)),2!==r)for(var o=e.firstChild;o;o=o.nextSibling)this.visitNode(o,r)}},O.prototype.ensureHasOldPreviousSiblingIfNeeded=function(e){var t,n;this.calcOldPreviousSibling&&(this.processChildlistChanges(),t=e.parentNode,(n=this.treeChanges.get(e))&&n.oldParentNode&&(t=n.oldParentNode),(n=this.childListChangeMap.get(t))||(n=new b,this.childListChangeMap.set(t,n)),n.oldPrevious.has(e)||n.oldPrevious.set(e,e.previousSibling))},O.prototype.getChanged=function(e,t,n){this.selectors=t,this.characterDataOnly=n;for(var r=0;r<this.entered.length;r++){var o=this.entered[r];1!==(s=this.matchabilityChange(o))&&2!==s||e.added.push(o)}for(var i=this.stayedIn.keys(),r=0;r<i.length;r++){var a,o=i[r];1===(s=this.matchabilityChange(o))?e.added.push(o):5===s?e.removed.push(o):2===s&&(e.reparented||e.reordered)&&(a=this.stayedIn.get(o),e.reparented&&3===a?e.reparented.push(o):e.reordered&&4===a&&e.reordered.push(o))}for(r=0;r<this.exited.length;r++){var s,o=this.exited[r];5!==(s=this.matchabilityChange(o))&&2!==s||e.removed.push(o)}},O.prototype.getOldParentNode=function(e){var t=this.treeChanges.get(e);if(t&&t.childList)return t.oldParentNode||null;t=this.treeChanges.reachabilityChange(e);if(0===t||1===t)throw Error("getOldParentNode requested on invalid node.");return e.parentNode},O.prototype.getOldPreviousSibling=function(e){var t=e.parentNode,n=this.treeChanges.get(e),n=(n&&n.oldParentNode&&(t=n.oldParentNode),this.childListChangeMap.get(t));if(n)return n.oldPrevious.get(e);throw Error("getOldPreviousSibling requested on invalid node.")},O.prototype.getOldAttribute=function(e,t){e=this.treeChanges.get(e);if(!e||!e.attributes)throw Error("getOldAttribute requested on invalid node.");e=e.getAttributeOldValue(t);if(void 0===e)throw Error("getOldAttribute requested for unchanged attribute name.");return e},O.prototype.attributeChangedNodes=function(e){if(!this.treeChanges.anyAttributesChanged)return{};if(e)for(var t={},n={},r=0;r<e.length;r++)t[u=e[r]]=!0,n[u.toLowerCase()]=u;for(var o={},i=this.treeChanges.keys(),r=0;r<i.length;r++){var a=i[r],s=this.treeChanges.get(a);if(s.attributes&&(2===this.treeChanges.reachabilityChange(a)&&2===this.matchabilityChange(a)))for(var l=a,d=s.getAttributeNamesMutated(),c=0;c<d.length;c++){var u=d[c];(!t||t[u]||s.isCaseInsensitive&&n[u])&&s.getAttributeOldValue(u)!==l.getAttribute(u)&&(o[u=n&&s.isCaseInsensitive?n[u]:u]=o[u]||[],o[u].push(l))}}return o},O.prototype.getOldCharacterData=function(e){e=this.treeChanges.get(e);if(e&&e.characterData)return e.characterDataOldValue;throw Error("getOldCharacterData requested on invalid node.")},O.prototype.getCharacterDataChanged=function(){if(!this.treeChanges.anyCharacterDataChanged)return[];for(var e=this.treeChanges.keys(),t=[],n=0;n<e.length;n++){var r,o=e[n];-1!==[2,5].indexOf(this.treeChanges.reachabilityChange(o))&&((r=this.treeChanges.get(o)).characterData&&o.textContent!=r.characterDataOldValue)&&t.push(o)}return t},O.prototype.computeMatchabilityChange=function(e,t){this.matchCache||(this.matchCache=[]),this.matchCache[e.uid]||(this.matchCache[e.uid]=new v);var n=this.matchCache[e.uid],r=n.get(t);return void 0===r&&(r=e.matchabilityChange(t,this.treeChanges.get(t)),n.set(t,r)),r},O.prototype.matchabilityChange=function(e){var t=this;if(this.characterDataOnly)switch(e.nodeType){case Node.COMMENT_NODE:case Node.TEXT_NODE:return 2;default:return 0}if(!this.selectors)return 2;if(e.nodeType!==Node.ELEMENT_NODE)return 0;for(var n=e,r=this.selectors.map(function(e){return t.computeMatchabilityChange(e,n)}),o=0,i=0;2!==o&&i<r.length;){switch(r[i]){case 2:o=2;break;case 1:o=5===o?2:1;break;case 5:o=1===o?2:5}i++}return o},O.prototype.getChildlistChange=function(e){var t=this.childListChangeMap.get(e);return t||(t=new b,this.childListChangeMap.set(e,t)),t},O.prototype.processChildlistChanges=function(){function e(e,t){!e||r.oldPrevious.has(e)||r.added.has(e)||r.maybeMoved.has(e)||t&&(r.added.has(t)||r.maybeMoved.has(t))||r.oldPrevious.set(e,t)}if(!this.childListChangeMap){this.childListChangeMap=new v;for(var t=0;t<this.mutations.length;t++){var n=this.mutations[t];if("childList"==n.type&&(2===this.treeChanges.reachabilityChange(n.target)||this.calcOldPreviousSibling)){for(var r=this.getChildlistChange(n.target),o=n.previousSibling,i=0;i<n.removedNodes.length;i++)e(a=n.removedNodes[i],o),(r.added.has(a)?r.added:(r.removed.set(a,!0),r.maybeMoved)).delete(a),o=a;e(n.nextSibling,o);for(i=0;i<n.addedNodes.length;i++){var a=n.addedNodes[i];(r.removed.has(a)?(r.removed.delete(a),r.maybeMoved):r.added).set(a,!0)}}}}},O.prototype.wasReordered=function(e){function r(e){var t;return!!e&&!!s.maybeMoved.has(e)&&(void 0===(t=s.moved.get(e))&&(t=!!n.has(e)||(n.set(e,!0),function(e){if(i.has(e))return i.get(e);var t=e.previousSibling;for(;t&&(s.added.has(t)||r(t));)t=t.previousSibling;return i.set(e,t),t}(e)!==function e(t){var n=o.get(t);if(void 0!==n)return n;n=s.oldPrevious.get(t);for(;n&&(s.removed.has(n)||r(n));)n=e(n);void 0===n&&(n=t.previousSibling);o.set(t,n);return n}(e)),n.has(e)?(n.delete(e),s.moved.set(e,t)):t=s.moved.get(e)),t)}if(!this.treeChanges.anyParentsChanged)return!1;this.processChildlistChanges();var n,o,i,t=e.parentNode,a=this.treeChanges.get(e),s=(a&&a.oldParentNode&&(t=a.oldParentNode),this.childListChangeMap.get(t));return!!s&&(s.moved||(s.moved=new v,n=new v,o=new v,i=new v,s.maybeMoved.keys().forEach(r)),s.moved.get(e))};var U=O;function O(e,t,n,r,o){this.rootNode=e,this.mutations=t,this.selectors=n,this.calcReordered=r,this.calcOldPreviousSibling=o,this.treeChanges=new B(e,t),this.entered=[],this.exited=[],this.stayedIn=new v,this.visited=new v,this.childListChangeMap=void 0,this.characterDataOnly=void 0,this.matchCache=void 0,this.processMutations()}S.prototype.getOldParentNode=function(e){return this.projection.getOldParentNode(e)},S.prototype.getOldAttribute=function(e,t){return this.projection.getOldAttribute(e,t)},S.prototype.getOldCharacterData=function(e){return this.projection.getOldCharacterData(e)},S.prototype.getOldPreviousSibling=function(e){return this.projection.getOldPreviousSibling(e)};var H=S;function S(e,t){var n,r=this;this.projection=e,this.added=[],this.removed=[],this.reparented=t.all||t.element||t.characterData?[]:void 0,this.reordered=t.all?[]:void 0,e.getChanged(this,t.elementFilter,t.characterData),(t.all||t.attribute||t.attributeList)&&(n=t.attribute?[t.attribute]:t.attributeList,n=e.attributeChangedNodes(n),t.attribute?this.valueChanged=n[t.attribute]||[]:(this.attributeChanged=n,t.attributeList&&t.attributeList.forEach(function(e){r.attributeChanged.hasOwnProperty(e)||(r.attributeChanged[e]=[])}))),(t.all||t.characterData)&&(n=e.getCharacterDataChanged(),t.characterData?this.valueChanged=n:this.characterDataChanged=n),this.reordered&&(this.getOldPreviousSibling=e.getOldPreviousSibling.bind(e))}var R=/[a-zA-Z_]+/,w=/[a-zA-Z0-9_\-]+/;function A(e){return'"'+e.replace(/"/,'\\"')+'"'}D.prototype.matches=function(e){if(null!==e){if(void 0===this.attrValue)return!0;if(!this.contains)return this.attrValue==e;for(var t=e.split(" "),n=0;n<t.length;n++)if(this.attrValue===t[n])return!0}return!1},D.prototype.toString=function(){return"class"===this.attrName&&this.contains?"."+this.attrValue:"id"!==this.attrName||this.contains?this.contains?"["+this.attrName+"~="+A(this.attrValue)+"]":"attrValue"in this?"["+this.attrName+"="+A(this.attrValue)+"]":"["+this.attrName+"]":"#"+this.attrValue};var F=D;function D(){}Object.defineProperty(_.prototype,"caseInsensitiveTagName",{get:function(){return this.tagName.toUpperCase()},enumerable:!0,configurable:!0}),Object.defineProperty(_.prototype,"selectorString",{get:function(){return this.tagName+this.qualifiers.join("")},enumerable:!0,configurable:!0}),_.prototype.isMatching=function(e){return e[_.matchesSelector](this.selectorString)},_.prototype.wasMatching=function(e,t,n){if(!t||!t.attributes)return n;var r=t.isCaseInsensitive?this.caseInsensitiveTagName:this.tagName;if("*"!==r&&r!==e.tagName)return!1;for(var o=[],i=!1,a=0;a<this.qualifiers.length;a++){var s=this.qualifiers[a],l=t.getAttributeOldValue(s.attrName);o.push(l),i=i||void 0!==l}if(!i)return n;for(a=0;a<this.qualifiers.length;a++){s=this.qualifiers[a];if(void 0===(l=o[a])&&(l=e.getAttribute(s.attrName)),!s.matches(l))return!1}return!0},_.prototype.matchabilityChange=function(e,t){var n=this.isMatching(e);return n?this.wasMatching(e,t,n)?2:1:this.wasMatching(e,t,n)?5:0},_.parseSelectors=function(e){function t(){r&&(o&&(r.qualifiers.push(o),o=void 0),a.push(r)),r=new _}function n(){o&&r.qualifiers.push(o),o=new F}for(var r,o,i,a=[],s=/\s/,l="Invalid or unsupported selector syntax.",d=1,c=0;c<e.length;){var u=e[c++];switch(d){case 1:if(u.match(R)){t(),r.tagName=u,d=2;break}if("*"==u){t(),r.tagName="*",d=3;break}if("."==u){t(),n(),r.tagName="*",o.attrName="class",o.contains=!0,d=4;break}if("#"==u){t(),n(),r.tagName="*",o.attrName="id",d=4;break}if("["==u){t(),n(),r.tagName="*",o.attrName="",d=6;break}if(u.match(s))break;throw Error(l);case 2:if(u.match(w))r.tagName+=u;else if("."==u)n(),o.attrName="class",o.contains=!0,d=4;else if("#"==u)n(),o.attrName="id",d=4;else if("["==u)n(),o.attrName="",d=6;else if(u.match(s))d=14;else{if(","!=u)throw Error(l);d=1}break;case 3:if("."==u)n(),o.attrName="class",o.contains=!0,d=4;else if("#"==u)n(),o.attrName="id",d=4;else if("["==u)n(),o.attrName="",d=6;else if(u.match(s))d=14;else{if(","!=u)throw Error(l);d=1}break;case 4:if(u.match(R)){o.attrValue=u,d=5;break}throw Error(l);case 5:if(u.match(w))o.attrValue+=u;else if("."==u)n(),o.attrName="class",o.contains=!0,d=4;else if("#"==u)n(),o.attrName="id",d=4;else if("["==u)n(),d=6;else if(u.match(s))d=14;else{if(","!=u)throw Error(l);d=1}break;case 6:if(u.match(R)){o.attrName=u,d=7;break}if(u.match(s))break;throw Error(l);case 7:if(u.match(w))o.attrName+=u;else if(u.match(s))d=8;else if("~"==u)o.contains=!0,d=9;else if("="==u)o.attrValue="",d=11;else{if("]"!=u)throw Error(l);d=3}break;case 8:if("~"==u){o.contains=!0,d=9;break}if("="==u){o.attrValue="",d=11;break}if("]"==u){d=3;break}if(u.match(s))break;throw Error(l);case 9:if("="!=u)throw Error(l);o.attrValue="",d=11;break;case 10:if("]"==u){d=3;break}if(u.match(s))break;throw Error(l);case 11:u.match(s)||(d='"'==u||"'"==u?(i=u,13):(o.attrValue+=u,12));break;case 12:if(u.match(s))d=10;else if("]"==u)d=3;else{if("'"==u||'"'==u)throw Error(l);o.attrValue+=u}break;case 13:u==i?d=10:o.attrValue+=u;break;case 14:if(!u.match(s)){if(","!=u)throw Error(l);d=1}}}switch(d){case 1:case 2:case 3:case 5:case 14:t();break;default:throw Error(l)}if(a.length)return a;throw Error(l)},_.nextUid=1,_.matchesSelector="function"==typeof(e=document.createElement("div")).webkitMatchesSelector?"webkitMatchesSelector":"function"==typeof e.mozMatchesSelector?"mozMatchesSelector":"function"==typeof e.msMatchesSelector?"msMatchesSelector":"matchesSelector";var x=_;function _(){this.uid=_.nextUid++,this.qualifiers=[]}var V=/^([a-zA-Z:_]+[a-zA-Z0-9_\-:\.]*)$/;function L(e){if("string"!=typeof e)throw Error("Invalid request opion. attribute must be a non-zero length string.");if(!(e=e.trim()))throw Error("Invalid request opion. attribute must be a non-zero length string.");if(e.match(V))return e;throw Error("Invalid request option. invalid attribute name: "+e)}function k(e){var t,n=this;this.connected=!1,this.suspended=!1,this.queue=[],this.options=k.validateOptions(e),this.observerOptions=k.createObserverOptions(this.options.queries),this.root=this.options.rootNode,this.callback=this.options.callback,this.elementFilter=Array.prototype.concat.apply([],this.options.queries.map(function(e){return e.elementFilter||[]})),this.elementFilter.length||(this.elementFilter=void 0),this.calcReordered=this.options.queries.some(function(e){return e.all}),this.queryValidators=[],k.createQueryValidator&&(this.queryValidators=this.options.queries.map(function(e){return k.createQueryValidator(n.root,e)})),this.observer=new m(function(e){for(t=e.length-1;0<=t;t--)void 0!==e[t].target&&1===e[t].target.nodeType&&e[t].target.hasAttribute("data-ignore-changes")&&e.splice(t,1);n.suspended?n.queue=n.queue.concat(e):n.observerCallback(e)}),this.reconnect()}window.MutationSummary=(k.createObserverOptions=function(e){var t,r={childList:!0,subtree:!0};function o(e){r.attributes&&!t||(r.attributes=!0,r.attributeOldValue=!0,e?(t=t||{},e.forEach(function(e){t[e]=!0,t[e.toLowerCase()]=!0})):t=void 0)}return e.forEach(function(e){var t,n;e.characterData?(r.characterData=!0,r.characterDataOldValue=!0):e.all?(o(),r.characterData=!0,r.characterDataOldValue=!0):e.attribute?o([e.attribute.trim()]):(t=e.elementFilter,n={},t.forEach(function(e){e.qualifiers.forEach(function(e){n[e.attrName]=!0})}),(t=Object.keys(n).concat(e.attributeList||[])).length&&o(t))}),t&&(r.attributeFilter=Object.keys(t)),r},k.validateOptions=function(e){for(var t in e)if(!(t in k.optionKeys))throw Error("Invalid option: "+t);if("function"!=typeof e.callback)throw Error("Invalid options: callback is required and must be a function");if(!e.queries||!e.queries.length)throw Error("Invalid options: queries must contain at least one query request object.");for(var n={callback:e.callback,rootNode:e.rootNode||document,observeOwnChanges:!!e.observeOwnChanges,oldPreviousSibling:!!e.oldPreviousSibling,queries:[]},r=0;r<e.queries.length;r++){var o=e.queries[r];if(o.all){if(1<Object.keys(o).length)throw Error("Invalid request option. all has no options.");n.queries.push({all:!0})}else if("attribute"in o){if((a={attribute:L(o.attribute)}).elementFilter=x.parseSelectors("*["+a.attribute+"]"),1<Object.keys(o).length)throw Error("Invalid request option. attribute has no options.");n.queries.push(a)}else if("element"in o){var i=Object.keys(o).length,a={element:o.element,elementFilter:x.parseSelectors(o.element)};if(o.hasOwnProperty("elementAttributes")&&(a.attributeList=function(e){if(!e.trim().length)throw Error("Invalid request option: elementAttributes must contain at least one attribute.");for(var t={},n={},r=e.split(/\s+/),o=0;o<r.length;o++)if(i=r[o]){var i,a=(i=L(i)).toLowerCase();if(t[a])throw Error("Invalid request option: observing multiple case variations of the same attribute is not supported.");t[a]=n[i]=!0}return Object.keys(n)}(o.elementAttributes),i--),1<i)throw Error("Invalid request option. element only allows elementAttributes option.");n.queries.push(a)}else{if(!o.characterData)throw Error("Invalid request option. Unknown query request.");if(1<Object.keys(o).length)throw Error("Invalid request option. characterData has no options.");n.queries.push({characterData:!0})}}return n},k.prototype.createSummaries=function(e){if(!e||!e.length)return[];for(var t=new U(this.root,e,this.elementFilter,this.calcReordered,this.options.oldPreviousSibling),n=[],r=0;r<this.options.queries.length;r++)n.push(new H(t,this.options.queries[r]));return n},k.prototype.checkpointQueryValidators=function(){this.queryValidators.forEach(function(e){e&&e.recordPreviousState()})},k.prototype.runQueryValidators=function(n){this.queryValidators.forEach(function(e,t){e&&e.validate(n[t])})},k.prototype.changesToReport=function(e){return e.some(function(t){if(["added","removed","reordered","reparented","valueChanged","characterDataChanged"].some(function(e){return t[e]&&t[e].length}))return!0;if(t.attributeChanged&&Object.keys(t.attributeChanged).some(function(e){return!!t.attributeChanged[e].length}))return!0;return!1})},k.prototype.observerCallback=function(e){this.options.observeOwnChanges||this.observer.disconnect();e=this.createSummaries(e);this.runQueryValidators(e),this.options.observeOwnChanges&&this.checkpointQueryValidators(),this.changesToReport(e)&&this.callback(e),!this.options.observeOwnChanges&&this.connected&&(this.checkpointQueryValidators(),this.observer.observe(this.root,this.observerOptions))},k.prototype.reconnect=function(){if(this.connected)throw Error("Already connected");this.observer.observe(this.root,this.observerOptions),this.connected=!0,this.checkpointQueryValidators()},k.prototype.getQueue=function(){if(this.connected)return this.queue=this.queue.concat(this.observer.takeRecords());throw Error("Not connected")},k.prototype.takeSummaries=function(){var e;if(this.connected)return e=this.createSummaries(this.getQueue()),this.queue=[],this.changesToReport(e)?e:void 0;throw Error("Not connected")},k.prototype.suspendDelivery=function(){this.suspended=!0},k.prototype.resumeDelivery=function(){return this.suspended=!1,this.takeSummaries()},k.prototype.disconnect=function(){var e=this.takeSummaries();return this.observer.disconnect(),this.connected=!1,e},k.NodeMap=v,k.parseElementFilter=x.parseSelectors,k.optionKeys={callback:!0,queries:!0,rootNode:!0,oldPreviousSibling:!0,observeOwnChanges:!0},k),function(){function e(){}or.extend(e.prototype,{execute:function(e,t){t=t||{};var n=rr.getActiveEditor();if(n||(rr.events.trigger("set-active-editor"),n=rr.getActiveEditor()),n){if(this.before(n,t),e)try{!1===e()?this.error(n,t):(rr.forcedRange&&!rr.forcedRange.isValid()&&(rr.forcedRange=null),rr.events.trigger("mutation-before-success",n,t),this.success(n,t))}catch(e){console.warn("Error during mutation execution:"),console.error(e),this.error(n,t)}this.always(n,t)}else{console.warn("No editor found. Executing standalone mutation without editor context.");try{e()}catch(e){console.warn("Error during standalone mutation execution:"),console.error(e)}}},before:function(e,t){rr.events.trigger("mutation-start",e,t)},always:function(e,t){rr.events.trigger("mutation-end",e,t)},error:function(e,t){rr.events.trigger("mutation-fail",e,t)},success:function(e,t){rr.events.trigger("mutation-success",e,t)}}),this.mutationManager=new e}.call(this)}.call(window.CargoEditor=window.CargoEditor||{});